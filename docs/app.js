!function(){"use strict";var e="undefined"==typeof global?self:global;if("function"!=typeof e.require){var t={},r={},n={},o={}.hasOwnProperty,i=/^\.\.?(\/|$)/,a=function(e,t){for(var r,n=[],o=(i.test(t)?e+"/"+t:t).split("/"),a=0,u=o.length;a<u;a++)".."===(r=o[a])?n.pop():"."!==r&&""!==r&&n.push(r);return n.join("/")},u=function(e){return e.split("/").slice(0,-1).join("/")},s=function(t,n){var o,i={id:t,exports:{},hot:h&&h.createHot(t)};return r[t]=i,n(i.exports,(o=t,function(t){var r=a(u(o),t);return e.require(r,o)}),i),i.exports},c=function(e){var t=n[e];return t&&e!==t?c(t):e},l=function(e,n){null==n&&(n="/");var i=c(e);if(o.call(r,i))return r[i].exports;if(o.call(t,i))return s(i,t[i]);throw new Error("Cannot find module '"+e+"' from '"+n+"'")};l.alias=function(e,t){n[t]=e};var f=/\.[^.\/]+$/,d=/\/index(\.[^\/]+)?$/;l.register=l.define=function(e,i){if(e&&"object"==typeof e)for(var a in e)o.call(e,a)&&l.register(a,e[a]);else t[e]=i,delete r[e],function(e){if(f.test(e)){var t=e.replace(f,"");o.call(n,t)&&n[t].replace(f,"")!==t+"/index"||(n[t]=e)}if(d.test(e)){var r=e.replace(d,"");o.call(n,r)||(n[r]=e)}}(e)},l.list=function(){var e=[];for(var r in t)o.call(t,r)&&e.push(r);return e};var h=e._hmr&&new e._hmr(function(e,t){return c(a(u(e),t))},l,t,r);l._cache=r,l.hmr=h&&h.wrap,l.brunch=!0,e.require=l}}(),function(){"undefined"==typeof window||window;var e=function(e,t,r){var n={},o=function(t,r){try{return e(r+"/node_modules/"+t)}catch(e){if(-1===e.toString().indexOf("Cannot find module"))throw e;if(-1!==r.indexOf("node_modules")){var i=r.split("/"),a=i.lastIndexOf("node_modules"),u=i.slice(0,a).join("/");return o(t,u)}}return n};return function(i){if(i in t&&(i=t[i]),i){if("."!==i[0]&&r){var a=o(i,r);if(a!==n)return a}return e(i)}}};require.register("curvature/base/Bag.js",function(t,r,n){r=e(r,{},"curvature"),function(){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Bag=void 0;var n=r("./Bindable"),o=r("./Mixin"),i=r("../mixin/EventTargetMixin");function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=l(e);if(t){var o=l(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return c(this,r)}}function c(t,r){if(r&&("object"===e(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t)}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=Symbol("Mapped"),d=Symbol("Has"),h=Symbol("Add"),v=Symbol("Remove"),p=Symbol("Delete"),y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(i,e);var t,r,o=s(i);function i(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).changeCallback=t,e.content=new Map,e.current=0,e.length=0,e.list=n.Bindable.makeBindable([]),e.meta=Symbol("meta"),e.type=void 0,e}return t=i,(r=[{key:"has",value:function(e){return this[f]?this[f].has(e):this[d](e)}},{key:d,value:function(e){return this.content.has(e)}},{key:"add",value:function(e){return this[f]?this[f].add(e):this[h](e)}},{key:h,value:function(e){if(void 0===e||!(e instanceof Object))throw new Error("Only objects may be added to Bags.");if(this.type&&!(e instanceof this.type))throw console.error(this.type,e),new Error("Only objects of type ".concat(this.type," may be added to this Bag."));if(!this.content.has(e)){var t=new CustomEvent("adding",{detail:{item:e}});if(this.dispatchEvent(t)){var r,n=(r=this.current++,Number(r));this.content.set(e,n),this.list[n]=e,this.changeCallback&&this.changeCallback(e,this.meta,i.ITEM_ADDED,n);var o=new CustomEvent("added",{detail:{item:e,id:n}});return this.dispatchEvent(o),this.length=this.size,n}}}},{key:"remove",value:function(e){return this[f]?this[f].remove(e):this[v](e)}},{key:v,value:function(e){if(void 0===e||!(e instanceof Object))throw new Error("Only objects may be removed from Bags.");if(this.type&&!(e instanceof this.type))throw console.error(this.type,e),new Error("Only objects of type ".concat(this.type," may be removed from this Bag."));if(!this.content.has(e))return this.changeCallback&&this.changeCallback(e,this.meta,0,void 0),!1;var t=new CustomEvent("removing",{detail:{item:e}});if(this.dispatchEvent(t)){var r=this.content.get(e);delete this.list[r],this.content.delete(e),this.changeCallback&&this.changeCallback(e,this.meta,i.ITEM_REMOVED,r);var n=new CustomEvent("removed",{detail:{item:e,id:r}});return this.dispatchEvent(n),this.length=this.size,e}}},{key:"delete",value:function(e){if(this[f])return this[f].delete(e);this[p](e)}},{key:p,value:function(e){this.remove(e)}},{key:"map",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return e},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e},r=new WeakMap,n=new i;return n[f]=this,this.addEventListener("added",function(o){var i=o.detail.item;if(t(i)&&!r.has(i)){var a=e(i);r.set(i,a),n[h](a)}}),this.addEventListener("removed",function(e){var t=e.detail.item;if(r.has(t)){var o=r.get(t);r.delete(t),n[v](o)}}),n}},{key:"size",get:function(){return this.content.size}},{key:"items",value:function(){return Array.from(this.content.entries()).map(function(e){return e[0]})}}])&&a(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(o.Mixin.with(i.EventTargetMixin));t.Bag=y,Object.defineProperty(y,"ITEM_ADDED",{configurable:!1,enumerable:!1,writable:!0,value:1}),Object.defineProperty(y,"ITEM_REMOVED",{configurable:!1,enumerable:!1,writable:!0,value:-1})}()}),require.register("curvature/base/Bindable.js",function(t,r,n){r=e(r,{},"curvature"),function(){"use strict";function e(t,n,o){return(e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,n){var o=[null];o.push.apply(o,t);var i=new(Function.bind.apply(e,o));return n&&r(i,n.prototype),i}).apply(null,arguments)}function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function n(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||i(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=i(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,u=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return u=e.done,e},e:function(e){s=!0,a=e},f:function(){try{u||null==r.return||r.return()}finally{if(s)throw a}}}}function i(e,t){if(e){if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.defineProperty(t,"__esModule",{value:!0}),t.Bindable=void 0;var l=Symbol("ref"),f=Symbol("original"),d=Symbol("deck"),h=Symbol("binding"),v=Symbol("subBinding"),p=Symbol("bindingAll"),y=Symbol("isBindable"),b=Symbol("wrapping"),m=Symbol("Names"),g=Symbol("executing"),w=Symbol("stack"),_=(Symbol("object"),Symbol("wrapped")),O=Symbol("unwrapped"),E=Symbol("getProto"),j=Symbol("onGet"),k=Symbol("onAllGet"),T=Symbol("bindChain"),S=Symbol("Descriptors"),P=Symbol("Before"),R=Symbol("After"),x=Symbol("NoGetters"),A=Object.getPrototypeOf(Int8Array),C=Set.prototype[Symbol.iterator],B=Map.prototype[Symbol.iterator],D=globalThis,M=[D.Node,D.File,D.Map,D.Set,D.WeakMap,D.WeakSet,D.ArrayBuffer,D.ResizeObserver,D.MutationObserver,D.PerformanceObserver,D.IntersectionObserver,D.IDBCursor,D.IDBCursorWithValue,D.IDBDatabase,D.IDBFactory,D.IDBIndex,D.IDBKeyRange,D.IDBObjectStore,D.IDBOpenDBRequest,D.IDBRequest,D.IDBTransaction,D.IDBVersionChangeEvent,D.Event,D.CustomEvent,D.FileSystemFileHandle].filter(function(e){return"function"==typeof e}),L=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t)}var r,i;return r=t,i=[{key:"isBindable",value:function(e){return!(!e||!e[y])&&e[y]===t}},{key:"onDeck",value:function(e,t){return e[d][t]||!1}},{key:"ref",value:function(e){return e[l]||e||!1}},{key:"makeBindable",value:function(e){return this.make(e)}},{key:"shuck",value:function(e,r){r=r||new Map;var n={};if(e instanceof A||e instanceof ArrayBuffer){var o=e.slice(0);return r.set(e,o),o}var i=Object.keys(e);for(var a in i){var s=i[a];if("___"!==s.substring(0,3)){var c=r.get(e[s]);if(c)n[s]=c;else if(e[s]!==e){if(e[s]&&"object"===u(e[s])){var l=e[s];t.isBindable(e[s])&&(l=e[s][f]),n[s]=this.shuck(l,r)}else n[s]=e[s];r.set(e[s],n[s])}else r.set(e[s],n),n[s]=n}}return t.isBindable(e)&&(delete n.bindTo,delete n.isBound),n}},{key:"make",value:function(r){var i=this;if(!r||!["function","object"].includes(u(r)))return r;if(r[l])return r[l];if(r[y])return r;if(Object.isSealed(r)||Object.isFrozen(r)||!Object.isExtensible(r)||M.filter(function(e){return r instanceof e}).length)return r;Object.defineProperty(r,y,{configurable:!1,enumerable:!1,writable:!1,value:t}),Object.defineProperty(r,l,{configurable:!0,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(r,f,{configurable:!1,enumerable:!1,writable:!1,value:r}),Object.defineProperty(r,d,{configurable:!1,enumerable:!1,writable:!1,value:{}}),Object.defineProperty(r,h,{configurable:!1,enumerable:!1,writable:!1,value:{}}),Object.defineProperty(r,v,{configurable:!1,enumerable:!1,writable:!1,value:new Map}),Object.defineProperty(r,p,{configurable:!1,enumerable:!1,writable:!1,value:[]}),Object.defineProperty(r,g,{enumerable:!1,writable:!0}),Object.defineProperty(r,b,{enumerable:!1,writable:!0}),Object.defineProperty(r,w,{configurable:!1,enumerable:!1,writable:!1,value:[]}),Object.defineProperty(r,P,{configurable:!1,enumerable:!1,writable:!1,value:[]}),Object.defineProperty(r,R,{configurable:!1,enumerable:!1,writable:!1,value:[]}),Object.defineProperty(r,_,{configurable:!1,enumerable:!1,writable:!1,value:Object.preventExtensions(new Map)}),Object.defineProperty(r,O,{configurable:!1,enumerable:!1,writable:!1,value:{}}),Object.defineProperty(r,S,{configurable:!1,enumerable:!1,writable:!1,value:Object.preventExtensions(new Map)}),Object.defineProperty(r,"bindTo",{configurable:!1,enumerable:!1,writable:!1,value:function e(n){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=!1;if(Array.isArray(n)){var c=n.forEach(function(t){return e(t,o,a)});return function(){return c.forEach(function(e){return e()})}}if(n instanceof Function&&(a=o||{},o=n,s=!0),a.delay>=0&&(o=i.wrapDelayCallback(o,a.delay)),a.throttle>=0&&(o=i.wrapThrottleCallback(o,a.throttle)),a.wait>=0&&(o=i.wrapWaitCallback(o,a.wait)),a.frame&&(o=i.wrapFrameCallback(o,a.frame)),a.idle&&(o=i.wrapIdleCallback(o)),s){var l=r[p].length;if(r[p].push(o),!("now"in a)||a.now)for(var f in r)o(r[f],f,r,!1);return function(){delete r[p][l]}}if(r[h][n]||(r[h][n]=new Set),a.children){var d=o;o=function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];var i=n[0],s=r[v].get(d);if(s&&(r[v].delete(d),s()),"object"===u(i)){var c=t.make(i);t.isBindable(c)&&r[v].set(d,c.bindTo(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return d.apply(void 0,n.concat(t))},Object.assign({},a,{children:!1}))),d.apply(void 0,n)}else d.apply(void 0,n)}}r[h][n].add(o),"now"in a&&!a.now||o(r[n],n,r,!1);var y=function(){var e=r[v].get(o);e&&(r[v].delete(o),e()),r[h][n]&&r[h][n].has(o)&&r[h][n].delete(o)};return a.removeWith&&a.removeWith instanceof View&&a.removeWith.onRemove(function(){return y}),y}}),Object.defineProperty(r,T,{configurable:!1,enumerable:!1,writable:!1,value:function(e,t){var n=e.split("."),o=n.shift(),a=n.slice(0),u=[];return u.push(r.bindTo(o,function(e,r,n,o){var s=a.join(".");0!==a.length?(void 0===e&&(e=n[r]=i.make({})),u=u.concat(e[T](s,t))):t(e,r,n,o)})),function(){return u.forEach(function(e){return e()})}}}),Object.defineProperty(r,"___before",{configurable:!1,enumerable:!1,writable:!1,value:function(e){var t=r[P].length;r[P].push(e);var n=!1;return function(){n||(n=!0,delete r[P][t])}}}),Object.defineProperty(r,"___after",{configurable:!1,enumerable:!1,writable:!1,value:function(e){var t=r[R].length;r[R].push(e);var n=!1;return function(){n||(n=!0,delete r[R][t])}}}),Object.defineProperty(r,"isBound",{configurable:!1,enumerable:!1,writable:!1,value:function(){for(var e in r[p])if(r[p][e])return!0;for(var t in r[h])for(var n in r[h][t])if(r[h][t][n])return!0;return!1}});var a=function(e){r[e]&&r[e]instanceof Object&&!r[e]instanceof Promise&&(M.filter(function(t){return r[e]instanceof t}).length||!Object.isExtensible(r[e])||Object.isSealed(r[e])||(r[e]=t.make(r[e])))};for(var s in r)a(s);var c=r[S],D=r[_],L=r[w],I={get:function(n,i){if(D.has(i))return D.get(i);if(i===l||i===f||"apply"===i||"isBound"===i||"bindTo"===i||"__proto__"===i||"constructor"===i)return r[i];var a;if(c.has(i)?a=c.get(i):(a=Object.getOwnPropertyDescriptor(r,i),c.set(i,a)),a&&!a.configurable&&!a.writable)return r[i];if(k in r)return r[k](i);if(j in r&&!(i in r))return r[j](i);if(a&&!a.configurable&&!a.writable)return D.set(i,r[i]),r[i];if("function"==typeof r[i]){if(m in r[i])return r[i];Object.defineProperty(r[O],i,{configurable:!1,enumerable:!1,writable:!0,value:r[i]});var u=Object.getPrototypeOf(r)[i]===r[i],s="function"==typeof Promise&&r instanceof Promise||"function"==typeof Map&&r instanceof Map||"function"==typeof Set&&r instanceof Set||"function"==typeof B&&r.prototype===B||"function"==typeof C&&r.prototype===C||"function"==typeof C&&r.prototype===C||"function"==typeof WeakMap&&r instanceof WeakMap||"function"==typeof WeakSet&&r instanceof WeakSet||"function"==typeof Date&&r instanceof Date||"function"==typeof A&&r instanceof A||"function"==typeof ArrayBuffer&&r instanceof ArrayBuffer||"function"==typeof EventTarget&&r instanceof EventTarget||"function"==typeof ResizeObserver&&r instanceof ResizeObserver||"function"==typeof MutationObserver&&r instanceof MutationObserver||"function"==typeof PerformanceObserver&&r instanceof PerformanceObserver||"function"==typeof IntersectionObserver&&r instanceof IntersectionObserver||"function"==typeof r[Symbol.iterator]&&"next"===i?r:r[l],d=function(){r[g]=i,L.unshift(i);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];var c,l,f=o(r[P]);try{for(f.s();!(c=f.n()).done;){(0,c.value)(r,i,L,r,n)}}catch(e){f.e(e)}finally{f.f()}if(new.target)l=e(r[O][i],n);else{var d=r[O][i];l=u?d.apply(s||r,n):d.apply(void 0,n)}var h,v=o(r[R]);try{for(v.s();!(h=v.n()).done;){(0,h.value)(r,i,L,r,n)}}catch(e){v.e(e)}finally{v.f()}return r[g]=null,L.shift(),l};(d[m]=d[m]||new WeakMap).set(r,i),d[k]=function(e){var t=d[m].get(r);return r[t][e]};var h=t.make(d);return D.set(i,h),h}return r[i]},set:function(e,n,i){if(D.has(n)&&D.delete(n),n===f)return!0;var a=r[d];if(n in a&&a[n]===i)return!0;if(n.slice&&"___"===n.slice(-3))return!0;if(e[n]===i||"number"==typeof i&&isNaN(a[n])&&isNaN(i))return!0;for(var u in i&&i instanceof Object&&(M.filter(function(e){return r instanceof e}).length||!Object.isExtensible(r)||Object.isSealed(r)||(r[x],i=t.make(i))),a[n]=i,r[p])r[p][u]&&r[p][u](i,n,e,!1);var s=!1;if(n in r[h]){var c,l=o(r[h][n]);try{for(l.s();!(c=l.n()).done;)!1===(0,c.value)(i,n,e,!1,e[n])&&(s=!0)}catch(e){l.e(e)}finally{l.f()}}if(delete a[n],!s){var v=Object.getOwnPropertyDescriptor(e,n);e instanceof File&&"lastModifiedDate"==n||v&&!v.writable||e[n]!==i||(e[n]=i)}var y=Reflect.set(e,n,i);if(Array.isArray(e)&&r[h].length)for(var b in r[h].length)(0,r[h].length[b])(e.length,"length",e,!1,e.length);return y},construct:function(o,i){var a="constructor";for(var u in o[P])o[P][u](o,a,r[w],void 0,i);var s=t.make(e(o[f],n(i)));for(var c in o[R])o[R][c](o,a,r[w],s,i);return s},getPrototypeOf:function(e){return E in r?r[E]:Reflect.getPrototypeOf(e)},deleteProperty:function(e,t){var n=r[d];if(void 0!==n[t])return!0;if(!(t in e))return!0;if(c.has(t)){var i=c.get(t);if(i&&!i.configurable)return!1;c.delete(t)}for(var a in n[t]=null,D.has(t)&&D.delete(t),r[p])r[p][a](void 0,t,e,!0,e[t]);if(t in r[h]){var u,s=o(r[h][t]);try{for(s.s();!(u=s.n()).done;)(0,u.value)(void 0,t,e,!0,e[t])}catch(e){s.e(e)}finally{s.f()}}return delete n[t],delete e[t],!0}};return r[x]&&delete I.get,Object.defineProperty(r,l,{configurable:!1,enumerable:!1,writable:!1,value:new Proxy(r,I)}),r[l]}},{key:"clearBindings",value:function(e){var t;(t=function(e){return Object.keys(e).map(function(t){return delete e[t]})},function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return r.map(t)})(e[_],e[h],e[p],e[R],e[P])}},{key:"resolve",value:function(e,t){for(var r,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=t.split("."),i=o[0];o.length;){if(n&&1===o.length)return[this.make(e),o.shift(),i];!(!(r=o.shift())in e)&&e[r]&&e[r]instanceof Object||(e[r]={}),e=this.make(e[r])}return[this.make(e),r,i]}},{key:"wrapDelayCallback",value:function(e,t){return function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return setTimeout(function(){return e.apply(void 0,n)},t)}}},{key:"wrapThrottleCallback",value:function(e,t){var r=this;return this.throttles.set(e,!1),function(){r.throttles.get(e,!0)||(e.apply(void 0,arguments),r.throttles.set(e,!0),setTimeout(function(){r.throttles.set(e,!1)},t))}}},{key:"wrapWaitCallback",value:function(e,t){var r=this;return function(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];var a;(a=r.waiters.get(e))&&(r.waiters.delete(e),clearTimeout(a)),a=setTimeout(function(){return e.apply(void 0,o)},t),r.waiters.set(e,a)}}},{key:"wrapFrameCallback",value:function(e,t){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];requestAnimationFrame(function(){return e.apply(void 0,r)})}}},{key:"wrapIdleCallback",value:function(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];(window.requestIdleCallback||requestAnimationFrame)(function(){return e.apply(void 0,r)})}}}],null&&s(r.prototype,null),i&&s(r,i),Object.defineProperty(r,"prototype",{writable:!1}),t}();t.Bindable=L,c(L,"waiters",new WeakMap),c(L,"throttles",new WeakMap),Object.defineProperty(L,"OnGet",{configurable:!1,enumerable:!1,writable:!1,value:j}),Object.defineProperty(L,"NoGetters",{configurable:!1,enumerable:!1,writable:!1,value:x}),Object.defineProperty(L,"GetProto",{configurable:!1,enumerable:!1,writable:!1,value:E}),Object.defineProperty(L,"OnAllGet",{configurable:!1,enumerable:!1,writable:!1,value:k})}()}),require.register("curvature/base/Cache.js",function(t,r,n){r=e(r,{},"curvature"),function(){"use strict";function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.Cache=void 0;var r=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t)}var r,n;return r=t,n=[{key:"store",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"standard",o=0;r&&(o=1e3*r+(new Date).getTime()),this.buckets||(this.buckets=new Map),this.buckets.has(n)||this.buckets.set(n,new Map);var i=new CustomEvent("cvCacheStore",{cancelable:!0,detail:{key:e,value:t,expiry:r,bucket:n}});document.dispatchEvent(i)&&this.buckets.get(n).set(e,{value:t,expiration:o})}},{key:"load",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"standard",n=new CustomEvent("cvCacheLoad",{cancelable:!0,detail:{key:e,defaultvalue:t,bucket:r}});if(!document.dispatchEvent(n))return t;if(this.buckets&&this.buckets.has(r)&&this.buckets.get(r).has(e)){var o=this.buckets.get(r).get(e);if(0===o.expiration||o.expiration>(new Date).getTime())return this.buckets.get(r).get(e).value}return t}}],null&&e(r.prototype,null),n&&e(r,n),Object.defineProperty(r,"prototype",{writable:!1}),t}();t.Cache=r}()}),require.register("curvature/base/Config.js",function(t,r,n){r=e(r,{},"curvature"),function(){"use strict";function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.Config=void 0;var n={},o=r;try{n=o("/Config").Config||{}}catch(e){!0===globalThis.devMode&&console.error(e)}var i=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t)}var r,n;return r=t,n=[{key:"get",value:function(e){return this.configs[e]}},{key:"set",value:function(e,t){return this.configs[e]=t,this}},{key:"dump",value:function(){return this.configs}},{key:"init",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var n in t){var o=t[n];for(var i in"string"==typeof o&&(o=JSON.parse(o)),o){var a=o[i];return this.configs[i]=a}}return this}}],null&&e(r.prototype,null),n&&e(r,n),Object.defineProperty(r,"prototype",{writable:!1}),t}();t.Config=i,Object.defineProperty(i,"configs",{configurable:!1,enumerable:!1,writable:!1,value:n})}()}),require.register("curvature/base/Dom.js",function(t,r,n){r=e(r,{},"curvature"),function(){"use strict";function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.Dom=void 0;var r=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t)}var r,n;return r=t,n=[{key:"mapTags",value:function(e,t,r,n,o){var i=[],a=!0;n&&(a=!1);for(var u=!1,s=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT,{acceptNode:function(e,r){if(!a){if(e!==n)return NodeFilter.FILTER_SKIP;a=!0}return o&&e===o&&(u=!0),u?NodeFilter.FILTER_SKIP:t?e instanceof Element&&e.matches(t)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT}},!1);s.nextNode();)i.push(r(s.currentNode,s));return i}},{key:"dispatchEvent",value:function(e,r){e.dispatchEvent(r),t.mapTags(e,!1,function(e){e.dispatchEvent(r)})}}],null&&e(r.prototype,null),n&&e(r,n),Object.defineProperty(r,"prototype",{writable:!1}),t}();t.Dom=r}()}),require.register("curvature/base/Mixin.js",function(t,r,n){r=e(r,{},"curvature"),function(){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Mixin=void 0;var e=r("./Bindable");function n(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||a(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=a(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return u=e.done,e},e:function(e){s=!0,i=e},f:function(){try{u||null==r.return||r.return()}finally{if(s)throw i}}}}function a(e,t){if(e){if("string"==typeof e)return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e,t){if(t&&("object"===o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return l(e)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function v(e,t,r){return t&&h(e.prototype,t),r&&h(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var p=Symbol("constructor"),y=(Symbol("mixinList"),function(){function t(){d(this,t)}return v(t,null,[{key:"from",value:function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return function(r){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(u,e);var a=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=f(e);if(t){var o=f(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return c(this,r)}}(u);function u(){var r;d(this,u);for(var s=arguments.length,f=new Array(s),h=0;h<s;h++)f[h]=arguments[h];var v,p=e.constructor?r=a.call.apply(a,[this].concat(f)):null,y=i(n);try{for(y.s();!(v=y.n()).done;){var b=v.value;switch(b[t.Constructor]&&b[t.Constructor].apply(l(r)),o(b)){case"function":t.mixClass(b,u);break;case"object":t.mixObject(b,l(r))}}}catch(e){y.e(e)}finally{y.f()}return c(r,p)}return v(u)}()}},{key:"make",value:function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var o=r.pop();return t.to.apply(t,[o].concat(r))}},{key:"to",value:function(e){for(var t={},r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];n.map(function(r){switch(o(r)){case"object":Object.assign(t,Object.getOwnPropertyDescriptors(r));break;case"function":Object.assign(t,Object.getOwnPropertyDescriptors(r.prototype))}delete t.constructor,Object.defineProperties(e.prototype,t)})}},{key:"with",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.from.apply(this,[v(function e(){d(this,e)})].concat(t))}},{key:"mixObject",value:function(e,t){var r,n=i(Object.getOwnPropertyNames(e));try{for(n.s();!(r=n.n()).done;){var o=r.value;"function"!=typeof e[o]?t[o]=e[o]:t[o]=e[o].bind(t)}}catch(e){n.e(e)}finally{n.f()}var a,u=i(Object.getOwnPropertySymbols(e));try{for(u.s();!(a=u.n()).done;){var s=a.value;"function"!=typeof e[s]?t[s]=e[s]:t[s]=e[s].bind(t)}}catch(e){u.e(e)}finally{u.f()}}},{key:"mixClass",value:function(e,t){var r,n=i(Object.getOwnPropertyNames(e.prototype));try{for(n.s();!(r=n.n()).done;){var o=r.value;if(!["name","prototype","length"].includes(o)){var a=Object.getOwnPropertyDescriptor(t,o);a&&!a.writable||("function"==typeof e[o]?t.prototype[o]=e.prototype[o].bind(t.prototype):t.prototype[o]=e.prototype[o])}}}catch(e){n.e(e)}finally{n.f()}var u,s=i(Object.getOwnPropertySymbols(e.prototype));try{for(s.s();!(u=s.n()).done;){var c=u.value;"function"==typeof e[c]?t.prototype[c]=e.prototype[c].bind(t.prototype):t.prototype[c]=e.prototype[c]}}catch(e){s.e(e)}finally{s.f()}var l,f=i(Object.getOwnPropertyNames(e));try{var d=function(){var r=l.value;if(["name","prototype","length"].includes(r))return"continue";var n=Object.getOwnPropertyDescriptor(t,r);if(n&&!n.writable)return"continue";if("function"!=typeof e[r])return t[r]=e[r],"continue";var o=t[r]||!1,i=e[r].bind(t);t[r]=function(){return o&&o.apply(void 0,arguments),i.apply(void 0,arguments)}};for(f.s();!(l=f.n()).done;)d()}catch(e){f.e(e)}finally{f.f()}var h,v=i(Object.getOwnPropertySymbols(e));try{var p=function(){var r=h.value;if("function"!=typeof e[r])return t.prototype[r]=e[r],"continue";var n=t[r]||!1,o=e[r].bind(t);t[r]=function(){return n&&n.apply(void 0,arguments),o.apply(void 0,arguments)}};for(v.s();!(h=v.n()).done;)p()}catch(e){v.e(e)}finally{v.f()}}},{key:"mix",value:function(t){for(var r={},o={},a=e.Bindable.makeBindable(t),u=function(e){var t,u=Object.getOwnPropertyNames(e.prototype),s=/^(before|after)__(.+)/,c=i(Object.getOwnPropertyNames(e));try{var l=function(){var o=t.value,i=o.match(s);if(i){switch(i[1]){case"before":a.___before(function(t,r,a,u,s){if(r===i[2])return e[o].bind(u).apply(void 0,n(s))});break;case"after":a.___after(function(t,r,a,u,s){if(r===i[2])return e[o].bind(u).apply(void 0,n(s))})}return"continue"}return r[o]||"function"!=typeof e[o]?"continue":void(r[o]=e[o])};for(c.s();!(t=c.n()).done;)l()}catch(e){c.e(e)}finally{c.f()}var f,d=i(u);try{var h=function(){var t=f.value,r=t.match(s);if(r){switch(r[1]){case"before":a.___before(function(o,i,a,u,s){if(i===r[2])return e.prototype[t].bind(u).apply(void 0,n(s))});break;case"after":a.___after(function(o,i,a,u,s){if(i===r[2])return e.prototype[t].bind(u).apply(void 0,n(s))})}return"continue"}return o[t]||"function"!=typeof e.prototype[t]?"continue":void(o[t]=e.prototype[t])};for(d.s();!(f=d.n()).done;)h()}catch(e){d.e(e)}finally{d.f()}},s=this;s&&s.prototype;s=Object.getPrototypeOf(s))u(s);for(var c in r)t[c]=r[c].bind(t);var l=function(e){t.prototype[e]=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return o[e].apply(this,r)}};for(var f in o)l(f);return a}}]),t}());t.Mixin=y,y.Constructor=p}()}),require.register("curvature/base/Router.js",function(t,r,n){r=e(r,{},"curvature"),function(){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Router=void 0;var e,n=r("./View"),o=(r("./Cache"),r("./Config")),i=r("./Routes");function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i=[],a=!0,u=!1;try{for(r=r.call(e);!(a=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){u=!0,o=e}finally{try{a||null==r.return||r.return()}finally{if(u)throw o}}return i}}(e,t)||s(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=s(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){u=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function s(e,t){if(e){if("string"==typeof e)return c(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(e,t):void 0}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var d=Symbol("NotFound"),h=Symbol("Internal");globalThis.CustomEvent=null!==(e=globalThis.CustomEvent)&&void 0!==e?e:globalThis.Event;var v=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r;return t=e,r=[{key:"wait",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"DOMContentLoaded";(arguments.length>2&&void 0!==arguments[2]?arguments[2]:document).addEventListener(r,function(){t.listen(e)})}},{key:"listen",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.listener=e||this.listener,this.routes=r||e.routes,Object.assign(this.query,this.queryOver({}));var n=function(r){r.preventDefault(),r.state&&"routedId"in r.state?(r.state.routedId<=t.routeCount?(t.history.splice(r.state.routedId),t.routeCount=r.state.routedId):r.state.routedId>t.routeCount&&(t.history.push(r.state.prev),t.routeCount=r.state.routedId),t.state=r.state):null!==t.prevPath&&t.prevPath!==location.pathname&&t.history.push(t.prevPath),"null"!==location.origin?t.match(location.pathname,e):t.match(t.nextPath,e)};window.addEventListener("cvUrlChanged",n),window.addEventListener("popstate",n);var o="null"!==location.origin&&location.pathname+location.search;location.origin&&location.hash&&(o+=location.hash);var i={routedId:this.routeCount,url:location.pathname,prev:this.prevPath};"null"!==location.origin&&history.replaceState(i,null,location.pathname),this.go(!1!==o?o:"/")}},{key:"go",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=o.Config.get("title");r&&(document.title=r);var n={routedId:this.routeCount,prev:this.prevPath,url:location.pathname};-1===t?this.match(e,this.listener,!0):"null"===location.origin?this.nextPath=e:2===t&&location.pathname!==e?history.replaceState(n,null,e):location.pathname!==e&&history.pushState(n,null,e),(!t||t<0)&&(!1===t&&(this.path=null),t||("#"===e.substring(0,1)?window.dispatchEvent(new HashChangeEvent("hashchange")):window.dispatchEvent(new CustomEvent("cvUrlChanged")))),this.prevPath=e}},{key:"processRoute",value:function(e,t,r){return"function"==typeof e[t]?e[t].prototype instanceof n.View?new e[t](r):e[t](r):e[t]}},{key:"handleError",value:function(e,t,r,n,o,i,a,u){console.error(e),"undefined"!=typeof document&&document.dispatchEvent(new CustomEvent("cvRouteError",{detail:{error:e,path:i,prev:a,view:o,routes:t,selected:r}}));var s=globalThis.devMode?"Unexpected error: "+String(e):"Unexpected error.";t[h]&&(n[h]=e,s=this.processRoute(t,h,n)),this.update(o,i,s,t,r,n,u)}},{key:"match",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=null,s=!1;if(!0===n&&(s=n),n&&"object"===l(n)&&(s=n.forceRefresh,o=n.event),"undefined"==typeof document||this.path!==e||s){var c="http://example.com";"undefined"!=typeof document&&(c="null"!==location.origin?location.origin:c,this.queryString=location.search);var f=new URL(e,c);e=this.path=f.pathname,"undefined"==typeof document&&(this.queryString=f.search);var h=this.prevPath,v=t&&t.args?t.args.content:null,p=this.routes||t&&t.routes||i.Routes.dump(),y=new URLSearchParams(this.queryString);for(var b in o&&o.request&&(this.request=o.request),Object.keys(this.query))delete this.query[b];var m,g=u(y);try{for(g.s();!(m=g.n()).done;){var w=a(m.value,2),_=w[0],O=w[1];this.query[_]=O}}catch(e){g.e(e)}finally{g.f()}var E={},j=!1,k="";for(var T in"/"===e.substring(0,1)&&(e=e.substring(1)),e=e.split("/"),this.query)E[T]=this.query[T];e:for(var S in p){var P=S.split("/");if(!(P.length<e.length&&"*"!==P[P.length-1])){for(var R in P)if("%"==P[R].substr(0,1)){var x=null,A=/^%(\w+)\??/.exec(P[R]);if(A&&A[1]&&(x=A[1]),!x)throw new Error("".concat(P[R],' is not a valid argument segment in route "').concat(S,'"'));if(e[R])E[x]=e[R];else{if("?"!=P[R].substr(P[R].length-1,1))continue e;E[x]=""}}else if("*"!==P[R]&&e[R]!==P[R])continue e;j=S,k=p[S],"*"===P[P.length-1]&&(E.pathparts=e.slice(P.length-1));break}}var C=new CustomEvent("cvRouteStart",{cancelable:!0,detail:{path:e,prev:h,root:t,selected:j,routes:p}});if("undefined"==typeof document||document.dispatchEvent(C)){if(!s&&t&&v&&k instanceof Object&&v instanceof k&&!(k instanceof Promise)&&v.update(E))return t.args.content=v,!0;j in p||(p[j]=p[d]);try{return!1===(k=this.processRoute(p,j,E))&&(k=this.processRoute(p,d,E)),k instanceof Promise||(k=Promise.resolve(k)),"undefined"==typeof document?k:k.then(function(n){r.update(t,e,n,p,j,E,s)}).catch(function(n){r.handleError(n,p,j,E,t,e,h,s)})}catch(r){this.handleError(r,p,j,E,t,e,h,s)}}}}},{key:"update",value:function(e,t,r,o,i,a,u){if(e){var s=this.prevPath,c=new CustomEvent("cvRoute",{cancelable:!0,detail:{result:r,path:t,prev:s,view:e,routes:o,selected:i}});!1!==r&&(e.args.content instanceof n.View&&(e.args.content.pause(!0),e.args.content.remove()),document.dispatchEvent(c)&&(e.args.content=r),r instanceof n.View&&(r.pause(!1),r.update(a,u)));var l=new CustomEvent("cvRouteEnd",{cancelable:!0,detail:{result:r,path:t,prev:s,view:e,routes:o,selected:i}});document.dispatchEvent(l)}}},{key:"queryOver",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r={},n={},o=u(new URLSearchParams(location.search));try{for(o.s();!(e=o.n()).done;){var i=e.value;n[i[0]]=i[1]}}catch(e){o.e(e)}finally{o.f()}return delete(r=Object.assign(r,n,t)).api,r}},{key:"queryToString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=[],n=e;for(var o in t||(n=this.queryOver(e)),n)""!==n[o]&&r.push(o+"="+encodeURIComponent(n[o]));return r.join("&")}},{key:"setQuery",value:function(e,t,r){var n=this.queryOver();n[e]=t,void 0===t&&delete n[e];var o=this.queryToString(n,!0);this.go(location.pathname+(o?"?"+o:"?"),r)}}],null&&f(t.prototype,null),r&&f(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.Router=v,Object.defineProperty(v,"query",{configurable:!1,enumerable:!1,writable:!1,value:{}}),Object.defineProperty(v,"history",{configurable:!1,enumerable:!1,writable:!1,value:[]}),Object.defineProperty(v,"routeCount",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(v,"prevPath",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(v,"queryString",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(v,"InternalError",{configurable:!1,enumerable:!1,writable:!1,value:h}),Object.defineProperty(v,"NotFoundError",{configurable:!1,enumerable:!1,writable:!1,value:d})}()}),require.register("curvature/base/Routes.js",function(t,r,n){r=e(r,{},"curvature"),function(){"use strict";function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.Routes=void 0;var n={},o=r,i=!1,a=function(){if(!i){try{Object.assign(n,o("Routes").Routes||{})}catch(e){!0===globalThis.devMode&&console.warn(e)}i=!0}},u=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t)}var r,n;return r=t,n=[{key:"get",value:function(e){return a(),this.routes[e]}},{key:"dump",value:function(){return a(),this.routes}}],null&&e(r.prototype,null),n&&e(r,n),Object.defineProperty(r,"prototype",{writable:!1}),t}();t.Routes=u,Object.defineProperty(u,"routes",{configurable:!1,enumerable:!1,writable:!1,value:n})}()}),require.register("curvature/base/RuleSet.js",function(t,r,n){r=e(r,{},"curvature"),function(){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RuleSet=void 0,r("./Dom");var e=r("./Tag"),n=r("./View");function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i=[],a=!0,u=!1;try{for(r=r.call(e);!(a=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){u=!0,o=e}finally{try{a||null==r.return||r.return()}finally{if(u)throw o}}return i}}(e,t)||a(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=a(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return u=e.done,e},e:function(e){s=!0,i=e},f:function(){try{u||null==r.return||r.return()}finally{if(s)throw i}}}}function a(e,t){if(e){if("string"==typeof e)return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var c=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t)}var r,a,u;return r=t,a=[{key:"add",value:function(e,t){return this.rules=this.rules||{},this.rules[e]=this.rules[e]||[],this.rules[e].push(t),this}},{key:"apply",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;for(var n in t.apply(e,r),this.rules)for(var o in this.rules[n]){var a,u=this.rules[n][o],s=t.wrap(e,u,r),c=i(e.querySelectorAll(n));try{for(c.s();!(a=c.n()).done;){s(a.value)}}catch(e){c.e(e)}finally{c.f()}}}},{key:"purge",value:function(){if(this.rules)for(var e=0,t=Object.entries(this.rules);e<t.length;e++){var r=o(t[e],2),n=r[0];if(r[1],this.rules[n])for(var i in this.rules[n])delete this.rules[n][i]}}}],u=[{key:"add",value:function(e,t){return this.globalRules=this.globalRules||{},this.globalRules[e]=this.globalRules[e]||[],this.globalRules[e].push(t),this}},{key:"apply",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;for(var r in this.globalRules)for(var n in this.globalRules[r]){var o,a=this.globalRules[r][n],u=this.wrap(e,a,t),s=i(e.querySelectorAll(r));try{for(s.s();!(o=s.n()).done;){u(o.value)}}catch(e){s.e(e)}finally{s.f()}}}},{key:"wait",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"DOMContentLoaded",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,n=function(t,r){return function(){return r.removeEventListener(t,n),e.apply()}}(t,r);r.addEventListener(t,n)}},{key:"wrap",value:function(t,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=r;return(r instanceof n.View||r&&r.prototype&&r.prototype instanceof n.View)&&(i=function(){return r}),function(t){if(void 0===t.___cvApplied___&&Object.defineProperty(t,"___cvApplied___",{enumerable:!1,writable:!1,value:new WeakSet}),!t.___cvApplied___.has(r)){var a,u;o&&(a=u=o,o.viewList&&(u=o.viewList.parent));var s,c=new e.Tag(t,u,null,void 0,a),l=c.element.parentNode,f=c.element.nextSibling,d=i(c);if(!1!==d&&t.___cvApplied___.add(r),d instanceof HTMLElement&&(d=new e.Tag(d)),d instanceof e.Tag){if(!d.element.contains(c.element)){for(;c.element.firstChild;)d.element.appendChild(c.element.firstChild);c.remove()}f?l.insertBefore(d.element,f):l.appendChild(d.element)}d&&d.prototype&&d.prototype instanceof n.View&&(d=new d({},o)),d instanceof n.View&&(o&&(o.cleanup.push((s=d,function(){s.remove()})),o.cleanup.push(o.args.bindTo(function(e,t,r){r[t]=e,d.args[t]=e})),o.cleanup.push(d.args.bindTo(function(e,t,r,n){r[t]=e,o.args[t]=e}))),c.clear(),d.render(c.element))}}}}],a&&s(r.prototype,a),u&&s(r,u),Object.defineProperty(r,"prototype",{writable:!1}),t}();t.RuleSet=c}()}),require.register("curvature/base/SetMap.js",function(t,r,n){r=e(r,{},"curvature"),function(){"use strict";function e(t,n,o){return(e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,n){var o=[null];o.push.apply(o,t);var i=new(Function.bind.apply(e,o));return n&&r(i,n.prototype),i}).apply(null,arguments)}function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function n(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||o(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){if(e){if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.SetMap=void 0;var u=function(){function t(){var e,r,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=this,r="_map",n=new Map,r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n}var r,i;return r=t,(i=[{key:"has",value:function(e){return this._map.has(e)}},{key:"get",value:function(e){return this._map.get(e)}},{key:"getOne",value:function(e){var t,r=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=o(e))){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,u=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return u=e.done,e},e:function(e){s=!0,a=e},f:function(){try{u||null==r.return||r.return()}finally{if(s)throw a}}}}(this.get(e));try{for(r.s();!(t=r.n()).done;)return t.value}catch(e){r.e(e)}finally{r.f()}}},{key:"add",value:function(e,t){var r=this._map.get(e);return r||this._map.set(e,r=new Set),r.add(t)}},{key:"remove",value:function(e,t){var r=this._map.get(e);if(r){var n=r.delete(t);return r.size||this._map.delete(e),n}}},{key:"values",value:function(){return e(Set,n(n(this._map.values()).map(function(e){return n(e.values())})))}}])&&a(r.prototype,i),Object.defineProperty(r,"prototype",{writable:!1}),t}();t.SetMap=u}()}),require.register("curvature/base/Tag.js",function(t,r,n){r=e(r,{},"curvature"),function(){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Tag=void 0;var e=r("./Bindable");function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=Symbol("CurrentStyle"),i=function(e){if(this.node)for(var t in e){var r=String(e[t]);this[o].has(t)&&this[o].get(t)===e[t]||("-"===t[0]?this.node.style.setProperty(t,r):this.node.style[t]=r,void 0!==e[t]?this[o].set(t,e[t]):this[o].delete(t))}},a=function(e){var t=this;return"function"==typeof this[e]?this[e]:this.node&&"function"==typeof this.node[e]?function(){var r;return(r=t.node)[e].apply(r,arguments)}:"style"===e?this.proxy.style:this.node&&e in this.node?this.node[e]:this[e]},u=function(){function t(r,n,u,s,c){var l=this;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),"string"==typeof r){var f=document.createRange().createContextualFragment(r);r=f.firstChild}this.element=e.Bindable.makeBindable(r),this.node=this.element,this.parent=n,this.direct=c,this.ref=u,this.index=s,this.cleanup=[],this[e.Bindable.OnAllGet]=a.bind(this),this[o]=new Map;var d=e.Bindable.make(i.bind(this));return Object.defineProperty(this,"style",{value:d}),this.proxy=e.Bindable.make(this),this.proxy.style.bindTo(function(e,t,r,n){l[o].has(t)&&l[o].get(t)===e||(l.node.style[t]=e,n||void 0===e?l[o].delete(t):l[o].set(t,e))}),this.proxy.bindTo(function(e,t){if("index"!==t)return t in r&&r[t]!==e&&(r[t]=e),!1}),this.proxy}var r,u;return r=t,(u=[{key:"attr",value:function(e){for(var t in e)void 0===e[t]?this.node.removeAttribute(t):null===e[t]?this.node.setAttribute(t,""):this.node.setAttribute(t,e[t]);return this}},{key:"remove",value:function(){var t;for(this.node&&this.node.remove(),e.Bindable.clearBindings(this);t=this.cleanup.shift();)t();if(this.clear(),this.node){var r=new Event("cvDomDetached");this.node.dispatchEvent(r),this.node=this.element=this.ref=this.parent=void 0}}},{key:"clear",value:function(){if(this.node)for(var e=new Event("cvDomDetached");this.node.firstChild;)this.node.firstChild.dispatchEvent(e),this.node.removeChild(this.node.firstChild)}},{key:"pause",value:function(){}},{key:"listen",value:function(e,t,r){var n=this.node;n.addEventListener(e,t,r);var o=function(){n.removeEventListener(e,t,r)},i=function(){o(),o=function(){return console.warn("Already removed!")}};return this.parent.onRemove(function(){return i()}),i}}])&&n(r.prototype,u),Object.defineProperty(r,"prototype",{writable:!1}),t}();t.Tag=u}()}),require.register("curvature/base/Uuid.js",function(t,r,n){r=e(r,{},"curvature"),function(){"use strict";var e;function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.defineProperty(t,"__esModule",{value:!0}),t.Uuid=void 0,e=Symbol.toPrimitive;var o=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n(this,"uuid",null),n(this,"version",4),e){if(!e||"string"!=typeof e&&!(e instanceof t)||!e.match(/[0-9A-Fa-f]{8}(-[0-9A-Fa-f]{4}){3}-[0-9A-Fa-f]{12}/))throw new Error('Invalid input for Uuid: "'.concat(e,'"'));this.version=r,this.uuid=e}else"function"==typeof crypto.randomUUID?this.uuid=crypto.randomUUID():this.uuid=([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)});Object.freeze(this)}var o,i;return o=t,(i=[{key:e,value:function(){return this.toString()}},{key:"toString",value:function(){return this.uuid}},{key:"toJson",value:function(){return{version:this.version,uuid:this.uuid}}}])&&r(o.prototype,i),Object.defineProperty(o,"prototype",{writable:!1}),t}();t.Uuid=o}()}),require.register("curvature/base/View.js",function(t,r,n){r=e(r,{},"curvature"),function(){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.View=void 0;var e=r("./Bindable"),n=r("./ViewList"),o=r("./Router"),i=r("./Uuid"),a=r("./Dom"),u=r("./Tag"),s=r("./Bag"),c=r("./RuleSet"),l=r("./Mixin"),f=(r("../mixin/PromiseMixin"),r("../mixin/EventTargetMixin"));function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e){return function(e){if(Array.isArray(e))return b(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||y(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i=[],a=!0,u=!1;try{for(r=r.call(e);!(a=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){u=!0,o=e}finally{try{a||null==r.return||r.return()}finally{if(u)throw o}}return i}}(e,t)||y(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=y(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){u=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function y(e,t){if(e){if("string"==typeof e)return b(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?b(e,t):void 0}}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=O(e);if(t){var o=O(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"===d(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _(e)}(this,r)}}function _(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var E=Symbol("dontParse"),j=Symbol("expandBind"),k=Symbol("uuid"),T=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g(e,t)}(O,t);var l,f,y,b=w(O);function O(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,O),t=b.call(this,r,n),Object.defineProperty(_(t),"args",{value:e.Bindable.make(r)}),Object.defineProperty(_(t),k,{value:t.constructor.uuid()}),Object.defineProperty(_(t),"nodesAttached",{value:new s.Bag(function(e,t,r){})}),Object.defineProperty(_(t),"nodesDetached",{value:new s.Bag(function(e,t,r){})}),Object.defineProperty(_(t),"_onRemove",{value:new s.Bag(function(e,t,r){})}),Object.defineProperty(_(t),"cleanup",{value:[]}),Object.defineProperty(_(t),"parent",{value:n}),Object.defineProperty(_(t),"views",{value:new Map}),Object.defineProperty(_(t),"viewLists",{value:new Map}),Object.defineProperty(_(t),"withViews",{value:new Map}),Object.defineProperty(_(t),"tags",{value:e.Bindable.make({})}),Object.defineProperty(_(t),"nodes",{value:e.Bindable.make([])}),Object.defineProperty(_(t),"timeouts",{value:new Map}),Object.defineProperty(_(t),"intervals",{value:[]}),Object.defineProperty(_(t),"frames",{value:[]}),Object.defineProperty(_(t),"ruleSet",{value:new c.RuleSet}),Object.defineProperty(_(t),"preRuleSet",{value:new c.RuleSet}),Object.defineProperty(_(t),"subBindings",{value:{}}),Object.defineProperty(_(t),"templates",{value:{}}),Object.defineProperty(_(t),"eventCleanup",{value:[]}),Object.defineProperty(_(t),"unpauseCallbacks",{value:new Map}),Object.defineProperty(_(t),"interpolateRegex",{value:/(\[\[((?:\$+)?[\w\.\|-]+)\]\])/g}),Object.defineProperty(_(t),"rendered",{value:new Promise(function(e,r){return Object.defineProperty(_(t),"renderComplete",{value:e})})}),t.controller=_(t),t.loaded=Promise.resolve(_(t)),t.template="",t.firstNode=null,t.lastNode=null,t.viewList=null,t.mainView=null,t.preserve=!1,t.removed=!1,t}return l=O,f=[{key:"_id",get:function(){return this[k]}},{key:"onFrame",value:function(e){var t=this,r=!1,n=function(){r=!0};return requestAnimationFrame(function(){return function n(o){t.removed||r||(t.paused||e(Date.now()),requestAnimationFrame(n))}(Date.now())}),this.frames.push(n),n}},{key:"onNextFrame",value:function(e){return requestAnimationFrame(function(){return e(Date.now())})}},{key:"onIdle",value:function(e){return requestIdleCallback(function(){return e(Date.now())})}},{key:"onTimeout",value:function(e,t){var r=this,n={timeout:null,callback:null,time:e,fired:!1,created:(new Date).getTime(),paused:!1},o=function(){t(),n.fired=!0,r.timeouts.delete(n.timeout)},i=setTimeout(o,e);return n.callback=o,n.timeout=i,this.timeouts.set(n.timeout,n),i}},{key:"clearTimeout",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){var t,r=p(this.timeouts);try{for(r.s();!(t=r.n()).done;){var n=v(t.value,2),o=(n[0],n[1]);clearTimeout(o.timeout),this.timeouts.delete(o.timeout)}}catch(e){r.e(e)}finally{r.f()}})},{key:"onInterval",value:function(e,t){var r=setInterval(t,e);return this.intervals.push({timeout:r,callback:t,time:e,paused:!1}),r}},{key:"clearInterval",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){for(var t in this.intervals)e===this.intervals[t].timeout&&(clearInterval(this.intervals[t].timeout),delete this.intervals[t])})},{key:"pause",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;if(void 0===e&&(this.paused=!this.paused),this.paused=e,this.paused){var t,r=p(this.timeouts);try{for(r.s();!(t=r.n()).done;){var n=v(t.value,2),o=(n[0],n[1]);o.fired?this.timeouts.delete(o.timeout):(clearTimeout(o.timeout),o.paused=!0,o.time=Math.max(0,o.time-(Date.now()-o.created)))}}catch(e){r.e(e)}finally{r.f()}for(var i in this.intervals)clearInterval(this.intervals[i].timeout)}else{var a,u=p(this.timeouts);try{for(u.s();!(a=u.n()).done;){var s=v(a.value,2),c=(s[0],s[1]);c.paused&&(c.fired?this.timeouts.delete(c.timeout):(c.timeout=setTimeout(c.callback,c.time),c.paused=!1))}}catch(e){u.e(e)}finally{u.f()}for(var l in this.intervals)this.intervals[l].timeout.paused&&(this.intervals[l].timeout.paused=!1,this.intervals[l].timeout=setInterval(this.intervals[l].callback,this.intervals[l].time));var f,d=p(this.unpauseCallbacks);try{for(d.s();!(f=d.n()).done;){(0,v(f.value,2)[1])()}}catch(e){d.e(e)}finally{d.f()}this.unpauseCallbacks.clear()}var h,y=p(this.viewLists);try{for(y.s();!(h=y.n()).done;){var b=v(h.value,2);(b[0],b[1]).pause(!!e)}}catch(e){y.e(e)}finally{y.f()}for(var m in this.tags)if(Array.isArray(this.tags[m]))for(var g in this.tags[m])this.tags[m][g].pause(!!e);else this.tags[m].pause(!!e)}},{key:"render",value:function(){var e,t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(r instanceof O&&(r=r.firstNode.parentNode),n instanceof O&&(n=n.firstNode),this.firstNode)return this.reRender(r,n);this.dispatchEvent(new CustomEvent("render"));var o=this.template instanceof DocumentFragment?this.template.cloneNode(!0):O.templates.has(this.template),i=o?this.template instanceof DocumentFragment?o:O.templates.get(this.template).cloneNode(!0):document.createRange().createContextualFragment(this.template);if(o||this.template instanceof DocumentFragment||O.templates.set(this.template,i.cloneNode(!0)),this.mainView||this.preRuleSet.apply(i,this),this.mapTags(i),this.mainView||this.ruleSet.apply(i,this),!0===window.devMode?(this.firstNode=document.createComment("Template ".concat(this._id," Start")),this.lastNode=document.createComment("Template ".concat(this._id," End"))):(this.firstNode=document.createTextNode(""),this.lastNode=document.createTextNode("")),(e=this.nodes).push.apply(e,[this.firstNode].concat(h(Array.from(i.childNodes)),[this.lastNode])),this.postRender(r),this.dispatchEvent(new CustomEvent("rendered")),this.dispatchAttach()){if(r){var a=r.getRootNode();if(n?(r.insertBefore(this.firstNode,n),r.insertBefore(this.lastNode,n)):(r.appendChild(this.firstNode),r.appendChild(this.lastNode)),r.insertBefore(i,this.lastNode),a.isConnected)this.attached(a,r),this.dispatchAttached(a,r);else{r.addEventListener("cvDomAttached",function e(n){n.target.isConnected&&(t.attached(a,r),t.dispatchAttached(a,r),r.removeEventListener("cvDomAttached",e))})}}return this.renderComplete(this.nodes),this.nodes}}},{key:"dispatchAttach",value:function(){return this.dispatchEvent(new CustomEvent("attach",{cancelable:!0,target:this}))}},{key:"dispatchAttached",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;this.dispatchEvent(new CustomEvent("attached",{detail:{view:r||this,node:t,root:e,mainView:this}})),this.dispatchDomAttached(r);var n,o=p(this.nodesAttached.items());try{for(o.s();!(n=o.n()).done;){(0,n.value)(e,t)}}catch(e){o.e(e)}finally{o.f()}}},{key:"dispatchDomAttached",value:function(e){var t=this;this.nodes.filter(function(e){return e.nodeType!==Node.COMMENT_NODE}).forEach(function(r){r.matches&&(a.Dom.mapTags(r,!1,function(r,n){r.matches&&r.dispatchEvent(new CustomEvent("cvDomAttached",{target:r,detail:{view:e||t,mainView:t}}))}),r.dispatchEvent(new CustomEvent("cvDomAttached",{target:r,detail:{view:e||t,mainView:t}})))})}},{key:"reRender",value:function(e,t){if(this.dispatchEvent(new CustomEvent("reRender"),{cancelable:!0,target:this})){var r=new DocumentFragment;if(this.firstNode.isConnected){var n=this.nodesDetached.items();for(var o in n)n[o]()}if(r.append.apply(r,h(this.nodes)),e){t?(e.insertBefore(this.firstNode,t),e.insertBefore(this.lastNode,t)):(e.appendChild(this.firstNode),e.appendChild(this.lastNode)),e.insertBefore(r,this.lastNode),this.dispatchEvent(new CustomEvent("reRendered"),{cancelable:!0,target:this});var i=e.getRootNode();i.isConnected&&(this.attached(i,e),this.dispatchAttached(i,e))}return this.nodes}}},{key:"mapTags",value:function(e){var t=this;a.Dom.mapTags(e,!1,function(e,r){e[E]||(e=e.matches?(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=t.mapInterpolatableTag(e)).matches("[cv-template]")&&t.mapTemplateTag(e)||e).matches("[cv-slot]")&&t.mapSlotTag(e)||e).matches("[cv-prerender]")&&t.mapPrendererTag(e)||e).matches("[cv-link]")&&t.mapLinkTag(e)||e).matches("[cv-attr]")&&t.mapAttrTag(e)||e).matches("[cv-expand]")&&t.mapExpandableTag(e)||e).matches("[cv-ref]")&&t.mapRefTag(e)||e).matches("[cv-on]")&&t.mapOnTag(e)||e).matches("[cv-each]")&&t.mapEachTag(e)||e).matches("[cv-bind]")&&t.mapBindTag(e)||e).matches("[cv-with]")&&t.mapWithTag(e)||e).matches("[cv-if]")&&t.mapIfTag(e)||e).matches("[cv-view]")&&t.mapViewTag(e)||e:t.mapInterpolatableTag(e))!==r.currentNode&&(r.currentNode=e)})}},{key:"mapExpandableTag",value:function(t){var r=t[j];r&&(r(),t[j]=!1);var n=v(e.Bindable.resolve(this.args,t.getAttribute("cv-expand"),!0),2),o=n[0],i=n[1];return t.removeAttribute("cv-expand"),o[i]||(o[i]={}),o[i]=e.Bindable.make(o[i]),this.onRemove(t[j]=o[i].bindTo(function(e,r,n,o,i){o||void 0===e?t.removeAttribute(r,e):null!==e?t.setAttribute(r,e):t.setAttribute(r,"")})),t}},{key:"compileExpandableTag",value:function(t){return function(r){var n=t.cloneNode(!0),o=n.getAttribute("cv-expand"),i=e.Bindable.make(r.args[o]||{});n.removeAttribute("cv-expand");var a=function(t){if("name"===t||"type"===t)return"continue";var o=i.bindTo(t,function(e,t){return function(r){e.setAttribute(t,r)}}(n,t));r.onRemove(function(){o(),i.isBound()&&e.Bindable.clearBindings(i)})};for(var u in i)a(u);return n}}},{key:"mapAttrTag",value:function(e){var t=this.compileAttrTag(e)(this);return e.replaceWith(t),t}},{key:"compileAttrTag",value:function(t){var r=t.getAttribute("cv-attr").split(",").map(function(e){return e.split(":")});return t.removeAttribute("cv-attr"),function(n){var o=t.cloneNode(!0),i=function(t){var i=r[t][1]||r[t][0],a=v(e.Bindable.resolve(n.args,i,!0),2),u=a[0],s=a[1],c=r[t][0];n.onRemove(u.bindTo(s,function(e,t,r,n){n||void 0===e?o.removeAttribute(c,e):null!==e?o.setAttribute(c,e):o.setAttribute(c,"")}))};for(var a in r)i(a);return o}}},{key:"mapInterpolatableTag",value:function(t){var r=this,n=this.interpolateRegex;if(t.nodeType===Node.TEXT_NODE){var o=t.nodeValue;if(!this.interpolatable(o))return t;for(var i,a=0,s=function(){var n=i[2],s=!1,c=!1,l=n.split("|"),f=!1;if(l.length>1&&(f=r.stringTransformer(l.slice(1)),n=l[0]),"$$"===n.substr(0,2)&&(s=!0,c=!0,n=n.substr(2)),"$"===n.substr(0,1)&&(s=!0,n=n.substr(1)),"000"===n.substr(0,3))return expand=!0,n=n.substr(3),"continue";var h=o.substring(a,i.index);a=i.index+i[1].length;var p=document.createTextNode(h);p[E]=!0,t.parentNode.insertBefore(p,t);var y=void 0;(y=s?document.createElement("div"):document.createTextNode(""))[E]=!0;var b=r.args,m=n;if(n.match(/\./)){var g=v(e.Bindable.resolve(r.args,n,!0),2);b=g[0],m=g[1]}if(t.parentNode.insertBefore(y,t),"object"!==d(b))return"break";var w=(b=e.Bindable.make(b)).bindTo(m,function(e,n,o){if(o[n]!==e&&(o[n]instanceof O||o[n]instanceof Node||o[n]instanceof u.Tag)&&(o[n].preserve||o[n].remove()),y.nodeValue="",c&&!(e instanceof O)){var i,a=null!==(i=e)&&void 0!==i?i:"";(e=new O(r.args,r)).template=a}if(f&&(e=f(e)),e instanceof O){var l=function(t,n){e.dispatchAttached(t,n,r)};r.nodesAttached.add(l),e.render(t.parentNode,y);var d=function(){e.preserve||e.remove()};r.onRemove(d),e.onRemove(function(){r.nodesAttached.remove(l),r._onRemove.remove(d)})}else e instanceof Node?(t.parentNode.insertBefore(e,y),r.onRemove(function(){return e.remove()})):e instanceof u.Tag?e.node?(t.parentNode.insertBefore(e.node,y),r.onRemove(function(){return e.remove()})):e.remove():(e instanceof Object&&e.__toString instanceof Function&&(e=e.__toString()),s?y.innerHTML=e:y.nodeValue=e);y[E]=!0});r.onRemove(w)};i=n.exec(o);){var c=s();if("continue"!==c&&"break"===c)break}var l=o.substring(a),f=document.createTextNode(l);f[E]=!0,t.parentNode.insertBefore(f,t),t.nodeValue=""}else if(t.nodeType===Node.ELEMENT_NODE)for(var h=function(o){if(!r.interpolatable(t.attributes[o].value))return"continue";for(var i=0,a=void 0,u=t.attributes[o].value,s=t.attributes[o],c={},l=[];a=n.exec(u);)l.push(u.substring(i,a.index)),c[a[2]]||(c[a[2]]=[]),c[a[2]].push(l.length),l.push(a[1]),i=a.index+a[1].length;l.push(u.substring(i));var f=function(n){var o=r.args,i=n,a=n.split("|"),u=!1,f=n;if(a.length>1&&(u=r.stringTransformer(a.slice(1)),i=a[0]),i.match(/\./)){var d=v(e.Bindable.resolve(r.args,i,!0),2);o=d[0],i=d[1]}c[f],r.onRemove(o.bindTo(i,function(e,n,o,a){for(var d in u&&(e=u(e)),c)for(var h in c[f])l[c[f][h]]=o[d],n===i&&(l[c[f][h]]=e);r.paused?r.unpauseCallbacks.set(s,function(){return t.setAttribute(s.name,l.join(""))}):t.setAttribute(s.name,l.join(""))})),r.onRemove(function(){o.isBound()||e.Bindable.clearBindings(o)})};for(var d in c)f(d)},p=0;p<t.attributes.length;p++)h(p);return t}},{key:"mapRefTag",value:function(e){var t=v(e.getAttribute("cv-ref").split(":"),3),r=t[0],n=t[1],o=void 0===n?null:n,i=t[2],a=void 0===i?null:i,s=u.Tag;o&&(s=this.stringToClass(o)),e.removeAttribute("cv-ref"),Object.defineProperty(e,"___tag___",{enumerable:!1,writable:!0}),this.onRemove(function(){e.___tag___=null,e.remove()});var c=this;this.viewList&&(c=this.viewList.parent);var l=new s(e,this,r,void 0,this);for(e.___tag___=l,this.tags[r]=l;c;){var f=this.args[a];if(void 0!==f?(c.tags[r]||(c.tags[r]=[]),c.tags[r][f]=l):c.tags[r]=l,!c.parent)break;c=c.parent}return e}},{key:"mapBindTag",value:function(t){var r=this,n=t.getAttribute("cv-bind"),o=this.args,i=n,s=null;if(n.match(/\./)){var c=v(e.Bindable.resolve(this.args,n,!0),3);o=c[0],i=c[1],s=c[2]}o!==this.args&&(this.subBindings[n]=this.subBindings[n]||[],this.onRemove(this.args.bindTo(s,function(){for(;r.subBindings.length;)r.subBindings.shift()()})));var l=!1;"$"===i.substr(0,1)&&(i=i.substr(1),l=!0);var f=o.bindTo(i,function(e,n,o,i,s){(s instanceof O||s instanceof Node||s instanceof u.Tag)&&s!==e&&s.remove();var c=new CustomEvent("cvAutoChanged",{bubbles:!0});if(["INPUT","SELECT","TEXTAREA"].includes(t.tagName)){var f=t.getAttribute("type");if(f&&"checkbox"===f.toLowerCase())t.checked=!!e,t.dispatchEvent(c);else if(f&&"radio"===f.toLowerCase())t.checked=e==t.value,t.dispatchEvent(c);else if("file"!==f){if("SELECT"===t.tagName){var d=function(){for(var r=0;r<t.options.length;r++)t.options[r].value==e&&(t.selectedIndex=r)};d(),r.nodesAttached.add(d)}else t.value=null==e?"":e;t.dispatchEvent(c)}}else if(e instanceof O){var h,v=p(t.childNodes);try{for(v.s();!(h=v.n()).done;)h.value.remove()}catch(e){v.e(e)}finally{v.f()}var y=function(t){e.dispatchDomAttached(r)};r.nodesAttached.add(y),e.render(t),e.onRemove(function(){return r.nodesAttached.remove(y)})}else if(e instanceof Node)t.insert(e);else if(e instanceof u.Tag)t.append(e.node);else if(l){if(t.innerHTML!==e){if(e=String(e),t.innerHTML===e.substring(0,t.innerHTML.length))t.innerHTML+=e.substring(t.innerHTML.length);else{var b,m=p(t.childNodes);try{for(m.s();!(b=m.n()).done;)b.value.remove()}catch(e){m.e(e)}finally{m.f()}t.innerHTML=e}a.Dom.mapTags(t,!1,function(e){return e[E]=!0})}}else if(t.textContent!==e){var g,w=p(t.childNodes);try{for(w.s();!(g=w.n()).done;)g.value.remove()}catch(e){w.e(e)}finally{w.f()}t.textContent=e}});o!==this.args&&this.subBindings[n].push(f),this.onRemove(f);var d=t.getAttribute("type"),h=t.getAttribute("multiple"),y=function(r){if(r.target===t)if(d&&"checkbox"===d.toLowerCase())t.checked?o[i]=r.target.getAttribute("value"):o[i]=!1;else if(r.target.matches("[contenteditable=true]"))o[i]=r.target.innerHTML;else if("file"===d&&h){var n=Array.from(r.target.files),a=o[i]||e.Bindable.onDeck(o,i);if(a&&n.length){var u=function(e){if(n[e]!==a[e])return n[e].toJSON=function(){return{name:file[e].name,size:file[e].size,type:file[e].type,date:file[e].lastModified}},a[e]=n[e],"break"};for(var s in n)if("break"===u(s))break}else o[i]=n}else if("file"===d&&!h&&r.target.files.length){var c=r.target.files.item(0);c.toJSON=function(){return{name:c.name,size:c.size,type:c.type,date:c.lastModified}},o[i]=c}else o[i]=r.target.value};return"file"===d||"radio"===d?t.addEventListener("change",y):(t.addEventListener("input",y),t.addEventListener("change",y),t.addEventListener("value-changed",y)),this.onRemove(function(){"file"===d||"radio"===d?t.removeEventListener("change",y):(t.removeEventListener("input",y),t.removeEventListener("change",y),t.removeEventListener("value-changed",y))}),t.removeAttribute("cv-bind"),t}},{key:"mapOnTag",value:function(e){var t=this;return String(e.getAttribute("cv-on")).split(";").map(function(e){return e.split(":")}).forEach(function(r){var n,o=(r=r.map(function(e){return e.trim()})).length,i=String(r.shift()).trim(),a=String(r.shift()||i).trim(),u=String(r.shift()||"").trim(),s=[],c=/(\w+)(?:\(([$\w\s-'",]+)\))?/.exec(a);c&&(a=c[1].replace(/(^[\s\n]+|[\s\n]+$)/,""),c[2]&&(s=c[2].split(",").map(function(e){return e.trim()}))),s.length||s.push("$event"),i&&1!==o||(i=a);for(var l=t,f=function(){var e=l.controller;return"function"==typeof e[a]?(n=function(){e[a].apply(e,arguments)},"break"):"function"==typeof l[a]?(n=function(){var e;(e=l)[a].apply(e,arguments)},"break"):l.parent?void(l=l.parent):"break"};l&&"break"!==f(););var d=function(r){var o=s.map(function(n){var o;return Number(n)==n?n:"event"===n||"$event"===n?r:"$view"===n?l:"$controller"===n?controller:"$tag"===n?e:"$parent"===n?t.parent:"$subview"===n?t:n in t.args?t.args[n]:(o=/^['"]([\w-]+?)["']$/.exec(n))?o[1]:void 0});if("function"!=typeof n)throw new Error("".concat(a," is not defined on View object.")+"\nTag:\n"+"".concat(e.outerHTML));n.apply(void 0,h(o))},v={};switch(u.includes("p")?v.passive=!0:u.includes("P")&&(v.passive=!1),u.includes("c")?v.capture=!0:u.includes("C")&&(v.capture=!1),u.includes("o")?v.once=!0:u.includes("O")&&(v.once=!1),i){case"_init":d();break;case"_attach":t.nodesAttached.add(d);break;case"_detach":t.nodesDetached.add(d);break;default:e.addEventListener(i,d,v),t.onRemove(function(){e.removeEventListener(i,d,v)})}return[i,a,s]}),e.removeAttribute("cv-on"),e}},{key:"mapLinkTag",value:function(e){var t=e.getAttribute("cv-link");e.setAttribute("href",t);var r=function(r){r.preventDefault(),"http"!==t.substring(0,4)&&"//"!==t.substring(0,2)?o.Router.go(e.getAttribute("href")):window.open(e.getAttribute("href",t))};return e.addEventListener("click",r),this.onRemove(function(e,t){return function(){e.removeEventListener("click",t),e=void 0,t=void 0}}(e,r)),e.removeAttribute("cv-link"),e}},{key:"compileLinkTag",value:function(e){var t=e.getAttribute("cv-link");return e.removeAttribute("cv-link"),function(r){var n=e.cloneNode(!0);return n.setAttribute("href",t),n}}},{key:"mapPrendererTag",value:function(e){var t=e.getAttribute("cv-prerender"),r=window.prerenderer||navigator.userAgent.match(/prerender/i);return r&&(window.prerenderer=window.prerenderer||!0),("never"===t&&r||"only"===t&&!r)&&e.parentNode.removeChild(e),e}},{key:"mapWithTag",value:function(t){var r=this,n=t.getAttribute("cv-with"),o=t.getAttribute("cv-carry"),i=t.getAttribute("cv-view");t.removeAttribute("cv-with"),t.removeAttribute("cv-carry"),t.removeAttribute("cv-view");var a=i?this.stringToClass(i):O,u=new DocumentFragment;h(t.childNodes).forEach(function(e){return u.appendChild(e)});var s=[];o&&(s=o.split(",").map(function(e){return e.trim()}));var c=this.args.bindTo(n,function(n,o,i,c){for(r.withViews.has(t)&&r.withViews.delete(t);t.firstChild;)t.removeChild(t.firstChild);var l=new a({},r);r.onRemove(function(e){return function(){e.remove()}}(l)),l.template=u;var f=function(e){var t=r.args.bindTo(s[e],function(e,t){l.args[t]=e});l.onRemove(t),r.onRemove(function(){t(),l.remove()})};for(var h in s)f(h);var v=function(t){if("object"!==d(n))return"continue";var o=(n=e.Bindable.make(n)).bindTo(t,function(e,t,r,n){n?t in l.args&&delete l.args[t]:l.args[t]=e});l.args.bindTo(t,function(e,t,r,o){o?t in n&&delete n[t]:n[t]=e}),r.onRemove(function(){o(),n.isBound()||e.Bindable.clearBindings(n),l.remove()}),l.onRemove(function(){o(),n.isBound()||e.Bindable.clearBindings(n)})};for(var p in n)v(p);l.render(t),r.withViews.set(t,l)});return this.onRemove(function(){r.withViews.delete(t),c()}),t}},{key:"mapViewTag",value:function(e){var t=this,r=e.getAttribute("cv-view");e.removeAttribute("cv-view");var n=new DocumentFragment;h(e.childNodes).forEach(function(e){return n.appendChild(e)});var o=r.split(":"),i=o.pop()?this.stringToClass(r):O,a=o.shift(),u=new i(this.args,this);return this.views.set(e,u),a&&this.views.set(a,u),this.onRemove(function(r){return function(){r.remove(),t.views.delete(e),t.views.delete(a)}}(u)),u.template=n,u.render(e),e}},{key:"mapEachTag",value:function(t){var r=this,o=t.getAttribute("cv-each"),i=t.getAttribute("cv-view");t.removeAttribute("cv-each"),t.removeAttribute("cv-view");var a=i?this.stringToClass(i):O,u=new DocumentFragment;h(t.childNodes).forEach(function(e){return u.appendChild(e)});var c=v(o.split(":"),3),l=c[0],f=c[1],d=c[2],p=this.args,y=l;if(l.match(/\./)){var b=v(e.Bindable.resolve(this.args,l,!0),2);p=b[0],y=b[1]}var m=p.bindTo(y,function(e,o,i,c,l){e instanceof s.Bag&&(e=e.list),r.viewLists.has(t)&&r.viewLists.get(t).remove();var h=new n.ViewList(u,f,e,r,d,a),v=function(){return h.remove()};r.onRemove(v),h.onRemove(function(){return r._onRemove.remove(v)});var p=r.args.bindTo(function(e,t,r,n){"_id"!==t&&(n?t in h.subArgs&&delete h.subArgs[t]:h.subArgs[t]=e)}),y=h.args.bindTo(function(e,t,n,o,i){"_id"!==t&&"value"!==t&&"___"!==String(t).substring(0,3)&&(o?delete r.args[t]:t in r.args&&(r.args[t]=e))});for(h.onRemove(p),h.onRemove(y),r.onRemove(p),r.onRemove(y);t.firstChild;)t.removeChild(t.firstChild);r.viewLists.set(t,h),h.render(t)});return this.onRemove(m),t}},{key:"mapIfTag",value:function(t){var r=this,n=t,o=n.getAttribute("cv-view"),i=n.getAttribute("cv-if"),u=n.getAttribute("cv-is"),c=!1,l=!1;n.removeAttribute("cv-view"),n.removeAttribute("cv-if"),n.removeAttribute("cv-is");var f=o?this.stringToClass(o):O;"!"===i.substr(0,1)&&(i=i.substr(1),c=!0),"?"===i.substr(0,1)&&(i=i.substr(1),l=!0);var d=new DocumentFragment;h(n.childNodes).forEach(function(e){return d.appendChild(e)});var p=this,y=new DocumentFragment,b=new f(Object.assign({},this.args),p);b.tags.bindTo(function(e,t){return r.tags[t]=e},{removeWith:this}),b.template=d;var m=p.args,g=i;if(i.match(/\./)){var w=v(e.Bindable.resolve(p.args,i,!0),2);m=w[0],g=w[1]}b.render(y);var _=m.bindTo(g,function(e,n){var o=e;l&&(e=null!=e),e instanceof s.Bag&&(e=e.list),Array.isArray(e)&&(e=!!e.length),null!==u&&(e=o==u),c&&(e=!e),e?(t.appendChild(y),h(y.childNodes).forEach(function(e){return a.Dom.mapTags(e,!1,function(e,t){e.matches&&e.dispatchEvent(new CustomEvent("cvDomAttached",{target:e,detail:{view:b||r,mainView:r}}))})})):(b.nodes.forEach(function(e){return y.appendChild(e)}),a.Dom.mapTags(y,!1,function(e,t){e.matches&&new CustomEvent("cvDomDetached",{target:e,detail:{view:b||r,mainView:r}})}))},{children:Array.isArray(m[g])});p.onRemove(_);var E=this.args.bindTo(function(e,t,r,n){"_id"!==t&&(n?t in b.args&&delete b.args[t]:b.args[t]=e)}),j=b.args.bindTo(function(e,t,n,o,i){"_id"!==t&&"___"!==String(t).substring(0,3)&&t in r.args&&(o?delete r.args[t]:r.args[t]=e)});return p.onRemove(function(){_(),E(),j(),p._onRemove.remove(_)}),this.onRemove(function(){E(),j(),b.remove(),p!==r&&p.remove()}),t}},{key:"compileIfTag",value:function(t){var r=t.getAttribute("cv-if"),n=!1;t.removeAttribute("cv-if"),"!"===r.substr(0,1)&&(r=r.substr(1),n=!0);var o=new DocumentFragment;return h(t.childNodes).forEach(function(e){return o.appendChild(e.cloneNode(!0))}),function(i){var a=t.cloneNode(),u=new DocumentFragment,s=new O({},i);s.template=o,i.syncBind(s);var c=i.args,l=r;if(r.match(/\./)){var f=v(e.Bindable.resolve(i.args,r,!0),2);c=f[0],l=f[1]}var d=!1,h=c.bindTo(l,function(e,t){if(!d){var r=i.args[l]||n?a:u;return s.render(r),void(d=!0)}Array.isArray(e)&&(e=!!e.length),n&&(e=!e),e?a.appendChild(u):s.nodes.forEach(function(e){return u.appendChild(e)})});i.onRemove(h);var p=function(){c.isBound()||e.Bindable.clearBindings(c)};return s.onRemove(function(){h(),p(),i._onRemove.remove(h),i._onRemove.remove(p)}),a}}},{key:"mapTemplateTag",value:function(e){var t=e.getAttribute("cv-template");return e.removeAttribute("cv-template"),this.templates[t]=function(){return"TEMPLATE"===e.tagName?e.content.cloneNode(!0):new DocumentFragment(e.innerHTML)},this.rendered.then(function(){return e.remove()}),e}},{key:"mapSlotTag",value:function(e){var t=e.getAttribute("cv-slot"),r=this.templates[t];if(!r){for(var n=this;n&&!(r=n.templates[t]);)n=this.parent;if(!r)return void console.error("Template ".concat(t," not found."))}var o=r();for(e.removeAttribute("cv-slot");e.firstChild;)e.firstChild.remove();return e.appendChild(o),e}},{key:"syncBind",value:function(e){var t=this,r=this.args.bindTo(function(t,r,n,o){"_id"!==r&&e.args[r]!==t&&(e.args[r]=t)}),n=e.args.bindTo(function(e,r,n,o,i){if("_id"!==r){var a=e,u=i;a instanceof O&&(a=a.___ref___),u instanceof O&&(u=u.___ref___),a!==u&&u instanceof O&&i.remove(),r in t.args&&(t.args[r]=e)}});this.onRemove(r),this.onRemove(n),e.onRemove(function(){t._onRemove.remove(r),t._onRemove.remove(n)})}},{key:"postRender",value:function(e){}},{key:"attached",value:function(e){}},{key:"interpolatable",value:function(e){return!!String(e).match(this.interpolateRegex)}},{key:"remove",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.dispatchEvent(new CustomEvent("remove",{detail:{view:this},cancelable:!0}))){var r=function(){for(var t in e.tags)Array.isArray(e.tags[t])?(e.tags[t]&&e.tags[t].forEach(function(e){return e.remove()}),e.tags[t].splice(0)):(e.tags[t]&&e.tags[t].remove(),e.tags[t]=void 0);for(var r in e.nodes)e.nodes[r]&&e.nodes[r].dispatchEvent(new Event("cvDomDetached")),e.nodes[r]&&e.nodes[r].remove(),e.nodes[r]=void 0;e.nodes.splice(0),e.firstNode=e.lastNode=void 0};t?r():requestAnimationFrame(r);var n,o=p(this._onRemove.items());try{for(o.s();!(n=o.n()).done;){var i=n.value;i(),this._onRemove.remove(i)}}catch(e){o.e(e)}finally{o.f()}var a,u=p(this.cleanup);try{for(u.s();!(a=u.n()).done;){var s=a.value;s&&s()}}catch(e){u.e(e)}finally{u.f()}this.cleanup.length=0;var c,l=p(this.viewLists);try{for(l.s();!(c=l.n()).done;){var f=v(c.value,2);(f[0],f[1]).remove()}}catch(e){l.e(e)}finally{l.f()}this.viewLists.clear();var d,h=p(this.timeouts);try{for(h.s();!(d=h.n()).done;){var y=v(d.value,2),b=(y[0],y[1]);clearTimeout(b.timeout),this.timeouts.delete(b.timeout)}}catch(e){h.e(e)}finally{h.f()}var m,g=p(this.intervals);try{for(g.s();!(m=g.n()).done;){var w=m.value;clearInterval(w)}}catch(e){g.e(e)}finally{g.f()}this.intervals.length=0;var _,O=p(this.frames);try{for(O.s();!(_=O.n()).done;){(0,_.value)()}}catch(e){O.e(e)}finally{O.f()}this.frames.length=0,this.preRuleSet.purge(),this.ruleSet.purge(),this.removed=!0,this.dispatchEvent(new CustomEvent("removed",{detail:{view:this},cancelable:!0}))}}},{key:"findTag",value:function(e){for(var t in this.nodes){var r;if(this.nodes[t].querySelector){if(this.nodes[t].matches(e))return new u.Tag(this.nodes[t],this,void 0,void 0,this);if(r=this.nodes[t].querySelector(e))return new u.Tag(r,this,void 0,void 0,this)}}}},{key:"findTags",value:function(e){var t=this;return this.nodes.filter(function(e){return e.querySelectorAll}).map(function(t){return h(t.querySelectorAll(e))}).flat().map(function(e){return new u.Tag(e,t,void 0,void 0,t)})||[]}},{key:"onRemove",value:function(e){e instanceof Event||this._onRemove.add(e)}},{key:"update",value:function(){}},{key:"beforeUpdate",value:function(e){}},{key:"afterUpdate",value:function(e){}},{key:"stringTransformer",value:function(e){var t=this;return function(r){for(var n in e){for(var o=t,i=e[n];o&&!o[i];)o=o.parent;if(!o)return;r=o[e[n]](r)}return r}}},{key:"stringToClass",value:function(e){if(O.refClasses.has(e))return O.refClasses.get(e);var t=e.split("/"),n=t[t.length-1],o=r(e);return O.refClasses.set(e,o[n]),o[n]}},{key:"preventParsing",value:function(e){e[E]=!0}},{key:"toString",value:function(){return this.nodes.map(function(e){return e.outerHTML}).join(" ")}},{key:"listen",value:function(e,t,r,n){var o=this;if("string"==typeof e&&(n=r,r=t,t=e,e=this),e instanceof O)return this.listen(e.nodes,t,r,n);if(Array.isArray(e))return e.map(function(e){return o.listen(e,t,r,n)}).forEach(function(e){return e()});if(e instanceof u.Tag)return this.listen(e.element,t,r,n);e.addEventListener(t,r,n);var i=function(){return e.removeEventListener(t,r,n)},a=function(){i(),i=function(){}};return this.onRemove(function(){return a()}),a}},{key:"detach",value:function(){for(var e in this.nodes)this.nodes[e].remove();return this.nodes}}],y=[{key:"from",value:function(e){var t=new this(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},arguments.length>2&&void 0!==arguments[2]?arguments[2]:null);return t.template=e,t}},{key:"isView",value:function(){return O}},{key:"uuid",value:function(){return new i.Uuid}}],f&&m(l.prototype,f),y&&m(l,y),Object.defineProperty(l,"prototype",{writable:!1}),O}(l.Mixin.with(f.EventTargetMixin));t.View=T,Object.defineProperty(T,"templates",{value:new Map}),Object.defineProperty(T,"refClasses",{value:new Map})}()}),require.register("curvature/base/ViewList.js",function(t,r,n){r=e(r,{},"curvature"),function(){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ViewList=void 0;var e=r("./Bindable"),n=r("./SetMap"),o=r("./Bag");function i(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return u=e.done,e},e:function(e){s=!0,i=e},f:function(){try{u||null==r.return||r.return()}finally{if(s)throw i}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var c=function(){function t(r,n,i,a){var s=this,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,t),this.removed=!1,this.args=e.Bindable.makeBindable({}),this.args.value=e.Bindable.makeBindable(i||{}),this.subArgs=e.Bindable.makeBindable({}),this.views=[],this.cleanup=[],this.viewClass=l,this._onRemove=new o.Bag,this.template=r,this.subProperty=n,this.keyProperty=c,this.tag=null,this.downDebind=[],this.upDebind=[],this.paused=!1,this.parent=a,this.rendered=new Promise(function(e,t){Object.defineProperty(s,"renderComplete",{configurable:!1,writable:!0,value:e})}),this.willReRender=!1,this.args.___before(function(e,t,r,n,o){"bindTo"!=t&&(s.paused=!0)}),this.args.___after(function(e,t,r,n,o){"bindTo"!=t&&(s.paused=r.length>1,s.reRender())});var f=this.args.value.bindTo(function(e,t,r,n){if(!s.paused){var o=t;if("symbol"!==u(t))if(isNaN(t)&&(o="_"+t),n)for(var i in s.views[o]&&s.views[o].remove(),delete s.views[o],s.views)isNaN(i)?s.views[i].args[s.keyProperty]=i.substr(1):s.views[i].args[s.keyProperty]=i;else s.views[o]?s.views[o]&&s.views[o].args&&(s.views[o].args[s.keyProperty]=t,s.views[o].args[s.subProperty]=e):(cancelAnimationFrame(s.willReRender),s.willReRender=requestAnimationFrame(function(){s.reRender()}))}});this._onRemove.add(f),Object.preventExtensions(this)}var r,a;return r=t,(a=[{key:"render",value:function(e){var t,r=this,n=[],o=i(this.views);try{var a=function(){var r=t.value;r.render(e),n.push(r.rendered.then(function(){return r}))};for(o.s();!(t=o.n()).done;)a()}catch(e){o.e(e)}finally{o.f()}this.tag=e,Promise.all(n).then(function(e){return r.renderComplete(e)}),this.parent.dispatchEvent(new CustomEvent("listRendered",{detail:{detail:{key:this.subProperty,value:this.args.value}}}))}},{key:"reRender",value:function(){var e=this;if(!this.paused&&this.tag){var t=[],r=new n.SetMap;for(var o in this.views){var a=this.views[o],u=a.args[this.subProperty];r.add(u,a),t[o]=a}var s=[],c=new Set;this.downDebind.length&&this.downDebind.forEach(function(e){return e&&e()}),this.upDebind.length&&this.upDebind.forEach(function(e){return e&&e()}),this.upDebind.length=0,this.downDebind.length=0;var l=1/0,f=1/0,d=function(t){var n=!1,o=t;if(isNaN(o)?o="_"+t:String(o).length&&(o=Number(o)),void 0!==e.args.value[t]&&r.has(e.args.value[t])){var i=r.getOne(e.args.value[t]);i&&(i.args[e.keyProperty]=t,s[o]=i,c.add(i),n=!0,isNaN(o)||(l=Math.min(l,o),o>0&&(f=Math.min(f,o))),r.remove(e.args.value[t],i))}if(!n){var a={},u=s[o]=new e.viewClass(a,e.parent);isNaN(o)||(l=Math.min(l,o),o>0&&(f=Math.min(f,o))),s[o].template=e.template,s[o].viewList=e,s[o].args[e.keyProperty]=t,s[o].args[e.subProperty]=e.args.value[t],e.upDebind[o]=a.bindTo(e.subProperty,function(t,r,n,o){var i=a[e.keyProperty];o?delete e.args.value[i]:e.args.value[i]=t}),e.downDebind[o]=e.subArgs.bindTo(function(e,t,r,n){n?delete a[t]:a[t]=e});var d=function(){e.upDebind.filter(function(e){return e}).forEach(function(e){return e()}),e.upDebind.length=0},h=function(){e.downDebind.filter(function(e){return e}).forEach(function(e){return e()}),e.downDebind.length=0};u.onRemove(function(){e._onRemove.remove(d),e._onRemove.remove(h),e.upDebind[o]&&e.upDebind[o](),e.downDebind[o]&&e.downDebind[o](),delete e.upDebind[o],delete e.downDebind[o]}),e._onRemove.add(d),e._onRemove.add(h),a[e.subProperty]=e.args.value[t]}};for(var h in this.args.value)d(h);for(var v in t)c.has(t[v])||t[v].remove();if(Array.isArray(this.args.value)){var p=0===l&&void 0!==s[1]&&s.length>1||f===1/0?l:f;this.rendered=function t(){for(var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=s.length-r-1;n>p&&void 0===s[n];)n--;if(n<p)return Promise.resolve();if(s[n]===e.views[n]){if(s[n]&&!s[n].firstNode)return s[n].render(e.tag,s[n+1]),s[n].rendered.then(function(){return t(Number(r)+1)});return 0===r||r%500?t(Number(r)+1):new Promise(function(e){return requestAnimationFrame(function(){return e(t(Number(r)+1))})})}return s[n].render(e.tag,s[n+1]),e.views.splice(n,0,s[n]),s[n].rendered.then(function(){return t(r+1)})}()}else{var y,b=[],m=Object.assign({},s),g=function(e){return parseInt(e)===e-0},w=i(Object.keys(s).sort(function(e,t){return g(e)&&g(t)?Math.sign(e-t):g(e)||g(t)?!g(e)&&g(t)?-1:g(e)&&!g(t)?1:void 0:0}));try{var _=function(){var t=y.value;if(delete m[t],s[t].firstNode&&s[t]===e.views[t])return"continue";s[t].render(e.tag),b.push(s[t].rendered.then(function(){return s[t]}))};for(w.s();!(y=w.n()).done;)_()}catch(e){w.e(e)}finally{w.f()}for(var O in m)delete this.args.views[O],m.remove();this.rendered=Promise.all(b)}for(var E in s)isNaN(E)?s[E].args[this.keyProperty]=E.substr(1):s[E].args[this.keyProperty]=E;this.views=Array.isArray(this.args.value)?[].concat(s):s,c.clear(),this.willReRender=!1,this.rendered.then(function(){e.parent.dispatchEvent(new CustomEvent("listRendered",{detail:{detail:{key:e.subProperty,value:e.args.value,tag:e.tag}}})),e.tag.dispatchEvent(new CustomEvent("listRendered",{detail:{detail:{key:e.subProperty,value:e.args.value,tag:e.tag}}}))})}}},{key:"pause",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];for(var t in this.views)this.views[t].pause(e)}},{key:"onRemove",value:function(e){this._onRemove.add(e)}},{key:"remove",value:function(){for(var t in this.views)this.views[t].remove();var r=this._onRemove.items();for(var n in r)this._onRemove.remove(r[n]),r[n]();for(;this.cleanup.length;)this.cleanup.pop()();for(this.views=[];this.tag&&this.tag.firstChild;)this.tag.removeChild(this.tag.firstChild);this.subArgs&&e.Bindable.clearBindings(this.subArgs),e.Bindable.clearBindings(this.args),this.args.value&&!this.args.value.isBound()&&e.Bindable.clearBindings(this.args.value),this.removed=!0}}])&&s(r.prototype,a),Object.defineProperty(r,"prototype",{writable:!1}),t}();t.ViewList=c}()}),require.register("curvature/input/Keyboard.js",function(t,r,n){r=e(r,{},"curvature"),function(){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Keyboard=void 0;var e=r("../base/Bindable");function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function t(){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.maxDecay=120,this.comboTime=500,this.listening=!1,this.focusElement=document.body,this[e.Bindable.NoGetters]=!0,Object.defineProperty(this,"combo",{value:e.Bindable.make([])}),Object.defineProperty(this,"whichs",{value:e.Bindable.make({})}),Object.defineProperty(this,"codes",{value:e.Bindable.make({})}),Object.defineProperty(this,"keys",{value:e.Bindable.make({})}),Object.defineProperty(this,"pressedWhich",{value:e.Bindable.make({})}),Object.defineProperty(this,"pressedCode",{value:e.Bindable.make({})}),Object.defineProperty(this,"pressedKey",{value:e.Bindable.make({})}),Object.defineProperty(this,"releasedWhich",{value:e.Bindable.make({})}),Object.defineProperty(this,"releasedCode",{value:e.Bindable.make({})}),Object.defineProperty(this,"releasedKey",{value:e.Bindable.make({})}),Object.defineProperty(this,"keyRefs",{value:e.Bindable.make({})}),document.addEventListener("keyup",function(e){r.listening&&(r.keys[e.key]>0||!r.focusElement||document.activeElement===r.focusElement||r.focusElement.contains(document.activeElement)&&!document.activeElement.matches("input,textarea"))&&(e.preventDefault(),r.releasedWhich[e.which]=Date.now(),r.releasedCode[e.code]=Date.now(),r.releasedKey[e.key]=Date.now(),r.whichs[e.which]=-1,r.codes[e.code]=-1,r.keys[e.key]=-1)}),document.addEventListener("keydown",function(e){r.listening&&(!r.focusElement||document.activeElement===r.focusElement||r.focusElement.contains(document.activeElement)&&!document.activeElement.matches("input,textarea"))&&(e.preventDefault(),e.repeat||(r.combo.push(e.code),clearTimeout(r.comboTimer),r.comboTimer=setTimeout(function(){return r.combo.splice(0)},r.comboTime),r.pressedWhich[e.which]=Date.now(),r.pressedCode[e.code]=Date.now(),r.pressedKey[e.key]=Date.now(),r.keys[e.key]>0||(r.whichs[e.which]=1,r.codes[e.code]=1,r.keys[e.key]=1)))});var n=function(e){for(var t in r.keys)r.keys[t]<0||(r.releasedKey[t]=Date.now(),r.keys[t]=-1);for(var n in r.codes)r.codes[n]<0||(r.releasedCode[n]=Date.now(),r.codes[n]=-1);for(var o in r.whichs)r.whichs[o]<0||(r.releasedWhich[o]=Date.now(),r.whichs[o]=-1)};window.addEventListener("blur",n),window.addEventListener("visibilitychange",function(){"visible"!==document.visibilityState&&n()})}var r,o,i;return r=t,i=[{key:"get",value:function(){return this.instance=this.instance||e.Bindable.make(new this)}}],(o=[{key:"getKeyRef",value:function(t){return this.keyRefs[t]=this.keyRefs[t]||e.Bindable.make({})}},{key:"getKeyTime",value:function(e){var t=this.releasedKey[e],r=this.pressedKey[e];return r?!t||t<r?Date.now()-r:-1*(Date.now()-t):0}},{key:"getCodeTime",value:function(e){var t=this.releasedCode[e],r=this.pressedCode[e];return r?!t||t<r?Date.now()-r:-1*(Date.now()-t):0}},{key:"getWhichTime",value:function(e){var t=this.releasedWhich[e],r=this.pressedWhich[e];return r?!t||t<r?Date.now()-r:-1*(Date.now()-t):0}},{key:"getKey",value:function(e){return this.keys[e]?this.keys[e]:0}},{key:"getKeyCode",value:function(e){return this.codes[e]?this.codes[e]:0}},{key:"reset",value:function(){for(var e in this.keys)delete this.keys[e];for(var e in this.codes)delete this.codes[e];for(var e in this.whichs)delete this.whichs[e]}},{key:"update",value:function(){for(var e in this.keys)this.keys[e]>0?this.keys[e]++:this.keys[e]>-this.maxDecay?this.keys[e]--:delete this.keys[e];for(var e in this.codes){var t=this.releasedCode[e],r=this.pressedCode[e],n=this.getKeyRef(e);if(this.codes[e]>0){if(n.frames=this.codes[e]++,n.time=r?Date.now()-r:0,n.down=!0,!t||t<r)return;return-1*(Date.now()-t)}this.codes[e]>-this.maxDecay?(n.frames=this.codes[e]--,n.time=t-Date.now(),n.down=!1):(n.frames=0,n.time=0,n.down=!1,delete this.codes[e])}for(var e in this.whichs)this.whichs[e]>0?this.whichs[e]++:this.whichs[e]>-this.maxDecay?this.whichs[e]--:delete this.whichs[e]}}])&&n(r.prototype,o),i&&n(r,i),Object.defineProperty(r,"prototype",{writable:!1}),t}();t.Keyboard=o}()}),require.register("curvature/mixin/EventTargetMixin.js",function(t,r,n){r=e(r,{},"curvature"),function(){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventTargetMixin=void 0;var e,n=r("../base/Mixin");function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var i=Symbol("Target"),a=(o(e={},n.Mixin.Constructor,function(){try{this[i]=new EventTarget}catch(e){this[i]=document.createDocumentFragment()}}),o(e,"dispatchEvent",function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var o=r[0];"string"==typeof o&&(o=new CustomEvent(o),r[0]=o),(e=this[i]).dispatchEvent.apply(e,r);var a="on".concat(o.type[0].toUpperCase()+o.type.slice(1));return"function"==typeof this[a]&&this[a](o),o.returnValue}),o(e,"addEventListener",function(){var e;(e=this[i]).addEventListener.apply(e,arguments)}),o(e,"removeEventListener",function(){var e;(e=this[i]).removeEventListener.apply(e,arguments)}),e);t.EventTargetMixin=a}()}),require.register("curvature/mixin/PromiseMixin.js",function(t,r,n){r=e(r,{},"curvature"),function(){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PromiseMixin=void 0;var e,n=r("../base/Mixin");function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var i=Symbol("Promise"),a=Symbol("Accept"),u=Symbol("Reject"),s=(o(e={},n.Mixin.Constructor,function(){var e=this;this[i]=new Promise(function(t,r){e[a]=t,e[u]=r})}),o(e,"then",function(){var e;return(e=this[i]).then.apply(e,arguments)}),o(e,"catch",function(){var e;return(e=this[i]).catch.apply(e,arguments)}),o(e,"finally",function(){var e;return(e=this[i]).finally.apply(e,arguments)}),e);t.PromiseMixin=s,Object.defineProperty(s,"Reject",{value:u}),Object.defineProperty(s,"Accept",{value:a})}()}),require.register("Config.js",function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(e,"__esModule",{value:!0}),e.Config=void 0;var o=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)});e.Config=o,o.title="wgl2d"}),require.register("gl2d/Gl2d.js",function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Gl2d=void 0,t("curvature/base/Bindable");var o=t("../inject/Injectable");function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=l(e);if(t){var o=l(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return s(this,r)}}function s(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return c(e)}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}(l,o.Injectable);var r,n,s=u(l);function l(e){var t;return function(e,t){if(!(e instanceof l))throw new TypeError("Cannot call a class as a function")}(this),t=s.call(this),new(o.Injectable.inject({Gl2d:c(t)})),t.element=e,t.context=t.element.getContext("webgl"),t.zoomLevel=1,t}return r=l,(n=[{key:"resize",value:function(e,t){e=(e||this.element.width)/this.zoomLevel,t=(t||this.element.height)/this.zoomLevel,this.context.viewport(0,0,e,t)}},{key:"draw",value:function(){var e=this.context;e.useProgram(this.program),e.bindFramebuffer(e.FRAMEBUFFER,null),e.viewport(0,0,e.canvas.width,e.canvas.height),e.clearColor(0,0,0,0),e.clearColor(1,1,1,1),e.clear(e.COLOR_BUFFER_BIT)}},{key:"cleanup",value:function(){this.context.deleteProgram(this.program)}},{key:"createShader",value:function(e){var r=null;switch(e.substring(e.lastIndexOf(".")+1).toUpperCase()){case"VERT":r=this.context.VERTEX_SHADER;break;case"FRAG":r=this.context.FRAGMENT_SHADER}var n=this.context.createShader(r),o=t(e);if(this.context.shaderSource(n,o),this.context.compileShader(n),this.context.getShaderParameter(n,this.context.COMPILE_STATUS))return n;console.error(this.context.getShaderInfoLog(n)),this.context.deleteShader(n)}},{key:"createProgram",value:function(e,t){var r=this.context.createProgram();return this.context.attachShader(r,e),this.context.attachShader(r,t),this.context.linkProgram(r),this.context.detachShader(r,e),this.context.detachShader(r,t),this.context.deleteShader(e),this.context.deleteShader(t),this.context.getProgramParameter(r,this.context.LINK_STATUS)||(console.error(this.context.getProgramInfoLog(r)),this.context.deleteProgram(r)),r}}])&&i(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),l}();e.Gl2d=f}),require.register("home/View.js",function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.View=void 0;var o=t("Config"),i=t("curvature/base/Bag"),a=t("curvature/base/View"),u=t("../world/Map"),s=t("../sprite/SpriteSheet"),c=t("../sprite/SpriteBoard"),l=t("../ui/Controller"),f=t("../ui/MapEditor"),d=t("curvature/input/Keyboard"),h=t("../model/Entity"),v=t("../inject/Injectable");function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=g(e);if(t){var o=g(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return m(this,r)}}function m(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var w=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}(m,e);var r,n,a=b(m);function m(e){var r;!function(e,t){if(!(e instanceof m))throw new TypeError("Cannot call a class as a function")}(this),(r=a.call(this,e)).template=t("./view.tmp"),r.routes=[],r.entities=new i.Bag,r.keyboard=d.Keyboard.get(),r.speed=8,r.maxSpeed=r.speed;var n=new(v.Injectable.inject({OnScreenJoyPad:l.Controller}));return r.args.controller=n.OnScreenJoyPad,r.args.fps=0,r.args.sps=0,r.args.camX=0,r.args.camY=0,r.args.frameLock=60,r.args.simulationLock=60,r.args.showEditor=!1,r.keyboard.listening=!0,r.keyboard.keys.bindTo("`",function(e,t,r,n){-1===e&&console.log(t)}),r.keyboard.keys.bindTo("e",function(e,t,n,o){e>0&&r.map.export()}),r.keyboard.keys.bindTo("Escape",function(e,t,n,o){-1===e&&r.spriteBoard.unselect()}),r.keyboard.keys.bindTo("Home",function(e,t,n,o){e>0&&r.args.frameLock++}),r.keyboard.keys.bindTo("End",function(e,t,n,o){e>0&&(r.args.frameLock--,r.args.frameLock<0&&(r.args.frameLock=0))}),r.keyboard.keys.bindTo("PageUp",function(e,t,n,o){e>0&&r.args.simulationLock++}),r.keyboard.keys.bindTo("PageDown",function(e,t,n,o){e>0&&(r.args.simulationLock--,r.args.simulationLock<0&&(r.args.simulationLock=0))}),r.spriteSheet=new s.SpriteSheet,r.map=new u.Map,r.map.import(),r.args.mapEditor=new f.MapEditor({spriteSheet:r.spriteSheet,map:r.map}),r}return r=m,(n=[{key:"onRendered",value:function(){var e=this;this.spriteBoard=new c.SpriteBoard(this.tags.canvas.element,this.map);var t=new h.Entity;this.entities.add(t),this.spriteBoard.sprites.add(t.sprite),this.keyboard.keys.bindTo("=",function(t,r,n,o){t>0&&e.zoom(1)}),this.keyboard.keys.bindTo("+",function(t,r,n,o){t>0&&e.zoom(1)}),this.keyboard.keys.bindTo("-",function(t,r,n,o){t>0&&e.zoom(-1)}),this.args.mapEditor.args.bindTo("selectedGraphic",function(t){if(t&&null!=e.spriteBoard.selected.globalX){e.args.showEditor=!1;var r=e.spriteBoard.selected.startGlobalX,n=e.spriteBoard.selected.globalX;if(n<r){var o=[r,n];n=o[0],r=o[1]}for(;r<=n;r++){var i=e.spriteBoard.selected.startGlobalY,a=e.spriteBoard.selected.globalY;if(a<i){var u=[i,a];a=u[0],i=u[1]}for(;i<=a;i++)e.map.setTile(r,i,t)}e.map.setTile(e.spriteBoard.selected.globalX,e.spriteBoard.selected.globalY,t),e.spriteBoard.resize(),e.spriteBoard.unselect()}}),this.spriteBoard.selected.bindTo(function(t,r,n,o,i){null!=e.spriteBoard.selected.localX?(e.args.mapEditor.select(e.spriteBoard.selected),e.args.showEditor=!0,e.spriteBoard.resize()):e.args.showEditor=!1},{wait:0}),this.args.showEditor=!0,window.addEventListener("resize",function(){e.resize(),u()});var r=0,n=0,i=[],a=[],u=function t(n){var o=(n/=1e3)-r;if(o<1/(e.args.frameLock+e.args.frameLock/60*10))window.requestAnimationFrame(t);else{if(r=n,0==e.args.frameLock)return window.requestAnimationFrame(t),void(i=[0]);for(e.spriteBoard.draw(),window.requestAnimationFrame(t),i.push(e.args._fps);i.length>5;)i.shift();e.args._fps=1/o,e.args.camX=e.spriteBoard.Camera.x,e.args.camY=e.spriteBoard.Camera.y}};this.resize(),setInterval(function(){!function(t){var r=(t/=1e3)-n;if(0!=e.args.simulationLock){if(!(r<1/(e.args.simulationLock+e.args.simulationLock/60*10)))for(n=t,e.keyboard.update(),Object.values(e.entities.items()).map(function(e){e.simulate()}),e.args._sps=1/r,a.push(e.args._sps);a.length>5;)a.shift()}else a=[0]}(performance.now())},0),setInterval(function(){var t=i.reduce(function(e,t){return e+t},0)/i.length;e.args.fps=t.toFixed(3).padStart(5," ")},227),setInterval(function(){document.title="".concat(o.Config.title," ").concat(e.args.fps," FPS")},227/3),setInterval(function(){var t=a.reduce(function(e,t){return e+t},0)/a.length;e.args.sps=t.toFixed(3).padStart(5," ")},115.5),window.requestAnimationFrame(u)}},{key:"resize",value:function(e,t){this.args.width=this.tags.canvas.element.width=e||document.body.clientWidth,this.args.height=this.tags.canvas.element.height=t||document.body.clientHeight,this.args.rwidth=Math.floor((e||document.body.clientWidth)/this.spriteBoard.zoomLevel),this.args.rheight=Math.floor((t||document.body.clientHeight)/this.spriteBoard.zoomLevel),this.spriteBoard.resize()}},{key:"scroll",value:function(e){var t=e.deltaY>0?-1:e.deltaY<0?1:0;this.zoom(t)}},{key:"zoom",value:function(e){e>0||e<0&&this.spriteBoard.zoomLevel>.35?(this.spriteBoard.zoomLevel+=.05*e,this.resize()):(this.spriteBoard.zoomLevel=.35,this.resize())}}])&&p(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),m}(a.View);e.View=w}),require.register("home/view.tmp.html",function(e,t,r){r.exports='<canvas\n\tcv-ref = "canvas:curvature/base/Tag"\n\tcv-on  = "wheel:scroll(event);"\n></canvas>\n<div class = "hud fps">\n [[sps]] simulations/s / [[simulationLock]] \n [[fps]] frames/s      / [[frameLock]] \n\n Res [[rwidth]] x [[rheight]]\n     [[width]] x [[height]]\n \n Pos [[camX]] x [[camY]]\n\n  Sim:   Pg Up / Dn\n  Frame: Home / End \n  Scale: + / - \n\n</div>\n<div class = "reticle"></div>\n\n[[controller]]\n\n<div cv-if = "showEditor">\n\t[[mapEditor]]\n\t--\n\t[[mmm]]\n</span>\n'}),require.register("initialize.js",function(e,t,r){"use strict";var n=t("curvature/base/Tag"),o=t("curvature/base/Router"),i=t("home/View");t("inject/Single"),void 0!==Proxy&&document.addEventListener("DOMContentLoaded",function(){var e=new i.View,r=new n.Tag(document.querySelector("body"));r.clear(),e.render(r.element),o.Router.listen(e),t("initialize")})}),require.register("inject/Container.js",function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=s(e);if(t){var o=s(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return u(this,r)}}function u(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Container=void 0;var c=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}(u,e);var t,r,n=a(u);function u(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),n.apply(this,arguments)}return t=u,(r=[{key:"inject",value:function(e){return new this.constructor(Object.assign({},this,e))}}])&&o(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),u}(t("./Injectable").Injectable);e.Container=c}),require.register("inject/Injectable.js",function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=s(e);if(t){var o=s(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return u(this,r)}}function u(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t,r){return t&&l(e.prototype,t),r&&l(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}Object.defineProperty(e,"__esModule",{value:!0}),e.Injectable=void 0;var d={},h={},v=function(){function e(){c(this,e);var t=this.constructor.injections(),r=this.constructor.context();for(var n in d[r]||(d[r]={}),h[r]||(h[r]={}),t){var o=t[n];!d[r][n]&&o.prototype&&/[A-Z]/.test(String(n)[0])&&(d[r][n]=o)}for(var i in t){var a=void 0,u=d[r][i]||t[i];/[A-Z]/.test(String(i)[0])?(u.prototype?h[r][i]||(h[r][i]=new u):h[r][i]=u,a=h[r][i]):a=u.prototype?new u:u,Object.defineProperty(this,i,{enumerable:!1,writable:!1,value:a})}}return f(e,null,[{key:"injections",value:function(){return{}}},{key:"context",value:function(){return"."}},{key:"inject",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:".";if(!(this.prototype instanceof e||this===e))throw new Error("Cannot access injectable subclass!\n\nAre you trying to instantiate like this?\n\n\tnew X.inject({...});\n\nIf so please try:\n\n\tnew (X.inject({...}));\n\nPlease note the parenthesis.\n");var n=this.injections();return function(e){o(u,e);var i=a(u);function u(){return c(this,u),i.apply(this,arguments)}return f(u,null,[{key:"injections",value:function(){return Object.assign({},n,t)}},{key:"context",value:function(){return r}}]),u}(this)}}]),e}();e.Injectable=v}),require.register("inject/Single.js",function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(e,"__esModule",{value:!0}),e.single=e.Single=void 0;var o=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name="sss."+Math.random()});e.Single=o;var i=new o;e.single=i}),require.register("model/Controller.js",function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Controller=void 0;var o=t("curvature/base/Bindable"),i=t("../inject/Injectable"),a=t("curvature/input/Keyboard"),u=t("../ui/Controller");function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(o,e);var t,r,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=f(e);if(t){var o=f(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return l(this,r)}}(o);function o(){var e;return function(e,t){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}(this),e=n.call(this),a.Keyboard.get().keys.bindTo(function(t,r,n,o){t>0?e.keyPress(r,t,n[r]):-1!==t||e.keyRelease(r,t,n[r])}),e.OnScreenJoyPad.args.bindTo("x",function(t){e.axis[0]=t/50}),e.OnScreenJoyPad.args.bindTo("y",function(t){e.axis[1]=t/50}),e}return t=o,(r=[{key:"keyPress",value:function(e,t,r){if(/^[0-9]$/.test(e))this.triggers[e]=!0;else switch(e){case"ArrowRight":this.axis[0]=1;break;case"ArrowDown":this.axis[1]=1;break;case"ArrowLeft":this.axis[0]=-1;break;case"ArrowUp":this.axis[1]=-1}}},{key:"keyRelease",value:function(e,t,r){if(/^[0-9]$/.test(e))this.triggers[e]=!1;else switch(e){case"ArrowRight":this.axis[0]>0&&(this.axis[0]=0),this.axis[0]=0;case"ArrowLeft":this.axis[0]<0&&(this.axis[0]=0);break;case"ArrowDown":this.axis[1]>0&&(this.axis[1]=0);case"ArrowUp":this.axis[1]<0&&(this.axis[1]=0)}}}])&&s(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(i.Injectable.inject({Keyboard:a.Keyboard,OnScreenJoyPad:u.Controller,triggers:o.Bindable.makeBindable({}),axis:o.Bindable.makeBindable({})}));e.Controller=d}),require.register("model/Entity.js",function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Entity=void 0;var o=t("../inject/Injectable"),i=t("../sprite/Sprite"),a=t("./Controller"),u=t("../sprite/Camera");function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(o,e);var t,r,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=f(e);if(t){var o=f(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return l(this,r)}}(o);function o(){var e;return function(e,t){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}(this),(e=n.call(this)).direction="south",e.state="standing",e}return t=o,(r=[{key:"create",value:function(){}},{key:"simulate",value:function(){var e=this.Controller.axis[0]||0,t=this.Controller.axis[1]||0;for(var r in this.Controller.triggers)this.Controller.triggers[r]&&console.log(r);e>1&&(e=1),t>1&&(t=1),this.sprite.x+=e>0?Math.ceil(4*e):Math.floor(4*e),this.sprite.y+=t>0?Math.ceil(4*t):Math.floor(4*t),this.Camera.x=this.sprite.x,this.Camera.y=this.sprite.y;var n,o=!1;Math.abs(e)>Math.abs(t)&&(o=!0),o?(this.direction="west",e>0&&(this.direction="east"),this.state="walking"):t?(this.direction="north",t>0&&(this.direction="south"),this.state="walking"):this.state="standing",(n=this.sprite[this.state][this.direction])&&this.sprite.setFrames(n)}},{key:"destroy",value:function(){}}])&&s(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(o.Injectable.inject({sprite:i.Sprite,Controller:a.Controller,Camera:u.Camera}));e.Entity=d}),require.register("overlay/overlay.frag",function(e,t,r){r.exports="precision mediump float;\n\nuniform vec4      u_color;\nvarying vec2      v_texCoord;\n\nvoid main() {\n   // gl_FragColor = texture2D(u_image, v_texCoord);\n   gl_FragColor = vec4(1.0, 1.0, 0.0, 0.25);\n}\n"}),require.register("overlay/overlay.vert",function(e,t,r){r.exports="attribute vec2 a_position;\nattribute vec2 a_texCoord;\n\nuniform   vec2 u_resolution;\n\nvarying   vec2 v_texCoord;\n\nvoid main()\n{\n   vec2 zeroToOne = a_position / u_resolution;\n   vec2 zeroToTwo = zeroToOne * 2.0;\n   vec2 clipSpace = zeroToTwo - 1.0;\n\n   gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);\n   v_texCoord  = a_texCoord;\n}\n"}),require.register("sprite/Background.js",function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Background=void 0;var o=t("curvature/base/Bindable"),i=t("../gl2d/Gl2d"),a=t("../inject/Injectable"),u=t("./Surface"),s=t("./Camera"),c=t("./SpriteSheet");function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return h(e)}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(i,e);var t,r,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=v(e);if(t){var o=v(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return d(this,r)}}(i);function i(e,t){var r,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),r=n.call(this),o.Bindable.makeBindable(h(r)),r.panes=[],r.panesXY={},r.maxPanes=9,r.surfaceX=5,r.surfaceY=5,r.spriteSheet=new c.SpriteSheet,r.tileWidth=32,r.tileHeight=32,r.map=t,r.layer=a,r}return t=i,(r=[{key:"renderPane",value:function(e,t,r){var n,o=this.Gl2d,i=e*(this.tileWidth*this.surfaceX),a=t*(this.tileHeight*this.surfaceY);this.panesXY[i]&&this.panesXY[i][a]?n=this.panesXY[i][a]:(n=new u.Surface(o,this.map,this.surfaceX,this.surfaceY,i,a,this.layer),this.panesXY[i]||(this.panesXY[i]={}),this.panesXY[i][a]||(this.panesXY[i][a]=n)),this.panes.unshift(n),this.panes.length>this.maxPanes&&this.panes.pop()}},{key:"draw",value:function(){var e=Math.floor(this.Camera.x/(this.surfaceX*this.tileWidth)),t=Math.floor(this.Camera.y/(this.surfaceY*this.tileHeight)),r=[-1,0,1];for(var n in r)for(var o in r)this.renderPane(e+r[n],t+r[o]);this.panes.map(function(e){e.draw()})}},{key:"resize",value:function(e,t){for(var r in this.panesXY)for(var n in this.panesXY[r])delete this.panesXY[r][n];for(;this.panes.length;)this.panes.pop();this.surfaceX=Math.ceil(e/this.tileWidth),this.surfaceY=Math.ceil(t/this.tileHeight),this.draw()}},{key:"simulate",value:function(){}}])&&l(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(a.Injectable.inject({Gl2d:i.Gl2d,Camera:s.Camera}));e.Background=p}),require.register("sprite/Camera.js",function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(e,"__esModule",{value:!0}),e.Camera=void 0;var o=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.x=0,this.y=0,this.width=0,this.height=0});e.Camera=o}),require.register("sprite/Sprite.js",function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Sprite=void 0,t("curvature/base/Bindable"),t("curvature/input/Keyboard");var o=t("./SpriteSheet"),i=t("../gl2d/Gl2d"),a=t("../inject/Injectable"),u=t("./Camera");function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(i,e);var t,r,n,o=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=f(e);if(t){var o=f(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return l(this,r)}}(i);function i(e){var t;!function(e,t){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(t=o.call(this)).z=0,t.x=0,t.y=0,t.width=0,t.height=0,t.scale=1,t.frames=[],t.frameDelay=4,t.currentDelay=t.frameDelay,t.currentFrame=0,t.currentFrames="",t.speed=0,t.maxSpeed=8,t.moving=!1,t.RIGHT=0,t.DOWN=1,t.LEFT=2,t.UP=3,t.director=t.UP,t.EAST=t.RIGHT,t.SOUTH=t.DOWN,t.WEST=t.LEFT,t.NORTH=t.UP,t.standing={north:["player_standing_north.png"],south:["player_standing_south.png"],west:["player_standing_west.png"],east:["player_standing_east.png"]},t.walking={north:["player_walking_north.png","player_walking_north.png","player_standing_north.png","player_walking_north2.png","player_walking_north2.png","player_standing_north.png"],south:["player_walking_south.png","player_walking_south.png","player_standing_south.png","player_walking_south2.png","player_walking_south2.png","player_standing_south.png"],west:["player_walking_west.png","player_walking_west.png","player_standing_west.png","player_standing_west.png","player_walking_west2.png","player_walking_west2.png","player_standing_west.png","player_standing_west.png"],east:["player_walking_east.png","player_walking_east.png","player_standing_east.png","player_standing_east.png","player_walking_east2.png","player_walking_east2.png","player_standing_east.png","player_standing_east.png"]};var r=t.Gl2d.context;t.texture=r.createTexture(),r.bindTexture(r.TEXTURE_2D,t.texture);var n=function(){return parseInt(255*Math.random())};return r.texImage2D(r.TEXTURE_2D,0,r.RGBA,1,1,0,r.RGBA,r.UNSIGNED_BYTE,new Uint8Array([n(),n(),0,255])),t.SpriteSheet.ready.then(function(r){var n=t.SpriteSheet.getFrame(e);n&&i.loadTexture(t.Gl2d,t.SpriteSheet,n).then(function(e){t.texture=e.texture,t.width=e.image.width*t.scale,t.height=e.image.height*t.scale})}),t}return t=i,n=[{key:"loadTexture",value:function(e,t,r){var n=e.context;return this.promises||(this.promises={}),this.promises[r]||(console.log(r),this.promises[r]=i.loadImage(r).then(function(e){var t=n.createTexture();return n.bindTexture(n.TEXTURE_2D,t),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,e),{image:e,texture:t}})),this.promises[r]}},{key:"loadImage",value:function(e){return new Promise(function(t,r){var n=new Image;n.src=e,n.addEventListener("load",function(e){t(n)})})}}],(r=[{key:"draw",value:function(){this.frameDelay=1.5*this.maxSpeed-Math.abs(this.speed),this.frameDelay>this.maxSpeed&&(this.frameDelay=this.maxSpeed),this.currentDelay<=0?(this.currentDelay=this.frameDelay,this.currentFrame++):this.currentDelay--,this.currentFrame>=this.frames.length&&(this.currentFrame=this.currentFrame-this.frames.length);var e=this.frames[this.currentFrame];e&&(this.texture=e.texture,this.width=e.width*this.scale,this.height=e.height*this.scale);var t=this.Gl2d.context;t.bindFramebuffer(t.FRAMEBUFFER,null),t.useProgram(this.Gl2d.program),t.enableVertexAttribArray(this.Gl2d.positionLocation),t.bindTexture(t.TEXTURE_2D,this.texture),t.enableVertexAttribArray(this.Gl2d.texCoordLocation),t.bindBuffer(t.ARRAY_BUFFER,this.Gl2d.texCoordBuffer),t.vertexAttribPointer(this.Gl2d.texCoordLocation,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,this.Gl2d.texCoordBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),t.STREAM_DRAW),this.setRectangle(this.x-(this.Camera.x-this.Camera.width/2)-16*this.scale,this.y-(this.Camera.y-this.Camera.height/2)-this.height/2-16*this.scale,this.width,this.height),t.uniform4f(this.Gl2d.colorLocation,1,0,0,1),t.drawArrays(t.TRIANGLES,0,6)}},{key:"setFrames",value:function(e){var t=this,r=e.join(" ");this.currentFrames!==r&&(this.currentFrames=r,this.SpriteSheet.ready.then(function(r){var n=r.getFrames(e).map(function(e){return i.loadTexture(t.Gl2d,t.SpriteSheet,e).then(function(e){return{texture:e.texture,width:e.image.width,height:e.image.height}})});Promise.all(n).then(function(e){t.frames=e})}))}},{key:"setRectangle",value:function(e,t,r,n){var o=this.Gl2d.context;o.bindBuffer(o.ARRAY_BUFFER,this.Gl2d.positionBuffer),o.vertexAttribPointer(this.Gl2d.positionLocation,2,o.FLOAT,!1,0,0);var i=e,a=e+r,u=t,s=t+n;o.bufferData(o.ARRAY_BUFFER,new Float32Array([i,u,a,u,i,s,i,s,a,u,a,s]),o.STREAM_DRAW)}}])&&s(t.prototype,r),n&&s(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}(a.Injectable.inject({Gl2d:i.Gl2d,Camera:u.Camera,SpriteSheet:o.SpriteSheet}));e.Sprite=d}),require.register("sprite/SpriteBoard.js",function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.SpriteBoard=void 0;var o=t("curvature/base/Bag"),i=t("curvature/base/Bindable"),a=t("./Sprite"),u=(t("./SpriteSheet"),t("../model/Entity"),t("./Background")),s=t("../inject/Injectable"),c=t("../gl2d/Gl2d"),l=t("./Camera");function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function d(){return(d="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=y(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}}).apply(this,arguments)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return p(e)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(c,e);var t,r,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=y(e);if(t){var o=y(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return v(this,r)}}(c);function c(e,t){var r;!function(e,t){if(!(e instanceof c))throw new TypeError("Cannot call a class as a function")}(this),(r=n.call(this,e)).map=t,new(s.Injectable.inject({Gl2d:p(r)})),r.mouse={x:null,y:null,clickX:null,clickY:null},r.sprites=new o.Bag,r.Camera.width=r.element.width,r.Camera.height=r.element.height;var l=r.context;l.blendFunc(l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA),l.enable(l.BLEND),r.program=r.createProgram(r.createShader("sprite/texture.vert"),r.createShader("sprite/texture.frag")),r.overlayProgram=r.createProgram(r.createShader("overlay/overlay.vert"),r.createShader("overlay/overlay.frag")),r.positionLocation=l.getAttribLocation(r.program,"a_position"),r.texCoordLocation=l.getAttribLocation(r.program,"a_texCoord"),r.resolutionLocation=l.getUniformLocation(r.program,"u_resolution"),r.colorLocation=l.getUniformLocation(r.program,"u_color"),r.overlayPosition=l.getAttribLocation(r.overlayProgram,"a_position"),r.overlayResolution=l.getUniformLocation(r.overlayProgram,"u_resolution"),r.overlayColor=l.getUniformLocation(r.overlayProgram,"u_color"),r.positionBuffer=l.createBuffer(),r.texCoordBuffer=l.createBuffer(),l.bindBuffer(l.ARRAY_BUFFER,r.texCoordBuffer),l.bufferData(l.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),l.STATIC_DRAW),l.viewport(0,0,l.canvas.width,l.canvas.height),document.addEventListener("mousemove",function(e){r.mouse.x=e.clientX,r.mouse.y=e.clientY}),r.selected={localX:null,localY:null,globalX:null,globalY:null,startGlobalX:null,startGlobalY:null},r.selected=i.Bindable.makeBindable(r.selected);var f=!1;r.element.addEventListener("mousedown",function(e){var t=32*r.zoomLevel;if(r.unselect())f=!1;else{f=!0,r.mouse.clickX=e.clientX,r.mouse.clickY=e.clientY;var n=Math.floor((r.mouse.clickX+r.Camera.x%t-Math.floor(r.element.width/2)%t+16*r.zoomLevel)/t),o=Math.floor((r.mouse.clickY+r.Camera.y%t-Math.floor(r.element.height/2)%t+16*r.zoomLevel)/t);r.selected.startLocalX=n,r.selected.startLocalY=o,r.selected.startGlobalX=r.selected.startLocalX-Math.floor(Math.floor(r.element.width/2)/t)+(r.Camera.x<0?Math.ceil(r.Camera.x*r.zoomLevel/t):Math.floor(r.Camera.x*r.zoomLevel/t)),r.selected.startGlobalY=r.selected.startLocalY-Math.floor(Math.floor(r.element.height/2)/t)+(r.Camera.y<0?Math.ceil(r.Camera.y*r.zoomLevel/t):Math.floor(r.Camera.y*r.zoomLevel/t))}}),r.element.addEventListener("mouseup",function(e){var t=32*r.zoomLevel;if(f){console.log(e.clientX,e.clientY),r.mouse.clickX=e.clientX,r.mouse.clickY=e.clientY;var n=Math.floor((r.mouse.clickX+r.Camera.x%t-Math.floor(r.element.width/2)%t+16*r.zoomLevel)/t),o=Math.floor((r.mouse.clickY+r.Camera.y%t-Math.floor(r.element.height/2)%t+16*r.zoomLevel)/t);console.log(n,o);var i=n-Math.floor(Math.floor(r.element.width/2)/t)+(r.Camera.x<0?Math.ceil(r.Camera.x*r.zoomLevel/t):Math.floor(r.Camera.x*r.zoomLevel/t)),a=o-Math.floor(Math.floor(r.element.height/2)/t)+(r.Camera.y<0?Math.ceil(r.Camera.y*r.zoomLevel/t):Math.floor(r.Camera.y*r.zoomLevel/t));r.selected.localX=n,r.selected.globalX=i,r.selected.localY=o,r.selected.globalY=a,f=!1}else f=!1}),r.background=new u.Background(p(r),t),r.background1=new u.Background(p(r),t,1);var d=new a.Sprite("barrel.png");return d.x=32,d.y=32,r.sprites.add(r.background),r.sprites.add(r.background1),r.sprites.add(d),r}return t=c,(r=[{key:"unselect",value:function(){return null!==this.selected.localX&&(this.selected.localX=null,this.selected.localY=null,this.selected.globalX=null,this.selected.globalY=null,!0)}},{key:"draw",value:function(){var e=this.context;d(y(c.prototype),"draw",this).call(this),e.uniform2f(this.resolutionLocation,this.Camera.width,this.Camera.height);var t=this.sprites.items();if(t.map(function(e){e.z=e.y}),t.sort(function(e,t){return e instanceof u.Background&&!(t instanceof u.Background)?-1:t instanceof u.Background&&!(e instanceof u.Background)?1:void 0===e.z?-1:void 0===t.z?1:e.z-t.z}),t.map(function(e){return e.draw()}),null!==this.selected.localX){e.useProgram(this.overlayProgram),e.uniform2f(this.overlayResolution,e.canvas.width,e.canvas.height);var r=this.selected.startGlobalX,n=this.selected.globalX;this.selected.globalX<r&&(r=this.selected.globalX,n=this.selected.startGlobalX);var o=this.selected.startGlobalY,i=this.selected.globalY;this.selected.globalY<o&&(o=this.selected.globalY,i=this.selected.startGlobalY),n+=1,i+=1;var a=32*this.zoomLevel;this.setRectangle(r*a-this.Camera.x*this.zoomLevel+this.element.width/2-a/2,o*a-this.Camera.y*this.zoomLevel+this.element.height/2-a/2,(n-r)*a,(i-o)*a),console.log(),e.drawArrays(e.TRIANGLES,0,6)}}},{key:"resize",value:function(e,t){e=e||this.element.width,t=t||this.element.height,this.Camera.width=e,this.Camera.height=t,this.background.resize(Math.round(e/2+32)*(1/this.zoomLevel),Math.round(t/2+32)*(1/this.zoomLevel)),this.background1.resize(Math.round(e/2+32)*(1/this.zoomLevel),Math.round(t/2+32)*(1/this.zoomLevel)),d(y(c.prototype),"resize",this).call(this,e,t),this.Camera.width=e/this.zoomLevel,this.Camera.height=t/this.zoomLevel}},{key:"setRectangle",value:function(e,t,r,n){var o=this.context;o.bindBuffer(o.ARRAY_BUFFER,this.positionBuffer),o.vertexAttribPointer(this.overlayPosition,2,o.FLOAT,!1,0,0);var i=e,a=e+r,u=t,s=t+n;o.bufferData(o.ARRAY_BUFFER,new Float32Array([i,u,a,u,i,s,i,s,a,u,a,s]),o.STREAM_DRAW)}}])&&f(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),c}(c.Gl2d.inject({Camera:l.Camera}));e.SpriteBoard=b}),require.register("sprite/SpriteSheet.js",function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(e,"__esModule",{value:!0}),e.SpriteSheet=void 0;var o=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.imageUrl="/spritesheet.png",this.boxesUrl="/spritesheet.json",this.vertices={},this.frames={},this.width=0,this.height=0;var r=new Request(this.boxesUrl),n=fetch(r).then(function(e){return e.json().then(function(e){return t.boxes=e,!0})}),o=new Promise(function(e){t.image=new Image,t.image.src=t.imageUrl,t.image.onload=function(){e()}});this.ready=Promise.all([n,o]).then(function(){return t.processImage().then(function(){return t})})}var t,r,o;return t=e,o=[{key:"loadTexture",value:function(e,t){var r=e.context;return this.texturePromises||(this.texturePromises={}),this.texturePromises[t]||(this.texturePromises[t]=this.loadImage(t).then(function(e){var t=r.createTexture();return r.bindTexture(r.TEXTURE_2D,t),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,e),{image:e,texture:t}})),this.texturePromises[t]}},{key:"loadImage",value:function(e){return this.imagePromises||(this.imagePromises={}),this.imagePromises[e]||(this.imagePromises[e]=new Promise(function(t,r){var n=new Image;n.src=e,n.addEventListener("load",function(e){t(n)})})),this.imagePromises[e]}}],(r=[{key:"processImage",value:function(){var e=this;if(this.boxes&&this.boxes.frames){var t=document.createElement("canvas");t.width=this.image.width,t.height=this.image.height;var r=t.getContext("2d");r.drawImage(this.image,0,0);var n=[],o=function(t){var o=document.createElement("canvas");o.width=e.boxes.frames[t].frame.w,o.height=e.boxes.frames[t].frame.h;var i=o.getContext("2d");e.boxes.frames[t].frame&&i.putImageData(r.getImageData(e.boxes.frames[t].frame.x,e.boxes.frames[t].frame.y,e.boxes.frames[t].frame.w,e.boxes.frames[t].frame.h),0,0),e.boxes.frames[t].text&&(i.fillStyle=e.boxes.frames[t].color||"white",i.font=e.boxes.frames[t].font||"".concat(e.boxes.frames[t].frame.h,"px sans-serif"),i.textAlign="center",i.fillText(e.boxes.frames[t].text,e.boxes.frames[t].frame.w/2,e.boxes.frames[t].frame.h,e.boxes.frames[t].frame.w),i.textAlign=null,i.font=null),n.push(new Promise(function(r){o.toBlob(function(n){e.frames[e.boxes.frames[t].filename]=URL.createObjectURL(n),r(e.frames[e.boxes.frames[t].filename])})}))};for(var i in this.boxes.frames)o(i);return Promise.all(n)}}},{key:"getVertices",value:function(e){return this.vertices[e]}},{key:"getFrame",value:function(e){return this.frames[e]}},{key:"getFrames",value:function(e){var t=this;return Array.isArray(e)?e.map(function(e){return t.getFrame(e)}):this.getFramesByPrefix(e)}},{key:"getFramesByPrefix",value:function(e){var t=[];for(var r in this.frames)r.substring(0,e.length)===e&&t.push(this.frames[r]);return t}}])&&n(t.prototype,r),o&&n(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();e.SpriteSheet=o}),require.register("sprite/Surface.js",function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Surface=void 0;var o=t("../inject/Injectable"),i=t("./SpriteSheet"),a=t("./Camera"),u=t("../gl2d/Gl2d");function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(o,e);var t,r,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=f(e);if(t){var o=f(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return l(this,r)}}(o);function o(e,t){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,o),(r=n.call(this)).gl2d=e,r.x=u,r.y=s,r.layer=c,r.xSize=i,r.ySize=a,r.tileWidth=32,r.tileHeight=32,r.width=r.xSize*r.tileWidth,r.height=r.ySize*r.tileHeight,r.map=t,r.texVertices=[];var l=e.context;r.texture=l.createTexture(),r.subTextures={},r.loaded=!1,l.bindTexture(l.TEXTURE_2D,r.texture);var f=function(){return parseInt(255*Math.random())};l.texImage2D(l.TEXTURE_2D,0,l.RGBA,1,1,0,l.RGBA,l.UNSIGNED_BYTE,new Uint8Array([f(),f(),0,255])),r.SpriteSheet.ready.then(function(t){l.bindTexture(l.TEXTURE_2D,r.texture);for(var n=[],o=function(t){var o=t%r.xSize+Math.floor(r.x/r.tileWidth),i=Math.floor(t/r.xSize)+Math.floor(r.y/r.tileHeight),a=r.map.getTile(o,i,r.layer);if(Array.isArray(a)){var u=0;r.subTextures[t]=[],n.push(Promise.all(a.map(function(n){return r.SpriteSheet.constructor.loadTexture(e,n).then(function(e){return r.subTextures[t][u]=e.texture,u++,Promise.resolve()})})))}else n.push(r.SpriteSheet.constructor.loadTexture(e,a).then(function(e){return r.subTextures[t]=e.texture,Promise.resolve()}))},i=0;i<r.xSize*r.ySize;i++)o(i);Promise.all(n).then(function(){r.assemble(),r.loaded=!0})}),r.pane=l.createTexture(),l.bindTexture(l.TEXTURE_2D,r.pane),l.texImage2D(l.TEXTURE_2D,0,l.RGBA,r.width,r.height,0,l.RGBA,l.UNSIGNED_BYTE,null),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.NEAREST),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.NEAREST),r.frameBuffer=l.createFramebuffer(),l.bindFramebuffer(l.FRAMEBUFFER,r.frameBuffer);var d=l.COLOR_ATTACHMENT0;return l.framebufferTexture2D(l.FRAMEBUFFER,d,l.TEXTURE_2D,r.pane,0),r}return t=o,(r=[{key:"draw",value:function(){var e=this.gl2d.context;e.useProgram(this.gl2d.program),e.bindTexture(e.TEXTURE_2D,this.pane),this.setRectangle(this.x-(this.Camera.x-this.Camera.width/2)-16,this.y-(this.Camera.y-this.Camera.height/2)-16,this.width,this.height),e.bindFramebuffer(e.FRAMEBUFFER,null),e.drawArrays(e.TRIANGLES,0,6)}},{key:"assemble",value:function(){var e=this.gl2d.context;e.useProgram(this.gl2d.program),e.bindFramebuffer(e.FRAMEBUFFER,this.frameBuffer),e.viewport(0,0,this.width,this.height),e.uniform4f(this.gl2d.colorLocation,1,0,0,1),e.enableVertexAttribArray(this.gl2d.positionLocation),e.uniform2f(this.gl2d.resolutionLocation,this.width,this.height),e.bindTexture(e.TEXTURE_2D,this.texture),e.enableVertexAttribArray(this.gl2d.texCoordLocation),e.bindBuffer(e.ARRAY_BUFFER,this.gl2d.texCoordBuffer),e.vertexAttribPointer(this.gl2d.texCoordLocation,2,e.FLOAT,!1,0,0);var t=0,r=0;for(var n in this.subTextures){for(var o in Array.isArray(this.subTextures[n])||(this.subTextures[n]=[this.subTextures[n]]),this.subTextures[n])e.bindTexture(e.TEXTURE_2D,this.subTextures[n][o]),e.enableVertexAttribArray(this.gl2d.texCoordLocation),e.bindBuffer(e.ARRAY_BUFFER,this.gl2d.texCoordBuffer),e.vertexAttribPointer(this.gl2d.texCoordLocation,2,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,this.gl2d.texCoordBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),e.STREAM_DRAW),this.setRectangle(t,r+this.tileHeight,this.tileWidth,-this.tileHeight),e.drawArrays(e.TRIANGLES,0,6);(t+=this.tileWidth)>=this.width&&(t=0,r+=this.tileHeight)}e.bindFramebuffer(e.FRAMEBUFFER,null)}},{key:"setRectangle",value:function(e,t,r,n){var o=this.gl2d.context;o.bindBuffer(o.ARRAY_BUFFER,this.gl2d.positionBuffer),o.vertexAttribPointer(this.gl2d.positionLocation,2,o.FLOAT,!1,0,0);var i=e,a=e+r,u=t,s=t+n;o.bufferData(o.ARRAY_BUFFER,new Float32Array([i,s,a,s,i,u,i,u,a,s,a,u]),o.STATIC_DRAW)}}])&&s(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(o.Injectable.inject({Gl2d:u.Gl2d,Camera:a.Camera,SpriteSheet:i.SpriteSheet}));e.Surface=d}),require.register("sprite/TextureBank.js",function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(e,"__esModule",{value:!0}),e.TextureBank=void 0;var o=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)});e.TextureBank=o}),require.register("sprite/texture.frag",function(e,t,r){r.exports="precision mediump float;\n\nuniform vec4      u_color;\nuniform sampler2D u_image;\nvarying vec2      v_texCoord;\n\nvoid main() {\n   gl_FragColor = texture2D(u_image, v_texCoord);\n   // gl_FragColor = vec4(1.0,0.0,1.0,1.0);\n   // gl_FragColor = gl_PointCoord.yyxx;\n}\n"}),require.register("sprite/texture.vert",function(e,t,r){r.exports="attribute vec2 a_position;\nattribute vec2 a_texCoord;\n\nuniform   vec2 u_resolution;\n\nvarying   vec2 v_texCoord;\n\nvoid main()\n{\n   vec2 zeroToOne = a_position / u_resolution;\n   vec2 zeroToTwo = zeroToOne * 2.0;\n   vec2 clipSpace = zeroToTwo - 1.0;\n\n   gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);\n   v_texCoord  = a_texCoord;\n}\n"}),require.register("ui/Controller.js",function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=s(e);if(t){var o=s(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return u(this,r)}}function u(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Controller=void 0;var c=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}(s,t("curvature/base/View").View);var r,n,u=a(s);function s(e){var r;return function(e,t){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}(this),(r=u.call(this,e)).template=t("./controller.tmp"),r.dragStart=!1,r.args.dragging=!1,r.args.x=0,r.args.y=0,window.addEventListener("mousemove",function(e){r.moveStick(e)}),window.addEventListener("mouseup",function(e){r.dropStick(e)}),window.addEventListener("touchmove",function(e){r.moveStick(e)}),window.addEventListener("touchend",function(e){r.dropStick(e)}),r}return r=s,(n=[{key:"dragStick",value:function(e){var t=e;e.preventDefault(),e.touches&&e.touches[0]&&(t=e.touches[0]),this.args.dragging=!0,this.dragStart={x:t.clientX,y:t.clientY}}},{key:"moveStick",value:function(e){if(this.args.dragging){var t=e;e.touches&&e.touches[0]&&(t=e.touches[0]),this.args.xx=t.clientX-this.dragStart.x,this.args.yy=t.clientY-this.dragStart.y;this.args.xx<-50?this.args.x=-50:this.args.xx>50?this.args.x=50:this.args.x=this.args.xx,this.args.yy<-50?this.args.y=-50:this.args.yy>50?this.args.y=50:this.args.y=this.args.yy}}},{key:"dropStick",value:function(e){this.args.dragging=!1,this.args.x=0,this.args.y=0}}])&&o(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),s}();e.Controller=c}),require.register("ui/MapEditor.js",function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=s(e);if(t){var o=s(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return u(this,r)}}function u(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.MapEditor=void 0;var c=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}(s,t("curvature/base/View").View);var r,n,u=a(s);function s(e){var r;return function(e,t){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}(this),(r=u.call(this,e)).template=t("./mapEditor.tmp"),e.spriteSheet.ready.then(function(e){r.args.tiles=e.frames}),r.args.bindTo("selectedGraphic",function(e){r.args.selectedGraphic=null},{wait:0}),r.args.multiSelect=!1,r.args.selection={},r.args.selectedImage=null,r}return r=s,(n=[{key:"selectGraphic",value:function(e){console.log(e),this.args.selectedGraphic=e}},{key:"select",value:function(e){Object.assign(this.args.selection,e),e.globalX!==e.startGlobalX||e.globalY!==e.startGlobalY?this.args.multiSelect=!0:this.args.multiSelect=!1,this.args.multiSelect||(this.args.selectedImages=this.args.map.getTile(e.globalX,e.globalY))}}])&&o(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),s}();e.MapEditor=c}),require.register("ui/controller.tmp.html",function(e,t,r){r.exports='<div class = "controller">\n\t<div class = "joystick" cv-on = "\n\t\ttouchstart:dragStick(event);\n\t\tmousedown:dragStick(event);\n\t">\n\t\t<div class = "pad" style = "position: relative; transform:translate([[x]]px,[[y]]px);"></div>\n\t</div>\n\n\t<div class = "button">A</div>\n\t<div class = "button">B</div>\n\t<div class = "button">C</div>\n</div>'}),require.register("ui/mapEditor.tmp.html",function(e,t,r){r.exports='<div class = "tab-page mapEditor">\n\t<div class = "tabs">\n\t\t<div>Tile</div>\n\t\t<div>Layer</div>\n\t\t<div>Object</div>\n\t\t<div>Trigger</div>\n\t\t<div>Map</div>\n\t</div>\n\n\t<div class = "tile">\n\t\t<div class = "selected">\n\t\t\t<div cv-if = "!multiSelect">\n\t\t\t\t<p style = "font-size: large">\n\t\t\t\t\t([[selection.globalX]], [[selection.globalY]])\n\t\t\t\t</p>\n\t\t\t\t<p cv-each = "selectedImages:selectedImage:sI">\n\t\t\t\t\t<button>-</button>\n\t\t\t\t\t<img class = "current" cv-attr = "src:selectedImage">\n\t\t\t\t</p>\n\t\t\t\t<button>+</button>\n\t\t\t</div>\n\t\t\t<div cv-if = "multiSelect">\n\t\t\t\t<p style = "font-size: large">\n\t\t\t\t\t([[selection.startGlobalX]], [[selection.startGlobalY]]) - ([[selection.globalX]], [[selection.globalY]])\n\t\t\t\t</p>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class = "tiles" cv-each = "tiles:tile:t">\n\t\t\t<img cv-attr = "src:tile,title:t" cv-on = "click:selectGraphic(t);">\n\t\t</div>\n\t</div>\n\t\x3c!-- <div class = "tile">OBJECT MODE</div>\n\t<div class = "tile">TRIGGER MODE</div>\n\t<div class = "tile">MAP MODE</div> --\x3e\n</div>'}),require.register("world/Actor.js",function(e,t,r){}),require.register("world/Floor.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Floor=void 0;var n=t("../sprite/Sprite");function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.gl2d=t,this.sprites=[],this.resize(9,9)}var t,r;return t=e,(r=[{key:"resize",value:function(e,t){this.width=e,this.height=t;for(var r=0;r<e;r++)for(var o=0;o<t;o++){var i=new n.Sprite(this.gl2d,"/floorTile.png");i.x=32*r,i.y=32*o,this.sprites.push(i)}}},{key:"draw",value:function(){this.sprites.map(function(e){return e.draw()})}}])&&o(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();e.Floor=i}),require.register("world/Map.js",function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Map=void 0;var o=t("../sprite/SpriteSheet");function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=c(e);if(t){var o=c(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return s(this,r)}}function s(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}(o,e);var t,r,n=u(o);function o(){var e;return function(e,t){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}(this),(e=n.call(this)).tiles={},e}return t=o,(r=[{key:"getTile",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.tiles["".concat(e,",").concat(t,"--").concat(r)]?[this.SpriteSheet.getFrame(this.tiles["".concat(e,",").concat(t,"--").concat(r)])]:[this.SpriteSheet.getFrame("floorTile.png")]}},{key:"setTile",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.tiles["".concat(e,",").concat(t,"--").concat(n)]=r}},{key:"export",value:function(){console.log(JSON.stringify(this.tiles))}},{key:"import",value:function(e){this.tiles=JSON.parse('{"-2,11":"lava_center_middle.png","-1,11":"lava_center_middle.png","0,11":"lava_center_middle.png"}')}}])&&i(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(t("../inject/Injectable").Injectable.inject({SpriteSheet:o.SpriteSheet}));e.Map=l}),require.register("___globals___",function(e,t,r){})}(),require("___globals___");
