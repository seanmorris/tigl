!function(){"use strict";var e="undefined"==typeof global?self:global;if("function"!=typeof e.require){var t={},r={},n={},i={}.hasOwnProperty,o=/^\.\.?(\/|$)/,a=function(e,t){for(var r,n=[],i=(o.test(t)?e+"/"+t:t).split("/"),a=0,s=i.length;a<s;a++)".."===(r=i[a])?n.pop():"."!==r&&""!==r&&n.push(r);return n.join("/")},s=function(e){return e.split("/").slice(0,-1).join("/")},u=function(t,n){var i,o={id:t,exports:{},hot:d&&d.createHot(t)};return r[t]=o,n(o.exports,(i=t,function(t){var r=a(s(i),t);return e.require(r,i)}),o),o.exports},c=function(e){var t=n[e];return t&&e!==t?c(t):e},l=function(e,n){null==n&&(n="/");var o=c(e);if(i.call(r,o))return r[o].exports;if(i.call(t,o))return u(o,t[o]);throw new Error("Cannot find module '"+e+"' from '"+n+"'")};l.alias=function(e,t){n[t]=e};var f=/\.[^.\/]+$/,h=/\/index(\.[^\/]+)?$/;l.register=l.define=function(e,o){if(e&&"object"==typeof e)for(var a in e)i.call(e,a)&&l.register(a,e[a]);else t[e]=o,delete r[e],function(e){if(f.test(e)){var t=e.replace(f,"");i.call(n,t)&&n[t].replace(f,"")!==t+"/index"||(n[t]=e)}if(h.test(e)){var r=e.replace(h,"");i.call(n,r)||(n[r]=e)}}(e)},l.list=function(){var e=[];for(var r in t)i.call(t,r)&&e.push(r);return e};var d=e._hmr&&new e._hmr(function(e,t){return c(a(s(e),t))},l,t,r);l._cache=r,l.hmr=d&&d.wrap,l.brunch=!0,e.require=l}}(),function(){"undefined"==typeof window||window;var e=function(e,t,r){var n={},i=function(t,r){try{return e(r+"/node_modules/"+t)}catch(e){if(-1===e.toString().indexOf("Cannot find module"))throw e;if(-1!==r.indexOf("node_modules")){var o=r.split("/"),a=o.lastIndexOf("node_modules"),s=o.slice(0,a).join("/");return i(t,s)}}return n};return function(o){if(o in t&&(o=t[o]),o){if("."!==o[0]&&r){var a=i(o,r);if(a!==n)return a}return e(o)}}};require.register("curvature/base/Bag.js",function(t,r,n){r=e(r,{},"curvature"),function(){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();t.Bag=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.meta=Symbol("meta"),this.content={},this._items=!1,this.changeCallback=e}return r(t,[{key:"add",value:function(t){if((void 0===t?"undefined":e(t))instanceof Object)throw new Error("Only objects may be added/removed from Bags.");t[this.meta]||(t[this.meta]=Symbol("bagId")),this.content[t[this.meta]]=t,this.changeCallback&&this.changeCallback(this.content[t[this.meta]],this.meta,1)}},{key:"remove",value:function(t){if("object"!==(void 0===t?"undefined":e(t)))throw new Error("Only objects may be added/removed from Bags.");if(!t[this.meta]||!this.content[t[this.meta]])return this.changeCallback&&this.changeCallback(void 0,this.meta,0),!1;var r=this.content[t[this.meta]];delete this.content[t[this.meta]],this.changeCallback&&this.changeCallback(r,this.meta,-1)}},{key:"id",value:function(e){return e[this.meta]}},{key:"get",value:function(e){return this.content[e]}},{key:"keys",value:function(){return Object.getOwnPropertySymbols(this.content).slice()}},{key:"items",value:function(){var e=this;return this.keys().map(function(t){return e.get(t)}).slice()}}]),t}()}()}),require.register("curvature/base/Bindable.js",function(t,r,n){r=e(r,{},"curvature"),function(){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();t.Bindable=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t)}return r(t,null,[{key:"isBindable",value:function(e){return!!e.___binding___&&e.___binding___===t}},{key:"makeBindable",value:function(r){if(!r||r.___binding___||"object"!==(void 0===r?"undefined":e(r))||r instanceof Node)return r;for(var n in Object.defineProperty(r,"___ref___",{enumerable:!1,writable:!0}),Object.defineProperty(r,"bindTo",{enumerable:!1,writable:!0}),Object.defineProperty(r,"isBound",{enumerable:!1,writable:!0}),Object.defineProperty(r,"___binding___",{enumerable:!1,writable:!0}),Object.defineProperty(r,"___bindingAll___",{enumerable:!1,writable:!0}),Object.defineProperty(r,"___isBindable___",{enumerable:!1,writable:!0}),Object.defineProperty(r,"___executing___",{enumerable:!1,writable:!0}),Object.defineProperty(r,"___stack___",{enumerable:!1,writable:!0}),Object.defineProperty(r,"___stackTime___",{enumerable:!1,writable:!0}),Object.defineProperty(r,"___before___",{enumerable:!1,writable:!0}),Object.defineProperty(r,"___after___",{enumerable:!1,writable:!0}),Object.defineProperty(r,"___setCount___",{enumerable:!1,writable:!0}),Object.defineProperty(r,"___wrapped___",{enumerable:!1,writable:!0}),Object.defineProperty(r,"___object___",{enumerable:!1,writable:!1,value:r}),r.___isBindable___=t,r.___wrapped___={},r.___binding___={},r.___bindingAll___=[],r.___stack___=[],r.___stackTime___=[],r.___before___=[],r.___after___=[],r.___setCount___={},r.bindTo=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=!1;e instanceof Function&&(n=t||{},t=e,i=!0);var o=!1;n.delay>=0&&(t=function(e){return function(t,r,i,o){var a=i[r];setTimeout(function(){return e(t,r,i,o,a)},n.delay)}}(t)),n.throttle>=0&&(t=function(e){return function(t,r,i,a){if(!o){var s=i[r];e(t,r,i,a,s),o=!0,setTimeout(function(){return o=!1},n.throttle)}}}(t));var a=void 0;if(n.wait>=0&&(t=function(e){return function(t,r,i,o){a&&clearTimeout(a);var s=i[r];a=setTimeout(function(){return e(t,r,i,o,s)},n.wait)}}(t)),i){var s=r.___bindingAll___.length;for(var u in r.___bindingAll___.push(t),r)t(r[u],u,r,!1);return function(){r.___bindingAll___[s]=null}}r.___binding___[e]||(r.___binding___[e]=[]);var c=r.___binding___[e].length;return r.___binding___[e].push(t),t(r[e],e,r,!1),function(){r.___binding___[e]&&(r.___binding___[e][c]=null)}},r.isBound=function(){for(var e in r.___bindingAll___)if(r.___bindingAll___[e])return!0;for(var t in r.___binding___)for(var n in r.___binding___[t])if(r.___binding___[t][n])return!0;return!1},r)r[n]&&"object"==e(r[n])&&!r[n]instanceof Node&&!r[n]instanceof Promise&&(r[n]=t.makeBindable(r[n]));return r.___ref___=new Proxy(r,{deleteProperty:function(e,t){if(!(t in e))return!0;for(var n in r.___bindingAll___)r.___bindingAll___[n](void 0,t,e,!0,e[t]);if(t in r.___binding___)for(var i in r.___binding___[t])r.___binding___[t][i]&&r.___binding___[t][i](void 0,t,e,!0,e[t]);return Array.isArray(e)?e.splice(t,1):delete e[t],!0},get:function(e,n){return e[n]instanceof Function?(e.___wrapped___[n]||(e.___wrapped___[n]=function(){for(var t in e.___executing___=n,e.___stack___.unshift(n),e.___before___)e.___before___[t](e,n,r);var i=r instanceof Promise?r:r.___ref___,o=e[n].apply(i,arguments);for(var a in e.___after___)e.___after___[a](e,n,r);return e.___executing___=null,e.___stack___.shift(),o}),e.___wrapped___[n]):(e[n]instanceof Object&&t.makeBindable(e[n]),e[n])},set:function(n,i,o){if("string"==typeof i&&"___"===i.substring(0,3)&&"___"===i.slice(-3))return!0;if(n[i]===o)return!0;if(o&&"object"==(void 0===o?"undefined":e(o))&&!(o instanceof Node)&&o.___isBindable___!==t)for(var a in o=t.makeBindable(o))o[a]&&"object"==e(o[a])&&(o[a]=t.makeBindable(o[a]));for(var s in r.___bindingAll___)r.___bindingAll___[s]&&r.___bindingAll___[s](o,i,n,!1);var u=!1;if(i in r.___binding___)for(var c in r.___binding___[i])r.___binding___[i]&&r.___binding___[i][c]&&!1===r.___binding___[i][c](o,i,n,!1,n[i])&&(u=!0);if(!u){var l=Object.getOwnPropertyDescriptor(n,i);n instanceof File&&"lastModifiedDate"==i||l&&!l.writable||(n[i]=o)}return n.___setCount___[i]||(n.___setCount___[i]=0),n.___setCount___[i]++,n.___setCount___[i],Reflect.set(n,i,o)}}),r.___ref___}},{key:"clearBindings",value:function(e){e.___wrapped___={},e.___bindingAll___=[],e.___binding___={},e.___before___=[],e.___after___=[],e.___ref___={}}},{key:"resolve",value:function(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=void 0,i=t.split("."),o=i[0];i.length;){if(r&&1===i.length)return[this.makeBindable(e),i.shift(),o];!(!(n=i.shift())in e)&&e[n]&&e[n]instanceof Object||(e[n]={}),e=this.makeBindable(e[n])}return[this.makeBindable(e),n,o]}}]),t}()}()}),require.register("curvature/base/Cache.js",function(t,r,n){r=e(r,{},"curvature"),function(){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();t.Cache=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t)}return e(t,null,[{key:"store",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"standard",i=0;r&&(i=1e3*r+(new Date).getTime()),this.bucket||(this.bucket={}),this.bucket[n]||(this.bucket[n]={}),this.bucket[n][e]={expiration:i,value:t}}},{key:"load",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"standard";return this.bucket&&this.bucket[r]&&this.bucket[r][e]&&(0==this.bucket[r][e].expiration||this.bucket[r][e].expiration>(new Date).getTime())?this.bucket[r][e].value:t}}]),t}()}()}),require.register("curvature/base/Cookie.js",function(t,r,n){r=e(r,{},"curvature"),function(){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Cookie=void 0;var e=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),n=r("./Bindable"),i=t.Cookie=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t)}return e(t,null,[{key:"set",value:function(e,r){t.jar[e]=r}},{key:"get",value:function(e){return t.jar[e]}},{key:"delete",value:function(e){delete t.jar[e]}}]),t}();i.jar=i.jar||n.Bindable.makeBindable({}),"data"!==window.location.href.substr(0,4)&&(document.cookie.split(";").map(function(e){var t=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}(e.split("="),2),r=t[0],n=t[1];try{n=JSON.parse(n)}catch(e){n=n}r=r.trim(),i.jar[decodeURIComponent(r)]=n}),i.jar.bindTo(function(e,t,r,n){r[t]=e,n&&(r[t]=null);var i=encodeURIComponent(t)+"="+r[t];document.cookie=i}))}()}),require.register("curvature/base/Dom.js",function(t,r,n){r=e(r,{},"curvature"),function(){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();t.Dom=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t)}return e(t,null,[{key:"mapTags",value:function(e,t,r,n,i){var o=[],a=!0;n&&(a=!1);for(var s=!1,u=document.createTreeWalker(e,NodeFilter.SHOW_ALL,{acceptNode:function(e){if(!a){if(e!==n)return NodeFilter.FILTER_SKIP;a=!0}return i&&e===i&&(s=!0),s?NodeFilter.FILTER_SKIP:t?e instanceof Element&&e.matches(t)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT}},!1);u.nextNode();)o.push(r(u.currentNode));return o}},{key:"dispatchEvent",value:function(e,r){e.dispatchEvent(r),t.mapTags(e,!1,function(e){e.dispatchEvent(r)})}}]),t}()}()}),require.register("curvature/base/Router.js",function(t,r,n){r=e(r,{},"curvature"),function(){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Router=void 0;var e=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),n=r("./View"),i=(r("./Cache"),r("Config"));t.Router=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t)}return e(t,null,[{key:"wait",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"DOMContentLoaded";(arguments.length>2&&void 0!==arguments[2]?arguments[2]:document).addEventListener(r,function(){t.listen(e)})}},{key:"listen",value:function(e){var t=this,r=[location.toString()],n=history.length,i=location.pathname+location.search;location.hash&&(i+=location.hash),window.addEventListener("popstate",function(i){i.preventDefault(),r.length&&n==history.length?location.toString()==r[r.length-2]?r.pop():r.push(location.toString()):(r.push(location.toString()),n=history.length),t.match(location.pathname,e)}),this.go(i)}},{key:"go",value:function(e,t){var r=this;document.title=i.Config.title,setTimeout(function(){history.pushState(null,null,e),t||(!1===t&&(r.path=null),window.dispatchEvent(new Event("popstate")),"#"===e.substring(0,1)&&window.dispatchEvent(new HashChangeEvent("hashchange")))},0)}},{key:"match",value:function(e,t){var r=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.path!==e||i){var o=new CustomEvent("cvRouteStart",{cancelable:!0,detail:{result:b,path:e,view:t}}),a=t.args.content,s=t.routes;this.path=e,this.query={};var u=new URLSearchParams(location.search);this.queryString=location.search;var c=!0,l=!1,f=void 0;try{for(var h,d=u[Symbol.iterator]();!(c=(h=d.next()).done);c=!0){var p=h.value;this.query[p[0]]=p[1]}}catch(e){l=!0,f=e}finally{try{!c&&d.return&&d.return()}finally{if(l)throw f}}var v={},y=!1,b="";for(var m in e=e.substr(1).split("/"),this.query)v[m]=this.query[m];e:for(var g in s){var _=g.split("/");if(!(_.length<e.length)){for(var w in _)if("%"==_[w].substr(0,1)){var T=null,k=/^%(\w+)\??/.exec(_[w]);if(k&&k[1]&&(T=k[1]),!T)throw new Error(_[w]+' is not a valid argument segment in route "'+g+'"');if(e[w])v[T]=e[w];else{if("?"!=_[w].substr(_[w].length-1,1))continue e;v[T]=""}}else if(e[w]!==_[w])continue e;if(!i&&a&&s[g]instanceof Object&&a instanceof s[g]&&!(s[g]instanceof Promise)&&a.update(v))return t.args.content=a,!0;y=g,b=s[g];break}}if(document.dispatchEvent(o),y in s&&s[y]instanceof Object&&s[y].isView&&s[y].isView())(b=new s[y](v)).root=function(){return t};else if(s[y]instanceof Function){b="";var E=s[y](v);E instanceof Promise?(b=!1,E.then(function(n){r.update(t,e,n)}).catch(function(n){r.update(t,e,n)})):b=E}else s[y]instanceof Promise?(b=!1,s[y].then(function(n){r.update(t,e,n)}).catch(function(n){r.update(t,e,n)})):s[y]instanceof Object?b=new s[y](v):"string"==typeof s[y]&&(b=s[y]);return this.update(t,e,b),b instanceof n.View&&(b.pause(!1),b.update(v,i)),!1!==y}}},{key:"update",value:function(e,t,r){var i=new CustomEvent("cvRoute",{cancelable:!0,detail:{result:r,path:t,view:e}}),o=new CustomEvent("cvRouteEnd",{cancelable:!0,detail:{result:r,path:t,view:e}});!1!==r&&(e.args.content instanceof n.View&&e.args.content.remove(),document.dispatchEvent(i)&&(e.args.content=r),document.dispatchEvent(o))}},{key:"clearCache",value:function(){}},{key:"queryOver",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new URLSearchParams(location.search),r={},n=[],i=!0,o=!1,a=void 0;try{for(var s,u=t[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value;n[c[0]]=c[1]}}catch(e){o=!0,a=e}finally{try{!i&&u.return&&u.return()}finally{if(o)throw a}}for(var l in n)r[l]=n[l];for(var f in e)r[f]=e[f];return delete r.api,r}},{key:"queryToString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=[],n=e;for(var i in t||(n=this.queryOver(e)),n)""!==n[i]&&r.push(i+"="+encodeURIComponent(n[i]));return r.join("&")}},{key:"setQuery",value:function(e,t,r){var n={};n[e]=t,this.go(this.path+"?"+this.queryToString(n),r)}}]),t}()}()}),require.register("curvature/base/RuleSet.js",function(t,r,n){r=e(r,{},"curvature"),function(){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RuleSet=void 0;var e=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),n=(r("./Dom"),r("./Tag")),i=r("./View");t.RuleSet=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t)}return e(t,[{key:"add",value:function(e,t){return this.rules=this.rules||{},this.rules[e]=this.rules[e]||[],this.rules[e].push(t),this}},{key:"apply",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;for(var n in t.apply(e,r),this.rules)for(var i in this.rules[n]){var o=this.rules[n][i],a=t.wrap(e,o,r),s=e.querySelectorAll(n),u=!0,c=!1,l=void 0;try{for(var f,h=s[Symbol.iterator]();!(u=(f=h.next()).done);u=!0){a(f.value)}}catch(e){c=!0,l=e}finally{try{!u&&h.return&&h.return()}finally{if(c)throw l}}}}}],[{key:"add",value:function(e,t){return this.globalRules=this.globalRules||{},this.globalRules[e]=this.globalRules[e]||[],this.globalRules[e].push(t),this}},{key:"apply",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;for(var r in this.globalRules)for(var n in this.globalRules[r]){var i=this.globalRules[r][n],o=this.wrap(e,i,t),a=e.querySelectorAll(r),s=!0,u=!1,c=void 0;try{for(var l,f=a[Symbol.iterator]();!(s=(l=f.next()).done);s=!0){o(l.value)}}catch(e){u=!0,c=e}finally{try{!s&&f.return&&f.return()}finally{if(u)throw c}}}}},{key:"wait",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"DOMContentLoaded",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,n=function(t,r){return function(){return r.removeEventListener(t,n),e.apply()}}(t,r);r.addEventListener(t,n)}},{key:"wrap",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return(t instanceof i.View||t&&t.prototype&&t.prototype instanceof i.View)&&(t=function(e){return function(){return e}}(t)),function(e){for(var o in e.___cvApplied___||(Object.defineProperty(e,"___cvApplied___",{enumerable:!1,writable:!0}),e.___cvApplied___=[]),e.___cvApplied___)if(t==e.___cvApplied___[o])return;var a=void 0,s=void 0;r&&(a=s=r,r.viewList&&(s=r.viewList.parent));var u,c=new n.Tag(e,s,null,void 0,a),l=c.element.parentNode,f=c.element.nextSibling,h=t(c);if(!1!==h&&e.___cvApplied___.push(t),h instanceof HTMLElement&&(h=new n.Tag(h)),h instanceof n.Tag){if(!h.element.contains(c.element)){for(;c.element.firstChild;)h.element.appendChild(c.element.firstChild);c.remove()}f?l.insertBefore(h.element,f):l.appendChild(h.element)}h&&h.prototype&&h.prototype instanceof i.View&&(h=new h),h instanceof i.View&&(r&&(r.cleanup.push((u=h,function(){u.remove()})),h.parent=r,r.cleanup.push(r.args.bindTo(function(e,t,r){r[t]=e,h.args[t]=e})),r.cleanup.push(h.args.bindTo(function(e,t,n,i){n[t]=e,r.args[t]=e}))),c.clear(),h.render(c.element))}}}]),t}()}()}),require.register("curvature/base/Tag.js",function(t,r,n){r=e(r,{},"curvature"),function(){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Tag=void 0;var e=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),n=r("./Bindable");t.Tag=function(){function t(e,r,i,o,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.element=n.Bindable.makeBindable(e),this.parent=r,this.direct=a,this.ref=i,this.index=o,this.cleanup=[],this.proxy=n.Bindable.makeBindable(this)}return e(t,[{key:"remove",value:function(){n.Bindable.clearBindings(this);for(var e=void 0;e=this.cleanup.shift();)e();if(this.clear(),this.element){var t=new Event("cvDomDetached");this.element.dispatchEvent(t),this.element.remove(),this.element=this.ref=this.parent=null}}},{key:"clear",value:function(){if(this.element)for(var e=new Event("cvDomDetached");this.element.firstChild;)this.element.firstChild.dispatchEvent(e),this.element.removeChild(this.element.firstChild)}},{key:"pause",value:function(){}}]),t}()}()}),require.register("curvature/base/View.js",function(t,r,n){r=e(r,{},"curvature"),function(){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.View=void 0;var e=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r("./Bindable"),o=r("./ViewList"),a=r("./Router"),s=(r("./Cookie"),r("./Dom")),u=(r("./Tag"),r("./RuleSet"));t.View=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,t),Object.defineProperty(this,"___VIEW___",{enumerable:!1,writable:!0}),this.___VIEW___=t,this.args=i.Bindable.makeBindable(e),this._id=this.uuid(),this.args._id=this._id,this.template="",this.document="",this.firstNode=null,this.lastNode=null,this.nodes=null,this.cleanup=[],this.attach=[],this.detach=[],this.eventCleanup=[],this.parent=null,this.viewList=null,this.viewLists={},this.withViews={},this.tags={},this.intervals=[],this.timeouts=[],this.frames=[],this.ruleSet=new u.RuleSet,this.preRuleSet=new u.RuleSet,this.subBindings={},this.removed=!1,this.preserve=!1,this.interpolateRegex=/(\[\[((?:\$)?[\w\.]+)\]\])/g}return n(t,[{key:"onFrame",value:function(e){!function t(r){e(r),window.requestAnimationFrame(t)}()}},{key:"onTimeout",value:function(e,t){var r=this,n=function(){r.timeouts[o].fired=!0,r.timeouts[o].callback=null,t()},i=setTimeout(n,e),o=this.timeouts.length;return this.timeouts.push({timeout:i,callback:n,time:e,fired:!1,created:(new Date).getTime(),paused:!1}),i}},{key:"clearTimeout",value:function(e){for(var t in this.timeouts)e===this.timeouts[t].timeout&&(clearInterval(this.timeouts[t].timeout),delete this.timeouts[t])}},{key:"onInterval",value:function(e,t){var r=setInterval(t,e);return this.intervals.push({timeout:r,callback:t,time:e,paused:!1}),r}},{key:"clearInterval",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){for(var t in this.intervals)e===this.intervals[t].timeout&&(clearInterval(this.intervals[t].timeout),delete this.intervals[t])})},{key:"pause",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;if(void 0===e&&(this.paused=!this.paused),this.paused=e,this.paused){for(var t in this.timeouts)this.timeouts[t].fired?delete this.timeouts[t]:clearTimeout(this.timeouts[t].timeout);for(var r in this.intervals)clearInterval(this.intervals[r].timeout)}else{for(var n in this.timeouts)this.timeouts[n].timeout.paused&&(this.timeouts[n].fired?delete this.timeouts[n]:this.timeouts[n].timeout=setTimeout(this.timeouts[n].callback,this.timeouts[n].time));for(var i in this.intervals)this.intervals[i].timeout.paused&&(this.intervals[i].timeout.paused=!1,this.intervals[i].timeout=setInterval(this.intervals[i].callback,this.intervals[i].time))}for(var o in this.viewLists){if(!this.viewLists[o])return;this.viewLists[o].pause(!!e)}for(var a in this.tags)if(Array.isArray(this.tags[a]))for(var s in this.tags[a])this.tags[a][s].pause(!!e);else this.tags[a].pause(!!e)}},{key:"render",value:function(){var e=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(n instanceof t&&(n=n.firstNode),this.nodes){for(var i in this.detach)this.detach[i]();var o=function(t){var i=new Event("cvDomDetached",{bubbles:!0,target:e.nodes[t]}),o=new Event("cvDomAttached",{bubbles:!0,target:e.nodes[t]});e.nodes[t].dispatchEvent(i),s.Dom.mapTags(e.nodes[t],!1,function(e){e.dispatchEvent(i)}),r&&(n?r.insertBefore(e.nodes[t],n):r.appendChild(e.nodes[t])),s.Dom.mapTags(e.nodes[t],!1,function(e){e.dispatchEvent(o)}),e.nodes[t].dispatchEvent(o)};for(var a in this.nodes)o(a);for(var u in this.attach)this.attach[u]()}else{var c=void 0;this.template==document?c=this.template:this.document?c=this.document:(c=document.createRange().createContextualFragment(this.template),this.document=c),this.preRuleSet.apply(c,this),s.Dom.mapTags(c,!1,function(t){t.matches?(t.matches("[cv-each]")&&e.mapEachTags(t),t.matches("[cv-with]")&&e.mapWithTags(t),t.matches("[cv-prerender]")&&e.mapPrendererTags(t),t.matches("[cv-link]")&&e.mapLinkTags(t),t.matches("[cv-bind]")&&e.mapBindTags(t),t.matches("[cv-attr]")&&e.mapAttrTags(t),e.mapInterpolatableTags(t),t.matches("[cv-expand]")&&e.mapExpandableTags(t),t.matches("[cv-if]")&&e.mapIfTags(t),t.matches("[cv-ref]")&&e.mapRefTags(t),t.matches("[cv-on]")&&e.mapOnTags(t)):e.mapInterpolatableTags(t)}),this.ruleSet.apply(c,this),this.nodes=[],!0===window.devmode?this.firstNode=document.createComment("Template "+this._id+" Start"):this.firstNode=document.createTextNode(""),this.nodes.push(this.firstNode),r&&(n?r.insertBefore(this.firstNode,n):r.appendChild(this.firstNode));for(var l=function(){var t=c.firstChild,i=new Event("cvDomAttached",{bubbles:!0,target:t});e.nodes.push(t),r&&(n?r.insertBefore(t,n):r.appendChild(t)),s.Dom.mapTags(t,!1,function(e){e.dispatchEvent(i)}),t.dispatchEvent(i)};c.firstChild;)l();for(var f in!0===window.devmode?this.lastNode=document.createComment("Template "+this._id+" End"):this.lastNode=document.createTextNode(""),this.nodes.push(this.lastNode),r&&(n?r.insertBefore(this.lastNode,n):r.appendChild(this.lastNode)),this.attach)this.attach[f]();this.postRender(r)}}},{key:"mapExpandableTags",value:function(e){var t=this,r=e.getAttribute("cv-expand"),n=i.Bindable.makeBindable(this.args[r]||{});e.removeAttribute("cv-expand");var o=function(r){if("name"==r||"type"==r)return"continue";var o=n.bindTo(r,function(e,t){return function(r){e.setAttribute(t,r)}}(e,r));t.cleanup.push(function(){o(),n.isBound()&&i.Bindable.clearBindings(n)})};for(var a in n)o(a)}},{key:"mapAttrTags",value:function(t){var r=this,n=t.getAttribute("cv-attr");t.removeAttribute("cv-attr");var o=n.split(",").map(function(e){return e.split(":")}),a=function(n){var a=r.args,s=o[n][1],u=s;if(s.match(/\./)){var c=i.Bindable.resolve(r.args,s,!0),l=e(c,2);a=l[0],u=l[1]}a[o[n][1]]&&t.setAttribute(o[n][0],a[o[n][1]]);var f=o[n][0];r.cleanup.push(a.bindTo(u,function(e){null!=e?t.setAttribute(f,e):t.setAttribute(f,"")}))};for(var s in o)a(s)}},{key:"mapInterpolatableTags",value:function(r){var n=this,o=this.interpolateRegex;if(r.nodeType==Node.TEXT_NODE){var a=r.nodeValue;if(!this.interpolatable(a))return;for(var s=0,u=void 0,c=function(){var o=u[2],c=!1;if("$"===o.substr(0,1)&&(c=!0,o=o.substr(1)),"000"===o.substr(0,3))return expand=!0,o=o.substr(3),"continue";var l=a.substring(s,u.index);s=u.index+u[1].length;var f=document.createTextNode(l);r.parentNode.insertBefore(f,r);var h;h=c?document.createElement("div"):document.createTextNode("");var d=n.args,p=o;if(o.match(/\./)){var v=i.Bindable.resolve(n.args,o,!0),y=e(v,2);d=y[0],p=y[1]}r.parentNode.insertBefore(h,r);var b=d.bindTo(p,function(e,i){return function(o,a,s){s[a]instanceof t&&s[a]!==o&&(s[a].preserve||s[a].remove()),e.nodeValue="",o instanceof t?(o.render(r.parentNode,e),n.cleanup.push(function(){o.preserve||o.remove()})):(o instanceof Object&&o.__toString instanceof Function&&(o=o.__toString()),i?e.innerHTML=o:e.nodeValue=o)}}(h,c));n.cleanup.push(function(){b(),d.isBound()||i.Bindable.clearBindings(d)})};u=o.exec(a);)c();var l=a.substring(s),f=document.createTextNode(l);r.parentNode.insertBefore(f,r),r.nodeValue=""}if(r.nodeType==Node.ELEMENT_NODE)for(var h=function(t){if(!n.interpolatable(r.attributes[t].value))return"continue";for(var a=0,s=void 0,u=r.attributes[t].value,c=r.attributes[t],l={},f=[];s=o.exec(u);)f.push(u.substring(a,s.index)),l[s[2]]||(l[s[2]]=[]),l[s[2]].push(f.length),f.push(s[1]),a=s.index+s[1].length;f.push(u.substring(a));var h=function(t){var o=n.args,a=t;if(t.match(/\./)){var s=i.Bindable.resolve(n.args,t,!0),u=e(s,2);o=u[0],a=u[1]}var h=t,d=o.bindTo(a,function(e,t,n,i){for(var o in l)for(var s in l[h])f[l[h][s]]=n[o],t===a&&(f[l[h][s]]=e);r.setAttribute(c.name,f.join(""))});n.cleanup.push(function(){d(),o.isBound()||i.Bindable.clearBindings(o)})};for(var d in l)h(d)},d=0;d<r.attributes.length;d++)h(d)}},{key:"mapRefTags",value:function(t){var r=t.getAttribute("cv-ref").split(":"),n=e(r,3),i=n[0],o=n[1],a=n[2],s=this.stringToClass(o);t.removeAttribute("cv-ref"),Object.defineProperty(t,"___tag___",{enumerable:!1,writable:!0}),this.cleanup.push(function(){t.___tag___=null,t.remove()});var u=this;this.viewList&&(u=this.viewList.parent);var c=new s(t,this,i,void 0,this);for(t.___tag___=c;u;){u.parent;var l=this.args[a];void 0!==l?(u.tags[i]||(u.tags[i]=[]),u.tags[i][l]=c):u.tags[i]=c,u=u.parent}}},{key:"mapBindTags",value:function(r){var n=this,o=r.getAttribute("cv-bind"),a=this.args,s=o,u=null;if(o.match(/\./)){var c=i.Bindable.resolve(this.args,o,!0),l=e(c,3);a=l[0],s=l[1],u=l[2]}a!==this.args&&(this.subBindings[o]=this.subBindings[o]||[],this.cleanup.push(this.args.bindTo(u,function(){for(;n.subBindings.length;)console.log("HERE!"),n.subBindings.shift()()})));var f=a.bindTo(s,function(e,n,i,o,a){if(a instanceof t&&a!==e&&a.remove(),"INPUT"!=r.tagName&&"SELECT"!=r.tagName&&"TEXTAREA"!=r.tagName)e instanceof t?e.render(r):r.innerText=e;else{var s=r.getAttribute("type");if(s&&"checkbox"==s.toLowerCase())r.checked=!!e;else if(s&&"radio"==s.toLowerCase())r.checked=e==r.value;else if("file"!==s){if("SELECT"==r.tagName)for(var u in r.options)r.options[u].value==e&&(r.selectedIndex=u);r.value=null==e?"":e}}});a!==this.args&&this.subBindings[o].push(f),this.cleanup.push(f);var h=function(e){if(e.target===r){var t=r.getAttribute("type"),n=r.getAttribute("multiple");t&&"checkbox"==t.toLowerCase()?r.checked?a[s]=e.target.value:a[s]=!1:"file"!==t?a[s]=e.target.value:"file"==t&&n&&(a[s]=Array.from(e.target.files))}};r.addEventListener("input",h),r.addEventListener("change",h),r.addEventListener("value-changed",h),this.cleanup.push(function(e,t){return function(){e.removeEventListener("input",h),e.removeEventListener("change",h),e.removeEventListener("value-changed",h),e=void 0}}(r)),r.removeAttribute("cv-bind")}},{key:"mapOnTags",value:function(e){var t,r=this;String(e.getAttribute("cv-on")).split(/;/).map(function(e){return e.split(":")}).map((t=e,function(e){var n=e[0].replace(/(^[\s\n]+|[\s\n]+$)/,""),i=e[1],o=[],a=/(\w+)(?:\(([$\w\s'",]+)\))?/.exec(i);a.length&&(i=a[1].replace(/(^[\s\n]+|[\s\n]+$)/,""),a[2]&&(o=a[2].split(",").map(function(e){return e.trim()})));for(var s=void 0,u=r;u&&("function"!=typeof u[i]||"break"!==function(){var e=u,t=i;return s=function(){e[t].apply(e,arguments)},"break"}());)if(u.viewList&&u.viewList.parent)u=u.viewList.parent;else{if(!u.parent)break;u=u.parent}var c=function(e,t,n,a){return function(e){var s=o.map(function(n){var i=void 0;return parseInt(n)==n?n:"event"===n||"$event"===n?e:"$view"===n?t:"$tag"===n?a:"$parent"===n?r.parent:"$subview"===n?r:n in r.args?r.args[n]:(i=/^['"](\w+?)["']$/.exec(n))?i[1]:void 0});if("function"!=typeof n)throw new Error(i+" is not defined on View object.\n\nTag:\n\n"+a.outerHTML);n.apply(void 0,function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(s))}}(0,u,s,t);switch(n){case"_init":c();break;case"_attach":r.attach.push(c);break;case"_detach":r.detach.push(c);break;default:t.addEventListener(n,c),r.cleanup.push(function(){t.removeEventListener(n,c)})}return[n,i,o]})),e.removeAttribute("cv-on")}},{key:"mapLinkTags",value:function(e){var t=e.getAttribute("cv-link");e.setAttribute("href",t);var r=function(r){r.preventDefault(),"http"!=t.substring(0,4)&&"//"!=t.substring(0,2)?a.Router.go(e.getAttribute("href")):window.open(e.getAttribute("href",t))};e.addEventListener("click",r),this.cleanup.push(function(e,t){return function(){e.removeEventListener("click",t),e=void 0,t=void 0}}(e,r)),e.removeAttribute("cv-link")}},{key:"mapPrendererTags",value:function(e){var t=e.getAttribute("cv-prerender"),r=window.prerenderer;("never"==t&&r||"only"==t&&!r)&&e.parentNode.removeChild(e)}},{key:"mapWithTags",value:function(e){var r=this,n=e.getAttribute("cv-with"),o=e.getAttribute("cv-carry");e.removeAttribute("cv-with"),e.removeAttribute("cv-carry");var a=e.innerHTML,s=[];o&&(s=o.split(",").map(function(e){return e.trim()}));var u=this.args.bindTo(n,function(n,o,u,c){for(r.withViews[o]&&r.withViews[o].remove();e.firstChild;)e.removeChild(e.firstChild);var l=new t;r.cleanup.push(function(e){return function(){e.remove()}}(l)),l.template=a,l.parent=r;var f=function(e){var t=r.args.bindTo(s[e],function(e,t){l.args[t]=e});l.cleanup.push(t),r.cleanup.push(function(){t(),l.remove()})};for(var h in s)f(h);var d=function(e){var t=n.bindTo(e,function(e,t){l.args[t]=e});r.cleanup.push(function(){t(),n.isBound()||i.Bindable.clearBindings(n),l.remove()}),l.cleanup.push(function(){t(),n.isBound()||i.Bindable.clearBindings(n)})};for(var h in n)d(h);l.render(e),r.withViews[o]=l});this.cleanup.push(u)}},{key:"mapEachTags",value:function(r){var n=this,i=r.getAttribute("cv-each");r.removeAttribute("cv-each");for(var a=r.innerHTML;r.firstChild;)r.removeChild(r.firstChild);var s=i.split(":"),u=e(s,3),c=u[0],l=u[1],f=u[2],h=this.args.bindTo(c,function(e,i,s,u,h){n.viewLists[c]&&n.viewLists[c].remove();var d=new o.ViewList(a,l,e,n,f);n.cleanup.push(function(){d.remove()});var p=n.args.bindTo(function(e,t,r,n){"_id"!=t&&d.args.subArgs[t]!==e&&(d.args.subArgs[t]=e)});for(var v in n.args)"_id"!=v&&(d.args.subArgs[i]=n.args[v]);var y=d.args.bindTo(function(e,r,i,o,a){if("_id"!=r&&"___"!==r.substring(0,3)){var s=e,u=a;e instanceof t&&(s=e.___ref___),a instanceof t&&(u=a.___ref___),s!==u&&i[r]instanceof t&&i[r].remove(),r in n.args&&s!==u&&(n.args[r]=e)}},{wait:0});for(n.cleanup.push(function(){p(),y()});r.firstChild;)r.removeChild(r.firstChild);n.viewLists[c]=d,d.render(r)});this.cleanup.push(function(){h()})}},{key:"mapIfTags",value:function(r){var n=r.getAttribute("cv-if");r.removeAttribute("cv-if");var o=r.innerHTML,a=!1;for("!"===n.substr(0,1)&&(a=!0,n=n.substr(1));r.firstChild;)r.removeChild(r.firstChild);var s=document.createRange().createContextualFragment(""),u=new t;u.template=o,u.parent=this;for(var c=this.syncBind(u),l=this;l.parent;)l=l.parent;this.cleanup.push(function(){c()}),u.render(r);var f=this.args,h=n;if(n.match(/\./)){var d=i.Bindable.resolve(this.args,n,!0),p=e(d,2);f=p[0],h=p[1]}var v=f.bindTo(h,function(e,t){if(Array.isArray(e)&&(e=!!e.length),a&&(e=!e),e)u.render(r);else{for(;r.firstChild;)r.firstChild.remove();u.render(s)}});this.cleanup.push(function(){v(),f.isBound()||i.Bindable.clearBindings(f)})}},{key:"syncBind",value:function(e){var r=this,n=this.args.bindTo(function(t,r,n,i){"_id"!=r&&e.args[r]!==t&&(e.args[r]=t)});for(var i in this.args)"_id"!=i&&(e.args[i]=this.args[i]);var o=e.args.bindTo(function(e,n,i,o,a){if("_id"!=n){var s=e,u=a;e instanceof t&&(s=e.___ref___),a instanceof t&&(u=a.___ref___),s!==u&&a instanceof t&&a.remove(),n in r.args&&s!==u&&(r.args[n]=e)}},{wait:0});return function(){n(),o()}}},{key:"postRender",value:function(e){}},{key:"interpolatable",value:function(e){return!!String(e).match(this.interpolateRegex)}},{key:"uuid",value:function(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)})}},{key:"remove",value:function(){var e=new Event("cvDomDetached");for(var t in this.tags)if(Array.isArray(this.tags[t]))for(var r in this.tags[t])this.tags[t][r].remove();else this.tags[t].remove();for(var n in this.nodes)this.nodes[n].dispatchEvent(e),this.nodes[n].remove();for(var i=void 0;i=this.cleanup.shift();)i();for(var o in this.viewLists)this.viewLists[o]&&this.viewLists[o].remove();for(var a in this.viewLists=[],this.timeouts)clearInterval(this.timeouts[a].timeout),delete this.timeouts[a];for(var s in this.intervals)clearInterval(this.intervals[s].timeout),delete this.intervals[s];this.removed=!0}},{key:"findTag",value:function(e){for(var t in this.nodes){var r;if(this.nodes[t].querySelector){if(this.nodes[t].matches(e))return this.nodes[t];if(r=this.nodes[t].querySelector(e))return r}}}},{key:"update",value:function(){}},{key:"beforeUpdate",value:function(e){}},{key:"afterUpdate",value:function(e){}},{key:"stringToClass",value:function(e){var t=e.split("/"),n=t[t.length-1];return r(e)[n]}}],[{key:"isView",value:function(){return t}}]),t}()}()}),require.register("curvature/base/ViewList.js",function(t,r,n){r=e(r,{},"curvature"),function(){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ViewList=void 0;var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r("./Bindable"),o=r("./View");var a=function(){function t(e,r,n,o){var a=this,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,t),this.args=i.Bindable.makeBindable({}),this.args.value=i.Bindable.makeBindable(n||{}),this.args.subArgs=i.Bindable.makeBindable({}),this.views=[],this.cleanup=[],this.template=e,this.subProperty=r,this.keyProperty=s,this.tag=null,this.paused=!1,this.parent=o,this.args.value.___before___.push(function(e){"bindTo"!=e.___executing___&&(a.paused=!0)}),this.args.value.___after___.push(function(e){"bindTo"!=e.___executing___&&(a.paused=e.___stack___.length>1,a.reRender())});var u=this.args.value.bindTo(function(e,t,r,n){if(!a.paused)if(n)for(var i in a.views[t]&&a.views[t].remove(),a.views.splice(t,1),a.views)a.views[i].args[a.keyProperty]=i;else a.views[t]||a.reRender()},{wait:0});this.cleanup.push(u)}return n(t,[{key:"render",value:function(e){for(var t in this.views)this.views[t].render(e);this.tag=e}},{key:"reRender",value:function(){var t=this;if(!this.paused&&this.tag){var r=[];for(var n in this.views)r[n]=this.views[n];var i=[];for(var a in this.args.value){var s=!1;for(var u in r)if(r[u]&&this.args.value[a]&&"object"==e(this.args.value[a])&&this.args.value[a]===r[u].args[this.subProperty]){s=!0,i[a]=r[u],i[a].args[this.keyProperty]=a,delete r[u];break}s||function(){var e={};i[a]=new o.View(e),i[a].template=t.template,i[a].parent=t.parent,i[a].viewList=t,i[a].args[t.keyProperty]=a,i[a].args[t.subProperty]=t.args.value[a],t.cleanup.push(t.args.value.bindTo(a,function(e,t,r){})),t.cleanup.push(e.bindTo(t.subProperty,function(r,n){var i=e[t.keyProperty];t.args.value[i]=r})),t.cleanup.push(t.args.subArgs.bindTo(function(t,r,n,i){e[r]=t})),e[t.subProperty]=t.args.value[a]}()}for(var c in r){var l=!1;for(var f in i)if(r[c]===i[f]){l=!0;break}l||r[c].remove()}for(var h in this.views)this.views[h],i[h];for(var d in i)i[d]!==this.views[d]&&(r.splice(d+1,0,i[d]),i[d].render(this.tag));for(var p in i)i[p].args[this.keyProperty]=p;this.views=i}}},{key:"pause",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];for(var t in this.views)this.views[t].pause(e)}},{key:"remove",value:function(){for(var e in this.views)this.views[e].remove();for(;this.cleanup.length;)this.cleanup.pop()();for(this.views=[];this.tag&&this.tag.firstChild;)this.tag.removeChild(this.tag.firstChild);i.Bindable.clearBindings(this.args.subArgs),i.Bindable.clearBindings(this.args),this.args.value.isBound()||i.Bindable.clearBindings(this.args.value)}}]),t}();t.ViewList=a}()}),require.register("curvature/input/Keyboard.js",function(t,r,n){r=e(r,{},"curvature"),function(){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Keyboard=void 0;var e=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),n=r("../base/Bindable");t.Keyboard=function(){function t(){var e=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.maxDecay=120,this.listening=!0,this.keys=n.Bindable.makeBindable({}),this.codes=n.Bindable.makeBindable({}),document.addEventListener("keyup",function(t){e.keys[t.key]=-1,e.codes[t.code]=-1}),document.addEventListener("keydown",function(t){e.keys[t.key]>0||(e.keys[t.key]=1,e.codes[t.code]=1)}),window.addEventListener("blur",function(t){for(var r in e.keys)e.keys[r]=-1;for(var n in e.codes)e.codes[n]=-1})}return e(t,[{key:"getKey",value:function(e){return this.keys[e]?this.keys[e]:0}},{key:"getKeyCode",value:function(e){return this.codes[e]?this.codes[e]:0}},{key:"update",value:function(){for(var e in this.keys)this.keys[e]>0?this.keys[e]++:(this.keys[e]--,this.keys[e]<-this.maxDecay&&delete this.keys[e]);for(var e in this.codes)this.codes[e]>0?this.codes[e]++:(this.codes[e]--,this.codes[e]<-this.maxDecay&&delete this.keys[e])}}]),t}()}()}),require.register("Config.js",function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(e,"__esModule",{value:!0}),e.Config=void 0;var i=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)});e.Config=i,i.title="wgl2d"}),require.register("gl2d/Gl2d.js",function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Gl2d=void 0,t("curvature/base/Bindable");var i=t("../inject/Injectable");function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=l(e);if(t){var i=l(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return u(this,r)}}function u(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return c(e)}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}(l,i.Injectable);var r,n,u=s(l);function l(e){var t;return function(e,t){if(!(e instanceof l))throw new TypeError("Cannot call a class as a function")}(this),t=u.call(this),new(i.Injectable.inject({Gl2d:c(t)})),t.element=e,t.context=t.element.getContext("webgl"),t.zoomLevel=1,t}return r=l,(n=[{key:"resize",value:function(e,t){e=(e||this.element.width)/this.zoomLevel,t=(t||this.element.height)/this.zoomLevel,this.context.viewport(0,0,e,t)}},{key:"draw",value:function(){var e=this.context;e.useProgram(this.program),e.bindFramebuffer(e.FRAMEBUFFER,null),e.viewport(0,0,e.canvas.width,e.canvas.height),e.clearColor(0,0,0,0),e.clearColor(1,1,1,1),e.clear(e.COLOR_BUFFER_BIT)}},{key:"cleanup",value:function(){this.context.deleteProgram(this.program)}},{key:"createShader",value:function(e){var r=null;switch(e.substring(e.lastIndexOf(".")+1).toUpperCase()){case"VERT":r=this.context.VERTEX_SHADER;break;case"FRAG":r=this.context.FRAGMENT_SHADER}var n=this.context.createShader(r),i=t(e);if(this.context.shaderSource(n,i),this.context.compileShader(n),this.context.getShaderParameter(n,this.context.COMPILE_STATUS))return n;console.error(this.context.getShaderInfoLog(n)),this.context.deleteShader(n)}},{key:"createProgram",value:function(e,t){var r=this.context.createProgram();return this.context.attachShader(r,e),this.context.attachShader(r,t),this.context.linkProgram(r),this.context.detachShader(r,e),this.context.detachShader(r,t),this.context.deleteShader(e),this.context.deleteShader(t),this.context.getProgramParameter(r,this.context.LINK_STATUS)||(console.error(this.context.getProgramInfoLog(r)),this.context.deleteProgram(r)),r}}])&&o(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),l}();e.Gl2d=f}),require.register("home/View.js",function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.View=void 0;var i=t("Config"),o=t("curvature/base/Bag"),a=t("curvature/base/View"),s=t("../world/Map"),u=t("../sprite/SpriteSheet"),c=t("../sprite/SpriteBoard"),l=t("../ui/Controller"),f=t("../ui/MapEditor"),h=t("curvature/input/Keyboard"),d=t("../model/Entity"),p=t("../inject/Injectable");function v(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=g(e);if(t){var i=g(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return m(this,r)}}function m(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}(m,e);var r,n,a=b(m);function m(e){var r;!function(e,t){if(!(e instanceof m))throw new TypeError("Cannot call a class as a function")}(this),(r=a.call(this,e)).template=t("./view.tmp"),r.routes=[],r.entities=new o.Bag,r.keyboard=new h.Keyboard,r.speed=8,r.maxSpeed=r.speed;var n=new(p.Injectable.inject({OnScreenJoyPad:l.Controller}));return r.args.controller=n.OnScreenJoyPad,r.args.fps=0,r.args.sps=0,r.args.camX=0,r.args.camY=0,r.args.frameLock=60,r.args.simulationLock=60,r.args.showEditor=!1,r.keyboard.keys.bindTo("`",function(e,t,r,n){-1===e&&console.log(t)}),r.keyboard.keys.bindTo("e",function(e,t,n,i){e>0&&r.map.export()}),r.keyboard.keys.bindTo("Escape",function(e,t,n,i){-1===e&&r.spriteBoard.unselect()}),r.keyboard.keys.bindTo("Home",function(e,t,n,i){e>0&&r.args.frameLock++}),r.keyboard.keys.bindTo("End",function(e,t,n,i){e>0&&(r.args.frameLock--,r.args.frameLock<0&&(r.args.frameLock=0))}),r.keyboard.keys.bindTo("PageUp",function(e,t,n,i){e>0&&r.args.simulationLock++}),r.keyboard.keys.bindTo("PageDown",function(e,t,n,i){e>0&&(r.args.simulationLock--,r.args.simulationLock<0&&(r.args.simulationLock=0))}),r.spriteSheet=new u.SpriteSheet,r.map=new s.Map,r.map.import(),r.args.mapEditor=new f.MapEditor({spriteSheet:r.spriteSheet,map:r.map}),r}return r=m,(n=[{key:"postRender",value:function(){var e=this;this.spriteBoard=new c.SpriteBoard(this.tags.canvas.element,this.map);var t=new d.Entity;this.entities.add(t),this.spriteBoard.sprites.add(t.sprite),this.keyboard.keys.bindTo("=",function(t,r,n,i){t>0&&e.zoom(1)}),this.keyboard.keys.bindTo("+",function(t,r,n,i){t>0&&e.zoom(1)}),this.keyboard.keys.bindTo("-",function(t,r,n,i){t>0&&e.zoom(-1)}),this.args.mapEditor.args.bindTo("selectedGraphic",function(t){if(t&&null!=e.spriteBoard.selected.globalX){e.args.showEditor=!1;var r=e.spriteBoard.selected.startGlobalX,n=e.spriteBoard.selected.globalX;if(n<r){var i=[r,n];n=i[0],r=i[1]}for(;r<=n;r++){var o=e.spriteBoard.selected.startGlobalY,a=e.spriteBoard.selected.globalY;if(a<o){var s=[o,a];a=s[0],o=s[1]}for(;o<=a;o++)e.map.setTile(r,o,t)}e.map.setTile(e.spriteBoard.selected.globalX,e.spriteBoard.selected.globalY,t),e.spriteBoard.resize(),e.spriteBoard.unselect()}}),this.spriteBoard.selected.bindTo(function(t,r,n,i,o){null!=e.spriteBoard.selected.localX?(e.args.mapEditor.select(e.spriteBoard.selected),e.args.showEditor=!0,e.spriteBoard.resize()):e.args.showEditor=!1},{wait:0}),this.args.showEditor=!0,window.addEventListener("resize",function(){e.resize(),s()});var r=0,n=0,o=[],a=[],s=function t(n){var i=(n/=1e3)-r;if(i<1/(e.args.frameLock+e.args.frameLock/60*10))window.requestAnimationFrame(t);else{if(r=n,0==e.args.frameLock)return window.requestAnimationFrame(t),void(o=[0]);for(e.spriteBoard.draw(),window.requestAnimationFrame(t),o.push(e.args._fps);o.length>5;)o.shift();e.args._fps=1/i,e.args.camX=e.spriteBoard.Camera.x,e.args.camY=e.spriteBoard.Camera.y}};this.resize(),setInterval(function(){!function(t){var r=(t/=1e3)-n;if(0!=e.args.simulationLock){if(!(r<1/(e.args.simulationLock+e.args.simulationLock/60*10)))for(n=t,e.keyboard.update(),Object.values(e.entities.items()).map(function(e){e.simulate()}),e.args._sps=1/r,a.push(e.args._sps);a.length>5;)a.shift()}else a=[0]}(performance.now())},0),setInterval(function(){var t=o.reduce(function(e,t){return e+t},0)/o.length;e.args.fps=t.toFixed(3).padStart(5," ")},227),setInterval(function(){document.title="".concat(i.Config.title," ").concat(e.args.fps," FPS")},227/3),setInterval(function(){var t=a.reduce(function(e,t){return e+t},0)/a.length;e.args.sps=t.toFixed(3).padStart(5," ")},115.5),window.requestAnimationFrame(s)}},{key:"resize",value:function(e,t){this.args.width=this.tags.canvas.element.width=e||document.body.clientWidth,this.args.height=this.tags.canvas.element.height=t||document.body.clientHeight,this.args.rwidth=Math.floor((e||document.body.clientWidth)/this.spriteBoard.zoomLevel),this.args.rheight=Math.floor((t||document.body.clientHeight)/this.spriteBoard.zoomLevel),this.spriteBoard.resize()}},{key:"scroll",value:function(e){var t=e.deltaY>0?-1:e.deltaY<0?1:0;this.zoom(t)}},{key:"zoom",value:function(e){e>0||e<0&&this.spriteBoard.zoomLevel>.35?(this.spriteBoard.zoomLevel+=.05*e,this.resize()):(this.spriteBoard.zoomLevel=.35,this.resize())}}])&&v(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),m}(a.View);e.View=_}),require.register("home/view.tmp.html",function(e,t,r){r.exports='<canvas\n\tcv-ref = "canvas:curvature/base/Tag"\n\tcv-on  = "wheel:scroll(event);"\n></canvas>\n<div class = "hud fps">\n [[sps]] simulations/s / [[simulationLock]] \n [[fps]] frames/s      / [[frameLock]] \n\n Res [[rwidth]] x [[rheight]]\n     [[width]] x [[height]]\n \n Pos [[camX]] x [[camY]]\n\n  Sim:   Pg Up / Dn\n  Frame: Home / End \n  Scale: + / - \n\n</div>\n<div class = "reticle"></div>\n\n[[controller]]\n\n<div cv-if = "showEditor">\n\t[[mapEditor]]\n\t--\n\t[[mmm]]\n</span>\n'}),require.register("initialize.js",function(e,t,r){"use strict";var n=t("curvature/base/Tag"),i=t("curvature/base/Router"),o=t("home/View");t("inject/Single"),void 0!==Proxy&&document.addEventListener("DOMContentLoaded",function(){var e=new o.View,r=new n.Tag(document.querySelector("body"));r.clear(),e.render(r.element),i.Router.listen(e),t("initialize")})}),require.register("inject/Container.js",function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=u(e);if(t){var i=u(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return s(this,r)}}function s(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Container=void 0;var c=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&o(e,t)}(s,e);var t,r,n=a(s);function s(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),n.apply(this,arguments)}return t=s,(r=[{key:"inject",value:function(e){return new this.constructor(Object.assign({},this,e))}}])&&i(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),s}(t("./Injectable").Injectable);e.Container=c}),require.register("inject/Injectable.js",function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&o(e,t)}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=u(e);if(t){var i=u(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return s(this,r)}}function s(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t,r){return t&&l(e.prototype,t),r&&l(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}Object.defineProperty(e,"__esModule",{value:!0}),e.Injectable=void 0;var h={},d={},p=function(){function e(){c(this,e);var t=this.constructor.injections(),r=this.constructor.context();for(var n in h[r]||(h[r]={}),d[r]||(d[r]={}),t){var i=t[n];!h[r][n]&&i.prototype&&/[A-Z]/.test(String(n)[0])&&(h[r][n]=i)}for(var o in t){var a=void 0,s=h[r][o]||t[o];/[A-Z]/.test(String(o)[0])?(s.prototype?d[r][o]||(d[r][o]=new s):d[r][o]=s,a=d[r][o]):a=s.prototype?new s:s,Object.defineProperty(this,o,{enumerable:!1,writable:!1,value:a})}}return f(e,null,[{key:"injections",value:function(){return{}}},{key:"context",value:function(){return"."}},{key:"inject",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:".";if(!(this.prototype instanceof e||this===e))throw new Error("Cannot access injectable subclass!\n\nAre you trying to instantiate like this?\n\n\tnew X.inject({...});\n\nIf so please try:\n\n\tnew (X.inject({...}));\n\nPlease note the parenthesis.\n");var n=this.injections();return function(e){i(s,e);var o=a(s);function s(){return c(this,s),o.apply(this,arguments)}return f(s,null,[{key:"injections",value:function(){return Object.assign({},n,t)}},{key:"context",value:function(){return r}}]),s}(this)}}]),e}();e.Injectable=p}),require.register("inject/Single.js",function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(e,"__esModule",{value:!0}),e.single=e.Single=void 0;var i=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name="sss."+Math.random()});e.Single=i;var o=new i;e.single=o}),require.register("model/Controller.js",function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Controller=void 0;var i=t("curvature/base/Bindable"),o=t("../inject/Injectable"),a=t("curvature/input/Keyboard"),s=t("../ui/Controller");function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(i,e);var t,r,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=f(e);if(t){var i=f(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return l(this,r)}}(i);function i(){var e;return function(e,t){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(e=n.call(this)).Keyboard.keys.bindTo(function(t,r,n,i){t>0?e.keyPress(r,t,n[r]):e.keyRelease(r,t,n[r])}),e.OnScreenJoyPad.args.bindTo("x",function(t){e.axis[0]=t/50}),e.OnScreenJoyPad.args.bindTo("y",function(t){e.axis[1]=t/50}),e}return t=i,(r=[{key:"keyPress",value:function(e,t,r){if(/^[0-9]$/.test(e))this.triggers[e]=!0;else switch(e){case"ArrowRight":this.axis[0]=1;break;case"ArrowDown":this.axis[1]=1;break;case"ArrowLeft":this.axis[0]=-1;break;case"ArrowUp":this.axis[1]=-1}}},{key:"keyRelease",value:function(e,t,r){if(/^[0-9]$/.test(e))this.triggers[e]=!1;else switch(e){case"ArrowRight":case"ArrowLeft":this.axis[0]=0;break;case"ArrowDown":case"ArrowUp":this.axis[1]=0}}}])&&u(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(o.Injectable.inject({Keyboard:a.Keyboard,OnScreenJoyPad:s.Controller,triggers:i.Bindable.makeBindable({}),axis:i.Bindable.makeBindable({})}));e.Controller=h}),require.register("model/Entity.js",function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Entity=void 0;var i=t("../inject/Injectable"),o=t("../sprite/Sprite"),a=t("./Controller"),s=t("../sprite/Camera");function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(i,e);var t,r,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=f(e);if(t){var i=f(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return l(this,r)}}(i);function i(){var e;return function(e,t){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(e=n.call(this)).direction="south",e.state="standing",e}return t=i,(r=[{key:"create",value:function(){}},{key:"simulate",value:function(){var e=this.Controller.axis[0]||0,t=this.Controller.axis[1]||0;for(var r in this.Controller.triggers)this.Controller.triggers[r]&&console.log(r);e>1&&(e=1),t>1&&(t=1),this.sprite.x+=e>0?Math.ceil(4*e):Math.floor(4*e),this.sprite.y+=t>0?Math.ceil(4*t):Math.floor(4*t),this.Camera.x=this.sprite.x,this.Camera.y=this.sprite.y;var n,i=!1;Math.abs(e)>Math.abs(t)&&(i=!0),i?(this.direction="west",e>0&&(this.direction="east"),this.state="walking"):t?(this.direction="north",t>0&&(this.direction="south"),this.state="walking"):this.state="standing",(n=this.sprite[this.state][this.direction])&&this.sprite.setFrames(n)}},{key:"destroy",value:function(){}}])&&u(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(i.Injectable.inject({sprite:o.Sprite,Controller:a.Controller,Camera:s.Camera}));e.Entity=h}),require.register("overlay/overlay.frag",function(e,t,r){r.exports="precision mediump float;\n\nuniform vec4      u_color;\nvarying vec2      v_texCoord;\n\nvoid main() {\n   // gl_FragColor = texture2D(u_image, v_texCoord);\n   gl_FragColor = vec4(1.0, 1.0, 0.0, 0.25);\n}\n"}),require.register("overlay/overlay.vert",function(e,t,r){r.exports="attribute vec2 a_position;\nattribute vec2 a_texCoord;\n\nuniform   vec2 u_resolution;\n\nvarying   vec2 v_texCoord;\n\nvoid main()\n{\n   vec2 zeroToOne = a_position / u_resolution;\n   vec2 zeroToTwo = zeroToOne * 2.0;\n   vec2 clipSpace = zeroToTwo - 1.0;\n\n   gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);\n   v_texCoord  = a_texCoord;\n}\n"}),require.register("sprite/Background.js",function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Background=void 0;var i=t("curvature/base/Bindable"),o=t("../gl2d/Gl2d"),a=t("../inject/Injectable"),s=t("./Surface"),u=t("./Camera"),c=t("./SpriteSheet");function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return d(e)}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(o,e);var t,r,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=p(e);if(t){var i=p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return h(this,r)}}(o);function o(e,t){var r,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r=n.call(this),i.Bindable.makeBindable(d(r)),r.panes=[],r.panesXY={},r.maxPanes=9,r.surfaceX=5,r.surfaceY=5,r.spriteSheet=new c.SpriteSheet,r.tileWidth=32,r.tileHeight=32,r.map=t,r.layer=a,r}return t=o,(r=[{key:"renderPane",value:function(e,t,r){var n,i=this.Gl2d,o=e*(this.tileWidth*this.surfaceX),a=t*(this.tileHeight*this.surfaceY);this.panesXY[o]&&this.panesXY[o][a]?n=this.panesXY[o][a]:(n=new s.Surface(i,this.map,this.surfaceX,this.surfaceY,o,a,this.layer),this.panesXY[o]||(this.panesXY[o]={}),this.panesXY[o][a]||(this.panesXY[o][a]=n)),this.panes.unshift(n),this.panes.length>this.maxPanes&&this.panes.pop()}},{key:"draw",value:function(){var e=Math.floor(this.Camera.x/(this.surfaceX*this.tileWidth)),t=Math.floor(this.Camera.y/(this.surfaceY*this.tileHeight)),r=[-1,0,1];for(var n in r)for(var i in r)this.renderPane(e+r[n],t+r[i]);this.panes.map(function(e){e.draw()})}},{key:"resize",value:function(e,t){for(var r in this.panesXY)for(var n in this.panesXY[r])delete this.panesXY[r][n];for(;this.panes.length;)this.panes.pop();this.surfaceX=Math.ceil(e/this.tileWidth),this.surfaceY=Math.ceil(t/this.tileHeight),this.draw()}},{key:"simulate",value:function(){}}])&&l(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(a.Injectable.inject({Gl2d:o.Gl2d,Camera:u.Camera}));e.Background=v}),require.register("sprite/Camera.js",function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(e,"__esModule",{value:!0}),e.Camera=void 0;var i=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.x=0,this.y=0,this.width=0,this.height=0});e.Camera=i}),require.register("sprite/Sprite.js",function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Sprite=void 0,t("curvature/base/Bindable"),t("curvature/input/Keyboard");var i=t("./SpriteSheet"),o=t("../gl2d/Gl2d"),a=t("../inject/Injectable"),s=t("./Camera");function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(o,e);var t,r,n,i=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=f(e);if(t){var i=f(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return l(this,r)}}(o);function o(e){var t;!function(e,t){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}(this),(t=i.call(this)).z=0,t.x=0,t.y=0,t.width=0,t.height=0,t.scale=1,t.frames=[],t.frameDelay=4,t.currentDelay=t.frameDelay,t.currentFrame=0,t.currentFrames="",t.speed=0,t.maxSpeed=8,t.moving=!1,t.RIGHT=0,t.DOWN=1,t.LEFT=2,t.UP=3,t.director=t.UP,t.EAST=t.RIGHT,t.SOUTH=t.DOWN,t.WEST=t.LEFT,t.NORTH=t.UP,t.standing={north:["player_standing_north.png"],south:["player_standing_south.png"],west:["player_standing_west.png"],east:["player_standing_east.png"]},t.walking={north:["player_walking_north.png","player_walking_north.png","player_standing_north.png","player_walking_north2.png","player_walking_north2.png","player_standing_north.png"],south:["player_walking_south.png","player_walking_south.png","player_standing_south.png","player_walking_south2.png","player_walking_south2.png","player_standing_south.png"],west:["player_walking_west.png","player_walking_west.png","player_standing_west.png","player_standing_west.png","player_walking_west2.png","player_walking_west2.png","player_standing_west.png","player_standing_west.png"],east:["player_walking_east.png","player_walking_east.png","player_standing_east.png","player_standing_east.png","player_walking_east2.png","player_walking_east2.png","player_standing_east.png","player_standing_east.png"]};var r=t.Gl2d.context;t.texture=r.createTexture(),r.bindTexture(r.TEXTURE_2D,t.texture);var n=function(){return parseInt(255*Math.random())};return r.texImage2D(r.TEXTURE_2D,0,r.RGBA,1,1,0,r.RGBA,r.UNSIGNED_BYTE,new Uint8Array([n(),n(),0,255])),t.SpriteSheet.ready.then(function(r){var n=t.SpriteSheet.getFrame(e);n&&o.loadTexture(t.Gl2d,t.SpriteSheet,n).then(function(e){t.texture=e.texture,t.width=e.image.width*t.scale,t.height=e.image.height*t.scale})}),t}return t=o,n=[{key:"loadTexture",value:function(e,t,r){var n=e.context;return this.promises||(this.promises={}),this.promises[r]||(console.log(r),this.promises[r]=o.loadImage(r).then(function(e){var t=n.createTexture();return n.bindTexture(n.TEXTURE_2D,t),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,e),{image:e,texture:t}})),this.promises[r]}},{key:"loadImage",value:function(e){return new Promise(function(t,r){var n=new Image;n.src=e,n.addEventListener("load",function(e){t(n)})})}}],(r=[{key:"draw",value:function(){this.frameDelay=1.5*this.maxSpeed-Math.abs(this.speed),this.frameDelay>this.maxSpeed&&(this.frameDelay=this.maxSpeed),this.currentDelay<=0?(this.currentDelay=this.frameDelay,this.currentFrame++):this.currentDelay--,this.currentFrame>=this.frames.length&&(this.currentFrame=this.currentFrame-this.frames.length);var e=this.frames[this.currentFrame];e&&(this.texture=e.texture,this.width=e.width*this.scale,this.height=e.height*this.scale);var t=this.Gl2d.context;t.bindFramebuffer(t.FRAMEBUFFER,null),t.useProgram(this.Gl2d.program),t.enableVertexAttribArray(this.Gl2d.positionLocation),t.bindTexture(t.TEXTURE_2D,this.texture),t.enableVertexAttribArray(this.Gl2d.texCoordLocation),t.bindBuffer(t.ARRAY_BUFFER,this.Gl2d.texCoordBuffer),t.vertexAttribPointer(this.Gl2d.texCoordLocation,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,this.Gl2d.texCoordBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),t.STREAM_DRAW),this.setRectangle(this.x-(this.Camera.x-this.Camera.width/2)-16*this.scale,this.y-(this.Camera.y-this.Camera.height/2)-this.height/2-16*this.scale,this.width,this.height),t.uniform4f(this.Gl2d.colorLocation,1,0,0,1),t.drawArrays(t.TRIANGLES,0,6)}},{key:"setFrames",value:function(e){var t=this,r=e.join(" ");this.currentFrames!==r&&(this.currentFrames=r,this.SpriteSheet.ready.then(function(r){var n=r.getFrames(e).map(function(e){return o.loadTexture(t.Gl2d,t.SpriteSheet,e).then(function(e){return{texture:e.texture,width:e.image.width,height:e.image.height}})});Promise.all(n).then(function(e){t.frames=e})}))}},{key:"setRectangle",value:function(e,t,r,n){var i=this.Gl2d.context;i.bindBuffer(i.ARRAY_BUFFER,this.Gl2d.positionBuffer),i.vertexAttribPointer(this.Gl2d.positionLocation,2,i.FLOAT,!1,0,0);var o=e,a=e+r,s=t,u=t+n;i.bufferData(i.ARRAY_BUFFER,new Float32Array([o,s,a,s,o,u,o,u,a,s,a,u]),i.STREAM_DRAW)}}])&&u(t.prototype,r),n&&u(t,n),Object.defineProperty(t,"prototype",{writable:!1}),o}(a.Injectable.inject({Gl2d:o.Gl2d,Camera:s.Camera,SpriteSheet:i.SpriteSheet}));e.Sprite=h}),require.register("sprite/SpriteBoard.js",function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.SpriteBoard=void 0;var i=t("curvature/base/Bag"),o=t("curvature/base/Bindable"),a=t("./Sprite"),s=(t("./SpriteSheet"),t("../model/Entity"),t("./Background")),u=t("../inject/Injectable"),c=t("../gl2d/Gl2d"),l=t("./Camera");function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function h(){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=y(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}}).apply(this,arguments)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return v(e)}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(c,e);var t,r,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=y(e);if(t){var i=y(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return p(this,r)}}(c);function c(e,t){var r;!function(e,t){if(!(e instanceof c))throw new TypeError("Cannot call a class as a function")}(this),(r=n.call(this,e)).map=t,new(u.Injectable.inject({Gl2d:v(r)})),r.mouse={x:null,y:null,clickX:null,clickY:null},r.sprites=new i.Bag,r.Camera.width=r.element.width,r.Camera.height=r.element.height;var l=r.context;l.blendFunc(l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA),l.enable(l.BLEND),r.program=r.createProgram(r.createShader("sprite/texture.vert"),r.createShader("sprite/texture.frag")),r.overlayProgram=r.createProgram(r.createShader("overlay/overlay.vert"),r.createShader("overlay/overlay.frag")),r.positionLocation=l.getAttribLocation(r.program,"a_position"),r.texCoordLocation=l.getAttribLocation(r.program,"a_texCoord"),r.resolutionLocation=l.getUniformLocation(r.program,"u_resolution"),r.colorLocation=l.getUniformLocation(r.program,"u_color"),r.overlayPosition=l.getAttribLocation(r.overlayProgram,"a_position"),r.overlayResolution=l.getUniformLocation(r.overlayProgram,"u_resolution"),r.overlayColor=l.getUniformLocation(r.overlayProgram,"u_color"),r.positionBuffer=l.createBuffer(),r.texCoordBuffer=l.createBuffer(),l.bindBuffer(l.ARRAY_BUFFER,r.texCoordBuffer),l.bufferData(l.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),l.STATIC_DRAW),l.viewport(0,0,l.canvas.width,l.canvas.height),document.addEventListener("mousemove",function(e){r.mouse.x=e.clientX,r.mouse.y=e.clientY}),r.selected={localX:null,localY:null,globalX:null,globalY:null,startGlobalX:null,startGlobalY:null},r.selected=o.Bindable.makeBindable(r.selected);var f=!1;r.element.addEventListener("mousedown",function(e){var t=32*r.zoomLevel;if(r.unselect())f=!1;else{f=!0,r.mouse.clickX=e.clientX,r.mouse.clickY=e.clientY;var n=Math.floor((r.mouse.clickX+r.Camera.x%t-Math.floor(r.element.width/2)%t+16*r.zoomLevel)/t),i=Math.floor((r.mouse.clickY+r.Camera.y%t-Math.floor(r.element.height/2)%t+16*r.zoomLevel)/t);r.selected.startLocalX=n,r.selected.startLocalY=i,r.selected.startGlobalX=r.selected.startLocalX-Math.floor(Math.floor(r.element.width/2)/t)+(r.Camera.x<0?Math.ceil(r.Camera.x*r.zoomLevel/t):Math.floor(r.Camera.x*r.zoomLevel/t)),r.selected.startGlobalY=r.selected.startLocalY-Math.floor(Math.floor(r.element.height/2)/t)+(r.Camera.y<0?Math.ceil(r.Camera.y*r.zoomLevel/t):Math.floor(r.Camera.y*r.zoomLevel/t))}}),r.element.addEventListener("mouseup",function(e){var t=32*r.zoomLevel;if(f){console.log(e.clientX,e.clientY),r.mouse.clickX=e.clientX,r.mouse.clickY=e.clientY;var n=Math.floor((r.mouse.clickX+r.Camera.x%t-Math.floor(r.element.width/2)%t+16*r.zoomLevel)/t),i=Math.floor((r.mouse.clickY+r.Camera.y%t-Math.floor(r.element.height/2)%t+16*r.zoomLevel)/t);console.log(n,i);var o=n-Math.floor(Math.floor(r.element.width/2)/t)+(r.Camera.x<0?Math.ceil(r.Camera.x*r.zoomLevel/t):Math.floor(r.Camera.x*r.zoomLevel/t)),a=i-Math.floor(Math.floor(r.element.height/2)/t)+(r.Camera.y<0?Math.ceil(r.Camera.y*r.zoomLevel/t):Math.floor(r.Camera.y*r.zoomLevel/t));r.selected.localX=n,r.selected.globalX=o,r.selected.localY=i,r.selected.globalY=a,f=!1}else f=!1}),r.background=new s.Background(v(r),t),r.background1=new s.Background(v(r),t,1);var h=new a.Sprite("barrel.png");return h.x=32,h.y=32,r.sprites.add(r.background),r.sprites.add(r.background1),r.sprites.add(h),r}return t=c,(r=[{key:"unselect",value:function(){return null!==this.selected.localX&&(this.selected.localX=null,this.selected.localY=null,this.selected.globalX=null,this.selected.globalY=null,!0)}},{key:"draw",value:function(){var e=this.context;h(y(c.prototype),"draw",this).call(this),e.uniform2f(this.resolutionLocation,this.Camera.width,this.Camera.height);var t=this.sprites.items();if(t.map(function(e){e.z=e.y}),t.sort(function(e,t){return e instanceof s.Background&&!(t instanceof s.Background)?-1:t instanceof s.Background&&!(e instanceof s.Background)?1:void 0===e.z?-1:void 0===t.z?1:e.z-t.z}),t.map(function(e){return e.draw()}),null!==this.selected.localX){e.useProgram(this.overlayProgram),e.uniform2f(this.overlayResolution,e.canvas.width,e.canvas.height);var r=this.selected.startGlobalX,n=this.selected.globalX;this.selected.globalX<r&&(r=this.selected.globalX,n=this.selected.startGlobalX);var i=this.selected.startGlobalY,o=this.selected.globalY;this.selected.globalY<i&&(i=this.selected.globalY,o=this.selected.startGlobalY),n+=1,o+=1;var a=32*this.zoomLevel;this.setRectangle(r*a-this.Camera.x*this.zoomLevel+this.element.width/2-a/2,i*a-this.Camera.y*this.zoomLevel+this.element.height/2-a/2,(n-r)*a,(o-i)*a),console.log(),e.drawArrays(e.TRIANGLES,0,6)}}},{key:"resize",value:function(e,t){e=e||this.element.width,t=t||this.element.height,this.Camera.width=e,this.Camera.height=t,this.background.resize(Math.round(e/2+32)*(1/this.zoomLevel),Math.round(t/2+32)*(1/this.zoomLevel)),this.background1.resize(Math.round(e/2+32)*(1/this.zoomLevel),Math.round(t/2+32)*(1/this.zoomLevel)),h(y(c.prototype),"resize",this).call(this,e,t),this.Camera.width=e/this.zoomLevel,this.Camera.height=t/this.zoomLevel}},{key:"setRectangle",value:function(e,t,r,n){var i=this.context;i.bindBuffer(i.ARRAY_BUFFER,this.positionBuffer),i.vertexAttribPointer(this.overlayPosition,2,i.FLOAT,!1,0,0);var o=e,a=e+r,s=t,u=t+n;i.bufferData(i.ARRAY_BUFFER,new Float32Array([o,s,a,s,o,u,o,u,a,s,a,u]),i.STREAM_DRAW)}}])&&f(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),c}(c.Gl2d.inject({Camera:l.Camera}));e.SpriteBoard=b}),require.register("sprite/SpriteSheet.js",function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(e,"__esModule",{value:!0}),e.SpriteSheet=void 0;var i=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.imageUrl="/spritesheet.png",this.boxesUrl="/spritesheet.json",this.vertices={},this.frames={},this.width=0,this.height=0;var r=new Request(this.boxesUrl),n=fetch(r).then(function(e){return e.json().then(function(e){return t.boxes=e,!0})}),i=new Promise(function(e){t.image=new Image,t.image.src=t.imageUrl,t.image.onload=function(){e()}});this.ready=Promise.all([n,i]).then(function(){return t.processImage().then(function(){return t})})}var t,r,i;return t=e,i=[{key:"loadTexture",value:function(e,t){var r=e.context;return this.texturePromises||(this.texturePromises={}),this.texturePromises[t]||(this.texturePromises[t]=this.loadImage(t).then(function(e){var t=r.createTexture();return r.bindTexture(r.TEXTURE_2D,t),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,e),{image:e,texture:t}})),this.texturePromises[t]}},{key:"loadImage",value:function(e){return this.imagePromises||(this.imagePromises={}),this.imagePromises[e]||(this.imagePromises[e]=new Promise(function(t,r){var n=new Image;n.src=e,n.addEventListener("load",function(e){t(n)})})),this.imagePromises[e]}}],(r=[{key:"processImage",value:function(){var e=this;if(this.boxes&&this.boxes.frames){var t=document.createElement("canvas");t.width=this.image.width,t.height=this.image.height;var r=t.getContext("2d");r.drawImage(this.image,0,0);var n=[],i=function(t){var i=document.createElement("canvas");i.width=e.boxes.frames[t].frame.w,i.height=e.boxes.frames[t].frame.h;var o=i.getContext("2d");e.boxes.frames[t].frame&&o.putImageData(r.getImageData(e.boxes.frames[t].frame.x,e.boxes.frames[t].frame.y,e.boxes.frames[t].frame.w,e.boxes.frames[t].frame.h),0,0),e.boxes.frames[t].text&&(o.fillStyle=e.boxes.frames[t].color||"white",o.font=e.boxes.frames[t].font||"".concat(e.boxes.frames[t].frame.h,"px sans-serif"),o.textAlign="center",o.fillText(e.boxes.frames[t].text,e.boxes.frames[t].frame.w/2,e.boxes.frames[t].frame.h,e.boxes.frames[t].frame.w),o.textAlign=null,o.font=null),n.push(new Promise(function(r){i.toBlob(function(n){e.frames[e.boxes.frames[t].filename]=URL.createObjectURL(n),r(e.frames[e.boxes.frames[t].filename])})}))};for(var o in this.boxes.frames)i(o);return Promise.all(n)}}},{key:"getVertices",value:function(e){return this.vertices[e]}},{key:"getFrame",value:function(e){return this.frames[e]}},{key:"getFrames",value:function(e){var t=this;return Array.isArray(e)?e.map(function(e){return t.getFrame(e)}):this.getFramesByPrefix(e)}},{key:"getFramesByPrefix",value:function(e){var t=[];for(var r in this.frames)r.substring(0,e.length)===e&&t.push(this.frames[r]);return t}}])&&n(t.prototype,r),i&&n(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();e.SpriteSheet=i}),require.register("sprite/Surface.js",function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Surface=void 0;var i=t("../inject/Injectable"),o=t("./SpriteSheet"),a=t("./Camera"),s=t("../gl2d/Gl2d");function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(i,e);var t,r,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=f(e);if(t){var i=f(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return l(this,r)}}(i);function i(e,t){var r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,i),(r=n.call(this)).gl2d=e,r.x=s,r.y=u,r.layer=c,r.xSize=o,r.ySize=a,r.tileWidth=32,r.tileHeight=32,r.width=r.xSize*r.tileWidth,r.height=r.ySize*r.tileHeight,r.map=t,r.texVertices=[];var l=e.context;r.texture=l.createTexture(),r.subTextures={},r.loaded=!1,l.bindTexture(l.TEXTURE_2D,r.texture);var f=function(){return parseInt(255*Math.random())};l.texImage2D(l.TEXTURE_2D,0,l.RGBA,1,1,0,l.RGBA,l.UNSIGNED_BYTE,new Uint8Array([f(),f(),0,255])),r.SpriteSheet.ready.then(function(t){l.bindTexture(l.TEXTURE_2D,r.texture);for(var n=[],i=function(t){var i=t%r.xSize+Math.floor(r.x/r.tileWidth),o=Math.floor(t/r.xSize)+Math.floor(r.y/r.tileHeight),a=r.map.getTile(i,o,r.layer);if(Array.isArray(a)){var s=0;r.subTextures[t]=[],n.push(Promise.all(a.map(function(n){return r.SpriteSheet.constructor.loadTexture(e,n).then(function(e){return r.subTextures[t][s]=e.texture,s++,Promise.resolve()})})))}else n.push(r.SpriteSheet.constructor.loadTexture(e,a).then(function(e){return r.subTextures[t]=e.texture,Promise.resolve()}))},o=0;o<r.xSize*r.ySize;o++)i(o);Promise.all(n).then(function(){r.assemble(),r.loaded=!0})}),r.pane=l.createTexture(),l.bindTexture(l.TEXTURE_2D,r.pane),l.texImage2D(l.TEXTURE_2D,0,l.RGBA,r.width,r.height,0,l.RGBA,l.UNSIGNED_BYTE,null),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.NEAREST),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.NEAREST),r.frameBuffer=l.createFramebuffer(),l.bindFramebuffer(l.FRAMEBUFFER,r.frameBuffer);var h=l.COLOR_ATTACHMENT0;return l.framebufferTexture2D(l.FRAMEBUFFER,h,l.TEXTURE_2D,r.pane,0),r}return t=i,(r=[{key:"draw",value:function(){var e=this.gl2d.context;e.useProgram(this.gl2d.program),e.bindTexture(e.TEXTURE_2D,this.pane),this.setRectangle(this.x-(this.Camera.x-this.Camera.width/2)-16,this.y-(this.Camera.y-this.Camera.height/2)-16,this.width,this.height),e.bindFramebuffer(e.FRAMEBUFFER,null),e.drawArrays(e.TRIANGLES,0,6)}},{key:"assemble",value:function(){var e=this.gl2d.context;e.useProgram(this.gl2d.program),e.bindFramebuffer(e.FRAMEBUFFER,this.frameBuffer),e.viewport(0,0,this.width,this.height),e.uniform4f(this.gl2d.colorLocation,1,0,0,1),e.enableVertexAttribArray(this.gl2d.positionLocation),e.uniform2f(this.gl2d.resolutionLocation,this.width,this.height),e.bindTexture(e.TEXTURE_2D,this.texture),e.enableVertexAttribArray(this.gl2d.texCoordLocation),e.bindBuffer(e.ARRAY_BUFFER,this.gl2d.texCoordBuffer),e.vertexAttribPointer(this.gl2d.texCoordLocation,2,e.FLOAT,!1,0,0);var t=0,r=0;for(var n in this.subTextures){for(var i in Array.isArray(this.subTextures[n])||(this.subTextures[n]=[this.subTextures[n]]),this.subTextures[n])e.bindTexture(e.TEXTURE_2D,this.subTextures[n][i]),e.enableVertexAttribArray(this.gl2d.texCoordLocation),e.bindBuffer(e.ARRAY_BUFFER,this.gl2d.texCoordBuffer),e.vertexAttribPointer(this.gl2d.texCoordLocation,2,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,this.gl2d.texCoordBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),e.STREAM_DRAW),this.setRectangle(t,r+this.tileHeight,this.tileWidth,-this.tileHeight),e.drawArrays(e.TRIANGLES,0,6);(t+=this.tileWidth)>=this.width&&(t=0,r+=this.tileHeight)}e.bindFramebuffer(e.FRAMEBUFFER,null)}},{key:"setRectangle",value:function(e,t,r,n){var i=this.gl2d.context;i.bindBuffer(i.ARRAY_BUFFER,this.gl2d.positionBuffer),i.vertexAttribPointer(this.gl2d.positionLocation,2,i.FLOAT,!1,0,0);var o=e,a=e+r,s=t,u=t+n;i.bufferData(i.ARRAY_BUFFER,new Float32Array([o,u,a,u,o,s,o,s,a,u,a,s]),i.STATIC_DRAW)}}])&&u(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(i.Injectable.inject({Gl2d:s.Gl2d,Camera:a.Camera,SpriteSheet:o.SpriteSheet}));e.Surface=h}),require.register("sprite/TextureBank.js",function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(e,"__esModule",{value:!0}),e.TextureBank=void 0;var i=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)});e.TextureBank=i}),require.register("sprite/texture.frag",function(e,t,r){r.exports="precision mediump float;\n\nuniform vec4      u_color;\nuniform sampler2D u_image;\nvarying vec2      v_texCoord;\n\nvoid main() {\n   gl_FragColor = texture2D(u_image, v_texCoord);\n   // gl_FragColor = vec4(1.0,0.0,1.0,1.0);\n   // gl_FragColor = gl_PointCoord.yyxx;\n}\n"}),require.register("sprite/texture.vert",function(e,t,r){r.exports="attribute vec2 a_position;\nattribute vec2 a_texCoord;\n\nuniform   vec2 u_resolution;\n\nvarying   vec2 v_texCoord;\n\nvoid main()\n{\n   vec2 zeroToOne = a_position / u_resolution;\n   vec2 zeroToTwo = zeroToOne * 2.0;\n   vec2 clipSpace = zeroToTwo - 1.0;\n\n   gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);\n   v_texCoord  = a_texCoord;\n}\n"}),require.register("ui/Controller.js",function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=u(e);if(t){var i=u(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return s(this,r)}}function s(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Controller=void 0;var c=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&o(e,t)}(u,t("curvature/base/View").View);var r,n,s=a(u);function u(e){var r;return function(e,t){if(!(e instanceof u))throw new TypeError("Cannot call a class as a function")}(this),(r=s.call(this,e)).template=t("./controller.tmp"),r.dragStart=!1,r.args.dragging=!1,r.args.x=0,r.args.y=0,window.addEventListener("mousemove",function(e){r.moveStick(e)}),window.addEventListener("mouseup",function(e){r.dropStick(e)}),window.addEventListener("touchmove",function(e){r.moveStick(e)}),window.addEventListener("touchend",function(e){r.dropStick(e)}),r}return r=u,(n=[{key:"dragStick",value:function(e){var t=e;e.preventDefault(),e.touches&&e.touches[0]&&(t=e.touches[0]),this.args.dragging=!0,this.dragStart={x:t.clientX,y:t.clientY}}},{key:"moveStick",value:function(e){if(this.args.dragging){var t=e;e.touches&&e.touches[0]&&(t=e.touches[0]),this.args.xx=t.clientX-this.dragStart.x,this.args.yy=t.clientY-this.dragStart.y;this.args.xx<-50?this.args.x=-50:this.args.xx>50?this.args.x=50:this.args.x=this.args.xx,this.args.yy<-50?this.args.y=-50:this.args.yy>50?this.args.y=50:this.args.y=this.args.yy}}},{key:"dropStick",value:function(e){this.args.dragging=!1,this.args.x=0,this.args.y=0}}])&&i(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),u}();e.Controller=c}),require.register("ui/MapEditor.js",function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=u(e);if(t){var i=u(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return s(this,r)}}function s(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.MapEditor=void 0;var c=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&o(e,t)}(u,t("curvature/base/View").View);var r,n,s=a(u);function u(e){var r;return function(e,t){if(!(e instanceof u))throw new TypeError("Cannot call a class as a function")}(this),(r=s.call(this,e)).template=t("./mapEditor.tmp"),e.spriteSheet.ready.then(function(e){r.args.tiles=e.frames}),r.args.bindTo("selectedGraphic",function(e){r.args.selectedGraphic=null},{wait:0}),r.args.multiSelect=!1,r.args.selection={},r.args.selectedImage=null,r}return r=u,(n=[{key:"selectGraphic",value:function(e){console.log(e),this.args.selectedGraphic=e}},{key:"select",value:function(e){Object.assign(this.args.selection,e),e.globalX!==e.startGlobalX||e.globalY!==e.startGlobalY?this.args.multiSelect=!0:this.args.multiSelect=!1,this.args.multiSelect||(this.args.selectedImages=this.args.map.getTile(e.globalX,e.globalY))}}])&&i(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),u}();e.MapEditor=c}),require.register("ui/controller.tmp.html",function(e,t,r){r.exports='<div class = "controller">\n\t<div class = "joystick" cv-on = "\n\t\ttouchstart:dragStick(event);\n\t\tmousedown:dragStick(event);\n\t">\n\t\t<div class = "pad" style = "position: relative; transform:translate([[x]]px,[[y]]px);"></div>\n\t</div>\n\n\t<div class = "button">A</div>\n\t<div class = "button">B</div>\n\t<div class = "button">C</div>\n</div>'}),require.register("ui/mapEditor.tmp.html",function(e,t,r){r.exports='<div class = "tab-page mapEditor">\n\t<div class = "tabs">\n\t\t<div>Tile</div>\n\t\t<div>Layer</div>\n\t\t<div>Object</div>\n\t\t<div>Trigger</div>\n\t\t<div>Map</div>\n\t</div>\n\n\t<div class = "tile">\n\t\t<div class = "selected">\n\t\t\t<div cv-if = "!multiSelect">\n\t\t\t\t<p style = "font-size: large">\n\t\t\t\t\t([[selection.globalX]], [[selection.globalY]])\n\t\t\t\t</p>\n\t\t\t\t<p cv-each = "selectedImages:selectedImage:sI">\n\t\t\t\t\t<button>-</button>\n\t\t\t\t\t<img class = "current" cv-attr = "src:selectedImage">\n\t\t\t\t</p>\n\t\t\t\t<button>+</button>\n\t\t\t</div>\n\t\t\t<div cv-if = "multiSelect">\n\t\t\t\t<p style = "font-size: large">\n\t\t\t\t\t([[selection.startGlobalX]], [[selection.startGlobalY]]) - ([[selection.globalX]], [[selection.globalY]])\n\t\t\t\t</p>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class = "tiles" cv-each = "tiles:tile:t">\n\t\t\t<img cv-attr = "src:tile,title:t" cv-on = "click:selectGraphic(t);">\n\t\t</div>\n\t</div>\n\t\x3c!-- <div class = "tile">OBJECT MODE</div>\n\t<div class = "tile">TRIGGER MODE</div>\n\t<div class = "tile">MAP MODE</div> --\x3e\n</div>'}),require.register("world/Actor.js",function(e,t,r){}),require.register("world/Floor.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Floor=void 0;var n=t("../sprite/Sprite");function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.gl2d=t,this.sprites=[],this.resize(9,9)}var t,r;return t=e,(r=[{key:"resize",value:function(e,t){this.width=e,this.height=t;for(var r=0;r<e;r++)for(var i=0;i<t;i++){var o=new n.Sprite(this.gl2d,"/floorTile.png");o.x=32*r,o.y=32*i,this.sprites.push(o)}}},{key:"draw",value:function(){this.sprites.map(function(e){return e.draw()})}}])&&i(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();e.Floor=o}),require.register("world/Map.js",function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Map=void 0;var i=t("../sprite/SpriteSheet");function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=c(e);if(t){var i=c(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return u(this,r)}}function u(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}(i,e);var t,r,n=s(i);function i(){var e;return function(e,t){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(e=n.call(this)).tiles={},e}return t=i,(r=[{key:"getTile",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.tiles["".concat(e,",").concat(t,"--").concat(r)]?[this.SpriteSheet.getFrame(this.tiles["".concat(e,",").concat(t,"--").concat(r)])]:[this.SpriteSheet.getFrame("floorTile.png")]}},{key:"setTile",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.tiles["".concat(e,",").concat(t,"--").concat(n)]=r}},{key:"export",value:function(){console.log(JSON.stringify(this.tiles))}},{key:"import",value:function(e){this.tiles=JSON.parse('{"-2,11":"lava_center_middle.png","-1,11":"lava_center_middle.png","0,11":"lava_center_middle.png"}')}}])&&o(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(t("../inject/Injectable").Injectable.inject({SpriteSheet:i.SpriteSheet}));e.Map=l}),require.register("___globals___",function(e,t,r){})}(),require("___globals___");
